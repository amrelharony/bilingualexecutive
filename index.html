<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>The Bilingual Executive Toolkit v0.1</title>
    
    <!-- PWA Manifest & Meta -->
    <meta name="theme-color" content="#0f172a">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="manifest" href="manifest.json">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;800&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">


   <!-- Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/@alpinejs/collapse@3.x.x/dist/cdn.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.13.3/dist/cdn.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.5/dist/purify.min.js"></script>

    <!-- YOUR LOCAL FILES -->
    <link rel="stylesheet" href="css/styles.css">
    <script src="js/app.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        dark: '#0f172a', card: '#1e293b', primary: '#4ade80', risk: '#f87171', warn: '#fbbf24', hotpink: '#f472b6', textMain: '#f1f5f9', textMuted: '#94a3b8',
                    },
                    fontFamily: { mono: ['"JetBrains Mono"', 'monospace'], sans: ['"Inter"', 'sans-serif'], },
                    boxShadow: { 'glow': '0 0 15px rgba(74, 222, 128, 0.1)', 'glow-vip': '0 0 20px rgba(244, 114, 182, 0.2)' },
                    animation: { 'glitch': 'glitch 1s linear infinite' }
                }
            }
        }
    </script>
    <style>
        /* 1. Make Range Sliders easier to grab on mobile */
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 24px; /* Bigger touch target */
            width: 24px;  /* Bigger touch target */
            border-radius: 50%;
            background: #f472b6; /* Hotpink to match the theme */
            cursor: pointer;
            margin-top: -8px; /* Centers thumb on the track */
            box-shadow: 0 0 10px rgba(244, 114, 182, 0.5);
            border: 2px solid #fff;
        }

        /* Firefox support */
        input[type=range]::-moz-range-thumb {
            height: 24px;
            width: 24px;
            border: none;
            border-radius: 50%;
            background: #f472b6;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(244, 114, 182, 0.5);
            border: 2px solid #fff;
        }

        /* 2. Fix Scrolling on iOS */
        .overflow-y-auto {
            -webkit-overflow-scrolling: touch; /* Momentum scrolling */
            overscroll-behavior-y: contain;    /* Prevents pulling the whole page down */
        }
    </style>

    
</head>
<body class="bg-dark text-textMain font-sans h-screen overflow-hidden flex flex-col md:flex-row selection:bg-primary selection:text-dark">

    <div x-data="toolkit" class="flex w-full h-full relative">

        
        

        <!-- VIP BOOT SEQUENCE -->
        <div x-show="showVipIntro" x-transition.opacity.duration.500ms class="fixed inset-0 z-[100] bg-black flex flex-col items-center justify-center font-mono text-hotpink cursor-wait">
            <div class="max-w-md w-full p-6">
                <div class="text-xs text-slate-500 mb-2 font-bold tracking-widest">NFC SIGNAL DETECTED...</div>
                <h1 class="text-4xl font-bold mb-4 animate-pulse">WELCOME, ARCHITECT.</h1>
                <div class="space-y-2 text-sm text-primary font-mono">
                    <p x-show="bootStep >= 1">> Verifying Token... [OK]</p>
                    <p x-show="bootStep >= 2">> Unlocking Financial Engine... [OK]</p>
                    <p x-show="bootStep >= 3">> Activating God Mode... [OK]</p>
                </div>
                <div class="mt-8 w-full bg-slate-900 h-1 rounded-full overflow-hidden">
                    <div class="bg-hotpink h-1 transition-all duration-[3000ms] ease-out" :style="`width: ${bootProgress}%`"></div>
                </div>
            </div>
        </div>

        <!-- PWA INSTALL PROMPT -->
        <div x-show="showPwaPrompt && isMobile" x-cloak x-transition 
             class="md:hidden fixed top-0 left-0 w-full bg-slate-900 text-white p-4 pt-safe z-[100] border-b border-primary/30 flex justify-between items-center shadow-2xl">
            <button @click="installPwa()" class="flex items-center gap-4 text-left flex-1">
                <div class="bg-primary/20 w-10 h-10 rounded-full flex items-center justify-center text-primary shrink-0 animate-pulse">
                    <i class="fa-solid fa-download"></i>
                </div>
                <div>
                    <p class="font-bold text-sm">Install Application</p>
                    <p class="text-xs text-slate-400">Tap here to add to Home Screen</p>
                </div>
            </button>
            <button @click.stop="dismissPwa()" class="text-slate-500 hover:text-white px-4 py-2">
                <i class="fa-solid fa-xmark text-xl"></i>
            </button>
        </div>

<!-- Gap Analysis Banner -->
        <template x-if="challengerData">
            <div x-cloak class="absolute top-0 left-0 w-full bg-hotpink/10 border-b border-hotpink z-40 p-2 text-center backdrop-blur-md pt-safe">
                <p class="font-mono text-hotpink text-xs md:text-sm font-bold truncate px-2"><i class="fa-solid fa-people-arrows mr-2"></i>GAP MODE: Comparing against <span x-text="challengerData?.title || 'Colleague'"></span></p>
            </div>
        </template>


  <!-- MAIN VIEW SWITCHER -->
<div class="fixed top-4 right-4 z-[80] bg-slate-900/90 border border-slate-600 backdrop-blur-md rounded-full p-1 flex shadow-2xl scale-75 md:scale-90 origin-top-right transition-all duration-500"
     :class="navVisible ? 'opacity-100 translate-y-0' : 'opacity-0 -translate-y-4 pointer-events-none'">

    <button @click="viewMode = 'academy'" 
            :class="viewMode === 'academy' ? 'bg-white text-black' : 'text-slate-400 hover:text-white'"
            class="px-6 py-3 rounded-full text-xs font-bold uppercase tracking-widest transition-all">
        ACADEMY
    </button>
    <button @click="viewMode = 'tools'" 
            :class="viewMode === 'tools' ? 'bg-white text-black' : 'text-slate-400 hover:text-white'"
            class="px-6 py-3 rounded-full text-xs font-bold uppercase tracking-widest transition-all">
        TOOLKIT
    </button>
</div>
        

        <!-- LANDING PAGE / COVER SIMULATOR -->
<div x-show="showLanding" 
     x-transition:leave="transition ease-in duration-700"
     x-transition:leave-start="opacity-100 transform scale-100"
     x-transition:leave-end="opacity-0 transform scale-110"
     class="fixed inset-0 z-[200] bg-black overflow-y-auto">

    <!-- Background Texture -->
    <div class="fixed inset-0 opacity-20 pointer-events-none" 
         style="background-image: url('https://www.transparenttextures.com/patterns/stardust.png');">
    </div>

    <!-- Main Container -->
    <div class="min-h-screen w-full flex flex-col items-center justify-center p-6 text-center relative z-10">
        
        <div class="max-w-xl w-full flex flex-col items-center py-10 md:py-0">
            
            <p class="text-[10px] md:text-xs font-mono text-slate-400 tracking-[0.3em] uppercase mb-4 animate-pulse">
                System Initializing...
            </p>

            <h1 class="text-5xl md:text-7xl font-sans font-extrabold tracking-tighter leading-none text-white mb-2">
                THE<br>
                <span class="text-transparent bg-clip-text bg-gradient-to-b from-white to-slate-500">BILINGUAL</span><br>
                EXECUTIVE
            </h1>

            <div class="h-1 w-16 md:w-24 bg-red-600 my-4 md:my-6"></div>
            
            <p class="font-mono text-xs md:text-sm text-slate-300 max-w-md mx-auto leading-relaxed mb-6 md:mb-8">
                HOW TO BUILD THE <span class="text-white font-bold">AGILE BANK</span><br> 
                AND SURVIVE THE FINTECH TSUNAMI
            </p>

        <!-- Video Player Container -->
<div class="w-full h-[50vh] md:h-[60vh] max-h-[600px] bg-slate-900 border border-slate-800 rounded-xl overflow-hidden shadow-[0_0_50px_rgba(255,255,255,0.1)] mb-8 relative group">
    
    <!-- YouTube Player -->
    <div id="youtube-player" class="w-full h-full"></div>

    <!-- Video Overlay for Click-to-Play (covers entire video area) -->
    <div class="absolute inset-0 video-overlay z-20" 
         @click="toggleVideoPlay()"
         :title="videoPlaying ? 'Pause video' : 'Play video'">
    </div>

    <!-- Custom Controls Bar (NOW AT BOTTOM) -->
    <div class="absolute bottom-0 left-0 right-0 z-30 video-controls-bar p-4 opacity-90 group-hover:opacity-100 transition-opacity duration-300">
        <div class="flex items-center gap-3 md:gap-4">
            
            <!-- Play/Pause Button -->
            <button @click="toggleVideoPlay()" 
                    class="video-control-btn w-10 h-10 rounded-full flex items-center justify-center text-white">
                <i class="fa-solid text-sm" :class="videoPlaying ? 'fa-pause' : 'fa-play'"></i>
            </button>
            
            <!-- Time Display -->
            <div class="video-time-display flex items-center gap-1 text-xs text-white font-mono">
                <span x-text="formatTime(videoCurrentTime)"></span>
                <span>/</span>
                <span x-text="formatTime(videoDuration)"></span>
            </div>
            
            <!-- Seek Bar -->
            <div class="flex-1 mx-2">
                <input type="range" 
                       x-model="videoCurrentTime"
                       @input="seekVideo($event.target.value)"
                       :max="videoDuration"
                       step="1"
                       class="seek-bar w-full"
                       :style="'--seek-progress: ' + (videoDuration > 0 ? (videoCurrentTime / videoDuration * 100) : 0) + '%'">
            </div>
            
            <!-- Volume Controls -->
            <div class="flex items-center gap-2">
                <button @click="toggleVideoMute()" 
                        class="video-control-btn w-8 h-8 rounded-full flex items-center justify-center text-white">
                    <i class="fa-solid text-sm" :class="videoMuted ? 'fa-volume-xmark' : 'fa-volume-high'"></i>
                </button>
                
                <!-- Volume Slider -->
                <input type="range"
                       x-model="videoVolume"
                       @input="setPlayerVolume($event.target.value)"
                       min="0"
                       max="100"
                       class="volume-slider"
                       :style="'--volume-level: ' + videoVolume + '%'">
                
                <!-- NEW: Fullscreen Button -->
                                <button @click="toggleFullscreen()" 
                        class="video-control-btn w-8 h-8 rounded-full flex items-center justify-center text-white ml-2">
                    <i class="fa-solid text-sm" :class="isFullscreen ? 'fa-compress' : 'fa-expand'"></i>
                </button>

            </div>
            
        </div>
    </div>

</div>

              <!-- Enter Button -->
            <button @click="enterApp()" 
                    class="group relative px-8 py-3 bg-white text-black font-bold font-mono text-xs md:text-sm tracking-widest uppercase rounded-full hover:bg-red-600 hover:text-white transition-all duration-300 shadow-[0_0_30px_rgba(255,255,255,0.3)] hover:shadow-[0_0_30px_rgba(220,38,38,0.6)] mb-8">
                <span class="relative z-10 flex items-center gap-2">
                    Initialize Operations <i class="fa-solid fa-arrow-right group-hover:translate-x-1 transition-transform"></i>
                </span>
            </button>

            <!-- Footer Info -->
            <div class="text-[10px] text-slate-500 font-mono tracking-widest">
                &copy; Amr Elharony 2026
            </div>

        </div>
    </div>
</div>
            
        <!-- Main Content Area -->
<main class="flex-1 h-full overflow-y-auto bg-[radial-gradient(ellipse_at_top_right,_var(--tw-gradient-stops))] from-slate-900 via-[#0B1120] to-black p-6 pb-32 md:pb-24">

    <!-- ACADEMY VIEW -->
<div x-show="viewMode === 'academy'" class="pb-24">
    
    <!-- 1. METRO MAP (The Curriculum List) -->
    <div x-show="!activeChapterId" x-transition:enter="transition ease-out duration-300 transform" x-transition:enter-start="-translate-x-10 opacity-0">
        
        <div class="p-6 md:p-10">
            <h1 class="text-4xl font-black text-white mb-2 tracking-tighter">THE ACADEMY</h1>
            <p class="text-slate-400 font-mono text-xs uppercase tracking-widest mb-12">Level up your Tech Fluency</p>

            <div class="space-y-12 relative pl-4">
                <!-- Continuous Vertical Line -->
                <div class="absolute left-4 top-2 bottom-0 w-0.5 bg-slate-800 -z-10"></div>

                <template x-for="part in metroMap" :key="part.id">
                    <div class="relative">
                        <!-- Part Label -->
                        <div class="flex items-center gap-4 mb-6">
                            <div class="w-3 h-3 rounded-full border-2 bg-dark z-10" :class="part.color"></div>
                            <h3 class="text-xs font-bold text-slate-500 font-mono uppercase tracking-widest" x-text="part.label"></h3>
                        </div>

                        <!-- Chapters -->
                        <div class="space-y-4 pl-8 border-l-2 border-slate-800 ml-[5px]">
                            <template x-for="chapter in part.chapters" :key="chapter.id">
                                <button @click="chapter.status !== 'locked' ? openChapter(chapter.id) : null"
                                        class="w-full text-left p-6 rounded-xl border-2 transition-all relative group overflow-hidden"
                                        :class="chapter.status === 'locked' ? 'border-slate-800 bg-slate-900/50 opacity-60 cursor-not-allowed' : 'border-slate-700 bg-slate-800 hover:border-white hover:-translate-y-1 hover:shadow-xl'">
                                    
                                    <!-- Status Icon -->
                                    <div class="absolute top-6 right-6 text-xl">
                                        <i class="fa-solid" 
                                           :class="{
                                               'fa-lock text-slate-600': chapter.status === 'locked',
                                               'fa-circle-play text-white animate-pulse': chapter.status === 'active',
                                               'fa-circle-check text-green-500': chapter.status === 'completed'
                                           }"></i>
                                    </div>

                                    <span class="text-[10px] font-mono text-slate-400 mb-1 block">CHAPTER <span x-text="chapter.id"></span></span>
                                    <h4 class="text-xl font-bold text-white mb-2" x-text="chapter.title"></h4>
                                    <p class="text-sm text-slate-400" x-text="chapter.desc"></p>
                                </button>
                            </template>
                        </div>
                    </div>
                </template>
            </div>
        </div>
    </div>

    <!-- 2. CHAPTER DASHBOARD (Detail View) -->
    <div x-show="activeChapterId" x-cloak class="min-h-screen bg-dark">
        <template x-if="activeChapter">
            <div>
                <!-- Sticky Header -->
                <div class="sticky top-0 z-40 bg-dark/90 backdrop-blur border-b border-slate-800 p-4 flex items-center gap-4">
                    <button @click="closeChapter()" class="w-10 h-10 rounded-full border border-slate-600 flex items-center justify-center text-white hover:bg-white hover:text-black transition-all">
                        <i class="fa-solid fa-arrow-left"></i>
                    </button>
                    <div>
                        <p class="text-[10px] font-mono text-slate-500 uppercase">NOW PLAYING</p>
                        <h3 class="font-bold text-white text-sm md:text-base truncate" x-text="activeChapter.title"></h3>
                    </div>
                </div>

                <div class="max-w-4xl mx-auto p-4 md:p-8 space-y-8">
                    
                    <!-- A. Video Player -->
                    <div class="aspect-video w-full bg-black rounded-2xl overflow-hidden shadow-2xl border border-slate-700">
                        <iframe class="w-full h-full" 
                                :src="'https://www.youtube.com/embed/' + activeChapter.youtubeId + '?rel=0&modestbranding=1'" 
                                frameborder="0" allowfullscreen></iframe>
                    </div>

                    <!-- B. Audio Deep Dive -->
                    <div class="bg-slate-800 p-6 rounded-2xl border border-slate-700">
                        <div class="flex items-center gap-4 mb-4">
                            <div class="w-10 h-10 rounded-full bg-purple-500 flex items-center justify-center text-white">
                                <i class="fa-solid fa-headphones"></i>
                            </div>
                            <div>
                                <h4 class="text-white font-bold">Audio Deep Dive</h4>
                                <p class="text-xs text-slate-400">Listen on the go (Background Play)</p>
                            </div>
                        </div>
                        <audio controls class="w-full h-10 rounded">
                            <source :src="getAudioUrl(activeChapter)" type="audio/mp4">
                            Your browser does not support the audio element.
                        </audio>
                    </div>

<!-- C. Asset Grid (UPDATED FOR OFFLINE CACHING) -->
<div class="grid grid-cols-2 gap-4">
    <!-- VIEW SLIDES -->
    <button @click="viewPdf(activeChapter)" class="p-6 bg-slate-800 rounded-xl border border-slate-700 hover:border-blue-400 hover:bg-slate-700 transition-all text-center group">
        <i class="fa-solid fa-file-pdf text-3xl text-slate-400 group-hover:text-blue-400 mb-2 transition-colors"></i>
        <p class="text-xs font-bold text-white">VIEW SLIDES</p>
    </button>
    
    <!-- SAVE FOR OFFLINE (Caching) -->
    <button @click="toggleOfflineCache(activeChapter)" 
            class="p-6 rounded-xl border transition-all text-center group relative overflow-hidden"
            :class="offlineManager.isCached(activeChapter.id) ? 'bg-green-900/20 border-green-500' : 'bg-slate-800 border-slate-700 hover:border-green-400'">
        
        <!-- Status Badge -->
        <div class="absolute top-2 right-2 text-[9px] font-mono px-2 py-0.5 rounded border"
             :class="offlineManager.isCached(activeChapter.id) ? 'bg-green-500 text-black border-green-500' : 'bg-black/50 text-slate-400 border-slate-600'">
            <span x-text="offlineManager.isCached(activeChapter.id) ? 'OFFLINE READY' : offlineManager.getQuotaText()"></span>
        </div>

        <!-- Icon Swaps based on state -->
        <div class="mb-2">
            <i class="fa-solid text-3xl transition-colors"
               :class="offlineManager.loading === activeChapter.id ? 'fa-circle-notch fa-spin text-white' : (offlineManager.isCached(activeChapter.id) ? 'fa-circle-check text-green-500' : 'fa-cloud-arrow-down text-slate-400 group-hover:text-green-400')"></i>
        </div>
        
        <p class="text-xs font-bold" 
           :class="offlineManager.isCached(activeChapter.id) ? 'text-green-400' : 'text-white'"
           x-text="offlineManager.loading === activeChapter.id ? 'SAVING...' : (offlineManager.isCached(activeChapter.id) ? 'SAVED LOCALLY' : 'SAVE OFFLINE')"></p>
    </button>

    <!-- Flashcards -->
    <button @click="launchFlashcards(activeChapter)" class="p-6 bg-slate-800 rounded-xl border border-slate-700 hover:border-yellow-400 hover:bg-slate-700 transition-all text-center group">
        <i class="fa-solid fa-layer-group text-3xl text-slate-400 group-hover:text-yellow-400 mb-2 transition-colors"></i>
        <p class="text-xs font-bold text-white">FLASHCARDS</p>
    </button>

    <!-- Mind Map -->
    <button @click="viewImage(activeChapter, 'mindmap')" class="p-6 bg-slate-800 rounded-xl border border-slate-700 hover:border-purple-400 hover:bg-slate-700 transition-all text-center group">
        <i class="fa-solid fa-diagram-project text-3xl text-slate-400 group-hover:text-purple-400 mb-2 transition-colors"></i>
        <p class="text-xs font-bold text-white">MIND MAP</p>
    </button>
</div>

                     </div> <!-- End of max-w-4xl container -->
            </div> <!-- End of content wrapper -->
        </template>
    </div> <!-- End of activeChapterId view -->
</div> <!-- End of viewMode === 'academy' -->
                    
                    
    <!-- PDF / IMAGE VIEWER MODAL -->
<div x-show="viewer.active" x-cloak x-transition.opacity 
     class="fixed inset-0 z-[150] bg-black/95 flex flex-col">
    
    <!-- Viewer Header -->
    <div class="flex justify-between items-center p-4 border-b border-slate-800 bg-slate-900">
        <h3 class="text-white font-bold text-sm truncate" x-text="viewer.title"></h3>
        <button @click="viewer.active = false" class="text-slate-400 hover:text-white px-4">
            <i class="fa-solid fa-xmark text-xl"></i>
        </button>
    </div>

    <!-- Viewer Body -->
    <div class="flex-1 relative w-full h-full overflow-hidden flex items-center justify-center p-2">
        
        <!-- PDF Case 1: Online / Google Wrapper -->
        <template x-if="viewer.type === 'pdf' && !viewer.isBlob">
            <iframe 
                :src="'https://docs.google.com/gview?url=' + encodeURIComponent(viewer.url) + '&embedded=true'" 
                class="w-full h-full rounded border border-slate-700 bg-white" 
                frameborder="0">
            </iframe>
        </template>

        <!-- PDF Case 2: Offline / Cached Blob -->
        <template x-if="viewer.type === 'pdf' && viewer.isBlob">
            <iframe 
                :src="viewer.url" 
                class="w-full h-full rounded border border-slate-700 bg-white" 
                frameborder="0">
            </iframe>
        </template>

        <!-- Image Viewer -->
        <template x-if="viewer.type === 'image'">
            <img :src="viewer.url" class="max-w-full max-h-full object-contain rounded shadow-2xl">
        </template>

    </div>
</div>


                    
<!-- FLASHCARD MODAL OVERLAY -->
<div x-show="showFlashcards" x-transition.opacity class="fixed inset-0 z-[100] bg-black/90 backdrop-blur-sm flex items-center justify-center p-6">
    <div class="w-full max-w-md bg-transparent perspective-1000 relative">
        
        <!-- Close Button -->
        <button @click="showFlashcards = false" class="absolute -top-12 right-0 text-white text-xl"><i class="fa-solid fa-xmark"></i></button>

        <!-- Loading State -->
        <div x-show="flashcardLoading" class="text-white text-center">
            <i class="fa-solid fa-circle-notch fa-spin text-4xl mb-4"></i>
            <p>Shuffling Deck...</p>
        </div>

        <!-- The Card (Flip Logic) -->
        <div x-show="!flashcardLoading && flashcardDeck.length > 0" 
             @click="isFlipped = !isFlipped"
             class="relative w-full aspect-[4/5] transition-all duration-500 transform-style-3d cursor-pointer"
             :class="isFlipped ? 'rotate-y-180' : ''">
            
            <!-- Front (Question) -->
            <div class="absolute inset-0 backface-hidden bg-slate-800 rounded-2xl border-2 border-slate-600 flex flex-col items-center justify-center p-8 text-center shadow-2xl">
                <span class="text-xs font-mono text-slate-400 uppercase tracking-widest mb-4">QUESTION</span>
                <h3 class="text-2xl font-bold text-white leading-tight" x-text="flashcardDeck[currentCardIndex]?.q"></h3>
                <p class="text-xs text-slate-500 mt-8 absolute bottom-8">Tap to Reveal</p>
            </div>

            <!-- Back (Answer) -->
            <div class="absolute inset-0 backface-hidden bg-white rounded-2xl border-2 border-white flex flex-col items-center justify-center p-8 text-center rotate-y-180 shadow-2xl">
                <span class="text-xs font-mono text-slate-400 uppercase tracking-widest mb-4">ANSWER</span>
                <h3 class="text-xl font-medium text-slate-900 leading-relaxed" x-text="flashcardDeck[currentCardIndex]?.a"></h3>
                <button @click.stop="nextCard()" class="mt-8 px-6 py-2 bg-black text-white rounded-full text-xs font-bold uppercase tracking-widest hover:bg-slate-800 transition-colors">
                    Next Card <i class="fa-solid fa-arrow-right ml-2"></i>
                </button>
            </div>
        </div>
    </div>
</div>

        <div x-show="viewMode === 'tools'">

    <!-- Header Area -->
    <div class="mb-8 pt-8">
        <h1 class="text-3xl font-sans font-bold tracking-tight text-white mb-1" x-text="navGroups.find(g => g.id === currentGroup).label"></h1>
        <p class="text-slate-400 font-mono text-xs uppercase tracking-widest" x-text="navGroups.find(g => g.id === currentGroup).desc"></p>
    </div>

    <!-- The Grid of Tools for the Current Group -->
   <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3 md:gap-4">
        <template x-for="tool in tools[currentGroup]" :key="tool.id">
<button @click="currentTab = tool.id" 
        class="group relative bg-slate-800/40 backdrop-blur-md border border-white/5 hover:border-white/20 p-4 md:p-6 rounded-2xl text-left transition-all hover:-translate-y-1 hover:shadow-glow">
    
<!-- Icon Bubble -->
<div class="w-8 h-8 md:w-10 md:h-10 rounded-full bg-slate-900/50 flex items-center justify-center mb-3 md:mb-4 border border-white/5 group-hover:scale-110 transition-transform">
    <i :class="tool.icon + ' ' + tool.color" class="text-base md:text-lg"></i>
</div>
                
                <!-- Label -->
                <span class="block text-white font-medium text-sm" x-text="tool.label"></span>
                
                <!-- Arrow -->
                <div class="absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition-opacity">
                    <i class="fa-solid fa-arrow-right text-xs text-slate-500"></i>
                </div>
            </button>
        </template>
    </div>


    <!-- ACTIVE TOOL RENDERER -->
    <!-- Only show the specific tool UI if one is selected, overlaying the grid -->
    <div x-show="currentTab !== 'dashboard'" 
     x-transition:enter="transition ease-out duration-200"
     x-transition:enter-start="opacity-0 scale-95"
     x-transition:enter-end="opacity-100 scale-100"
     class="fixed inset-0 z-50 bg-dark/95 backdrop-blur-xl overflow-y-auto touch-pan-y">

        
<!-- Tool Header (Sticky) -->
        <div class="sticky top-0 z-[60] p-4 border-b border-white/10 flex items-center justify-between bg-slate-900/90 backdrop-blur-md relative">
            
            <!-- Back Button: Shortened text for mobile to prevent overlap -->
            <button @click="currentTab = 'dashboard'" class="relative z-10 text-slate-400 hover:text-white flex items-center gap-2 font-mono text-xs uppercase">
                <i class="fa-solid fa-chevron-left"></i> 
                <span class="hidden md:inline">Back to Hub</span>
                <span class="md:hidden">Back</span>
            </button>
            
            <!-- Title: Absolutely centered to ignore button width -->
            <div class="absolute inset-0 flex items-center justify-center pointer-events-none">
                <div class="font-bold text-white tracking-tight text-center text-sm md:text-base">THE BILINGUAL EXECUTIVE</div>
            </div>
            
            <!-- Right Spacer -->
            <div class="w-8"></div> 
        </div>
        
        <!-- Tool Content Container -->
         <div class="p-4 md:p-8 pb-20">

             
             <!-- SIMULATOR TAB (REDESIGNED) -->
<div x-show="currentTab === 'simulator'" x-cloak class="max-w-5xl mx-auto pb-20">
    
    <!-- Intro Screen -->
    <div x-show="!caseStudy.active" class="text-center py-20">
        <div class="inline-block p-8 rounded-full bg-slate-900 border-2 border-primary/30 mb-8 shadow-[0_0_30px_rgba(74,222,128,0.1)]">
            <i class="fa-solid fa-chess-knight text-6xl text-primary"></i>
        </div>
        <h2 class="text-5xl font-mono font-bold text-white mb-6 tracking-tight">The Meridian Trust Protocol</h2>
        <p class="text-slate-400 max-w-xl mx-auto mb-10 text-lg leading-relaxed">
            Simulation Mode: <span class="text-white font-bold">Active</span><br>
            Role: <span class="text-white font-bold">Chief Digital Officer</span><br>
            Objective: <span class="text-white font-bold">Survive 90 Days</span>
        </p>
        <button @click="caseStudy.start()" class="bg-primary hover:bg-green-400 text-dark font-bold py-4 px-10 rounded-full shadow-glow transition-all text-sm tracking-widest uppercase">
            Initialize Simulation
        </button>
    </div>

    <!-- Active Game UI -->
    <div x-show="caseStudy.active && !caseStudy.gameOver" class="space-y-8">
        
        <!-- HEADS-UP DISPLAY (Telemetry) -->
        <div class="sticky top-0 z-30 bg-slate-900/90 backdrop-blur-md border-b border-slate-700 p-4 -mx-4 md:mx-0 md:rounded-xl md:border shadow-2xl">
            <div class="grid grid-cols-3 gap-4 text-center">
                <!-- Political Capital -->
                <div>
                    <div class="text-[10px] uppercase font-mono text-slate-500 mb-1">Political Capital</div>
                    <div class="w-full bg-slate-800 h-2 rounded-full overflow-hidden mb-1">
                        <div class="h-full transition-all duration-500" 
                             :class="caseStudy.metrics.politicalCapital < 30 ? 'bg-risk' : 'bg-primary'"
                             :style="`width: ${caseStudy.metrics.politicalCapital}%`"></div>
                    </div>
                    <span class="font-mono text-sm font-bold text-white" x-text="caseStudy.metrics.politicalCapital + '%'"></span>
                </div>
                <!-- Velocity -->
                <div>
                    <div class="text-[10px] uppercase font-mono text-slate-500 mb-1">Velocity</div>
                    <div class="w-full bg-slate-800 h-2 rounded-full overflow-hidden mb-1">
                        <div class="bg-purple-400 h-full transition-all duration-500" :style="`width: ${caseStudy.metrics.velocity}%`"></div>
                    </div>
                    <span class="font-mono text-sm font-bold text-white" x-text="caseStudy.metrics.velocity"></span>
                </div>
                <!-- Risk -->
                <div>
                    <div class="text-[10px] uppercase font-mono text-slate-500 mb-1">Risk Exposure</div>
                    <div class="w-full bg-slate-800 h-2 rounded-full overflow-hidden mb-1">
                        <div class="h-full transition-all duration-500" 
                             :class="caseStudy.metrics.risk > 70 ? 'bg-risk' : 'bg-blue-400'"
                             :style="`width: ${caseStudy.metrics.risk}%`"></div>
                    </div>
                    <span class="font-mono text-sm font-bold text-white" x-text="caseStudy.metrics.risk + '%'"></span>
                </div>
            </div>
        </div>

        <!-- SCENARIO CARD -->
        <div class="bg-card border-l-4 border-primary p-8 rounded-r-xl shadow-2xl relative overflow-hidden max-w-3xl mx-auto">
            
            <!-- Progress Pill -->
            <div class="absolute top-6 right-6">
                <span class="bg-slate-800 text-slate-300 text-xs font-mono px-3 py-1 rounded-full border border-slate-700">
                    DAY <span x-text="(caseStudy.step + 1) * 30"></span> / 90
                </span>
            </div>

            <span class="text-xs font-mono text-primary tracking-widest uppercase mb-4 block">
                INCOMING SITUATION
            </span>
            
            <h3 class="text-3xl font-bold text-white mb-4" x-text="caseStudy.scenarios[caseStudy.step].title"></h3>
            <p class="text-slate-300 leading-relaxed text-lg mb-8" x-text="caseStudy.scenarios[caseStudy.step].context"></p>
            
            <div class="bg-slate-900/50 p-6 rounded-lg border border-slate-700 mb-8">
                <p class="font-mono text-warn text-xs mb-2 uppercase"><i class="fa-solid fa-triangle-exclamation mr-2"></i>Executive Decision Required</p>
                <p class="text-white font-bold text-xl italic" x-text="caseStudy.scenarios[caseStudy.step].question"></p>
            </div>

            <!-- Choices -->
            <div class="grid md:grid-cols-2 gap-4">
                <template x-for="(choice, index) in caseStudy.scenarios[caseStudy.step].choices" :key="index">
                    <button @click="caseStudy.makeChoice(index)" 
                            class="text-left p-6 rounded-xl border border-slate-600 hover:border-primary hover:bg-slate-800 transition-all group relative h-full flex flex-col justify-between">
                        
                        <div>
                            <span class="font-mono text-[10px] text-slate-500 block mb-2">OPTION <span x-text="index + 1"></span></span>
                            <span class="text-white font-medium block" x-text="choice.text"></span>
                        </div>
                        
                        <div class="mt-4 flex justify-end opacity-0 group-hover:opacity-100 transition-opacity text-primary">
                            <i class="fa-solid fa-arrow-right"></i>
                        </div>
                    </button>
                </template>
            </div>
        </div>
    </div>

    <!-- GAME OVER / RESULTS SCREEN -->
    <div x-show="caseStudy.gameOver" class="max-w-3xl mx-auto">
        
        <!-- Result Banner -->
        <div class="text-center mb-10">
            <div class="mb-4 inline-flex items-center justify-center w-20 h-20 rounded-full bg-slate-900 border-2" 
                 :class="caseStudy.metrics.politicalCapital > 0 ? 'border-primary text-primary' : 'border-risk text-risk'">
                <i class="fa-solid text-4xl" :class="caseStudy.metrics.politicalCapital > 0 ? 'fa-flag-checkered' : 'fa-skull'"></i>
            </div>
            <h2 class="text-4xl font-bold text-white mb-2" x-text="caseStudy.metrics.politicalCapital > 0 ? 'MISSION COMPLETE' : 'TERMINATED'"></h2>
            <p class="text-xl text-slate-300" x-text="caseStudy.finalMessage"></p>
        </div>

        <!-- AI DEBRIEF BOX -->
        <div class="bg-slate-900 border border-slate-700 p-6 rounded-xl relative overflow-hidden group mb-8">
            
            <div class="flex justify-between items-center mb-4">
                <h3 class="font-mono text-white font-bold flex items-center gap-2">
                    <i class="fa-solid fa-robot text-white"></i> 
                    PERFORMANCE REVIEW AI
                </h3>
                <span class="text-[10px] uppercase bg-slate-800 text-slate-300 px-2 py-1 rounded border border-slate-700">
                    Decision Log Ready
                </span>
            </div>

            <div class="font-mono text-xs text-slate-400 bg-black/50 p-4 rounded border border-slate-800 mb-4 h-24 overflow-hidden relative">
                <div class="absolute inset-0 bg-gradient-to-b from-transparent to-black/90 pointer-events-none"></div>
                <pre class="whitespace-pre-wrap font-sans" x-text="caseStudy.generateSimulatorPrompt()"></pre>
            </div>

            <button @click="
                    copyToClipboard(caseStudy.generateSimulatorPrompt(), 'Sim Results');
                    $el.innerHTML = '<i class=\'fa-solid fa-check\'></i> DATA EXPORTED';
                    $el.classList.add('bg-white', 'text-black', 'border-white');
                    setTimeout(() => {
                        $el.innerHTML = '<i class=\'fa-solid fa-wand-magic-sparkles\'></i> COPY REVIEW FOR AI';
                        $el.classList.remove('bg-white', 'text-black', 'border-white');
                    }, 2000)
                    " 
                    class="w-full py-4 bg-transparent border border-slate-500 text-white hover:bg-white hover:text-black font-bold rounded-lg transition-all flex items-center justify-center gap-2 font-mono text-xs uppercase tracking-widest">
                <i class="fa-solid fa-wand-magic-sparkles"></i> COPY REVIEW FOR AI
            </button>
            
            <p class="text-center text-[10px] text-slate-500 mt-3">
                Paste into AI to get a breakdown of your leadership psychology.
            </p>
        </div>

        <!-- Replay -->
        <div class="text-center">
            <button @click="caseStudy.start()" class="text-sm text-slate-400 hover:text-white underline decoration-dotted">
                <i class="fa-solid fa-rotate-right mr-2"></i>Reset Simulation
            </button>
        </div>

    </div>

</div>
            
<!-- NEGOTIATION DOJO (REDESIGNED) -->
<div x-show="currentTab === 'roleplay'" x-cloak class="max-w-4xl mx-auto pb-20">
    
    <!-- PHASE 1: LOBBY -->
    <div x-show="!negotiationDojo.active">
        <div class="text-center py-12">
            <h2 class="text-3xl font-mono font-bold text-orange-400 mb-4">Negotiation Dojo</h2>
            <p class="text-textMuted mb-8">Select a sparring partner. Logic-based simulation.</p>
            
            <div class="grid md:grid-cols-1 gap-6 max-w-md mx-auto">
                <template x-for="(scen, idx) in negotiationDojo.scenarios" :key="idx">
                    <button @click="negotiationDojo.start(idx)" 
                            class="bg-slate-900 border border-slate-700 hover:border-orange-400 p-6 rounded-xl text-left transition-all hover:shadow-[0_0_20px_rgba(251,146,60,0.2)]">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-xs font-bold bg-orange-900/50 text-orange-400 px-2 py-1 rounded border border-orange-500/30">LEVEL 1</span>
                            <i class="fa-solid fa-arrow-right text-slate-500"></i>
                        </div>
                        <h3 class="text-xl font-bold text-white" x-text="scen.title"></h3>
                        <p class="text-sm text-slate-400 mt-1">Opponent: <span class="text-white" x-text="scen.opponent"></span></p>
                    </button>
                </template>
            </div>
        </div>
    </div>

    <!-- PHASE 2: THE ARENA -->
    <div x-show="negotiationDojo.active && !negotiationDojo.gameOver" class="space-y-6">
        
        <!-- Telemetry Bar -->
        <div class="bg-slate-900 border border-slate-700 p-4 rounded-xl flex justify-between items-center shadow-lg">
            <!-- Trust -->
            <div class="flex-1 px-4 border-r border-slate-700">
                <div class="flex justify-between text-[10px] uppercase font-bold text-slate-400 mb-1">
                    <span>Trust</span>
                    <span x-text="negotiationDojo.metrics.trust"></span>
                </div>
                <div class="w-full bg-slate-800 h-1.5 rounded-full overflow-hidden">
                    <div class="h-full bg-green-500 transition-all duration-500" :style="`width: ${negotiationDojo.metrics.trust}%`"></div>
                </div>
            </div>
            <!-- Leverage -->
            <div class="flex-1 px-4 border-r border-slate-700">
                <div class="flex justify-between text-[10px] uppercase font-bold text-slate-400 mb-1">
                    <span>Leverage</span>
                    <span x-text="negotiationDojo.metrics.leverage"></span>
                </div>
                <div class="w-full bg-slate-800 h-1.5 rounded-full overflow-hidden">
                    <div class="h-full bg-blue-500 transition-all duration-500" :style="`width: ${negotiationDojo.metrics.leverage}%`"></div>
                </div>
            </div>
            <!-- Patience -->
            <div class="px-4 text-center">
                <div class="text-[10px] uppercase font-bold text-slate-400 mb-1">Patience</div>
                <div class="flex gap-1">
                    <template x-for="i in 3">
                        <div class="w-2 h-2 rounded-full transition-all" 
                             :class="i <= negotiationDojo.metrics.patience ? 'bg-orange-500 shadow-[0_0_5px_orange]' : 'bg-slate-800'"></div>
                    </template>
                </div>
            </div>
        </div>

        <!-- Opponent Dialogue -->
        <div class="bg-card border-l-4 border-orange-500 p-8 rounded-r-xl shadow-2xl relative">
            <span class="absolute top-4 left-4 text-[10px] font-mono text-orange-400 uppercase tracking-widest" x-text="negotiationDojo.currentScenario?.opponent"></span>
            <p class="text-xl md:text-2xl text-white font-medium mt-4 leading-relaxed italic">
                "<span x-text="negotiationDojo.currentScenario?.nodes[negotiationDojo.currentNode].text"></span>"
            </p>
        </div>

        <!-- Tactical Options -->
        <div class="grid gap-4">
            <template x-for="(opt, idx) in negotiationDojo.currentScenario?.nodes[negotiationDojo.currentNode].options" :key="idx">
                <button @click="negotiationDojo.choose(opt)" 
                        class="group text-left p-5 rounded-xl border border-slate-600 bg-slate-800 hover:bg-slate-700 hover:border-white transition-all relative overflow-hidden">
                    
                    <div class="relative z-10 flex justify-between items-center">
                        <span class="text-sm font-bold text-slate-200 group-hover:text-white" x-text="opt.text"></span>
                        <i class="fa-solid fa-chevron-right text-slate-600 group-hover:text-white transition-colors"></i>
                    </div>
                    
                    <!-- Hover Impact Preview (Optional: Show impact on hover) -->
                    <div class="h-1 bg-gradient-to-r from-transparent via-white/10 to-transparent absolute bottom-0 left-0 right-0 opacity-0 group-hover:opacity-100 transition-opacity"></div>
                </button>
            </template>
        </div>

    </div>

    <!-- PHASE 3: DEBRIEF & AI PROMPT -->
    <div x-show="negotiationDojo.gameOver" class="max-w-3xl mx-auto text-center pt-10">
        
        <!-- Outcome Icon -->
        <div class="mb-6 inline-flex items-center justify-center w-24 h-24 rounded-full border-4 shadow-2xl"
             :class="negotiationDojo.result === 'win' ? 'border-green-500 bg-green-500/10' : 'border-red-500 bg-red-500/10'">
            <i class="fa-solid text-5xl" 
               :class="negotiationDojo.result === 'win' ? 'fa-handshake text-green-500' : 'fa-hand-paper text-red-500'"></i>
        </div>

        <h2 class="text-4xl font-bold text-white mb-2" x-text="negotiationDojo.result === 'win' ? 'DEAL CLOSED' : 'WALKED AWAY'"></h2>
        <p class="text-slate-400 mb-10" x-text="negotiationDojo.finalMessage"></p>

        <!-- AI Coaching Box -->
        <div class="bg-slate-900 border border-orange-500/30 p-6 rounded-xl text-left relative overflow-hidden group">
            
            <div class="flex justify-between items-center mb-4 relative z-10">
                <h3 class="font-mono text-white font-bold flex items-center gap-2">
                    <i class="fa-solid fa-user-secret text-orange-400"></i> 
                    PSYCHOLOGICAL ANALYSIS
                </h3>
                <span class="text-[10px] uppercase bg-orange-900/50 text-orange-400 px-2 py-1 rounded border border-orange-500/30 font-bold tracking-wider">
                    Trace Generated
                </span>
            </div>

            <!-- Preview -->
            <div class="relative z-10 font-mono text-xs text-slate-300 bg-black/60 p-4 rounded border border-slate-700 mb-4 h-28 overflow-hidden">
                <div class="absolute inset-0 bg-gradient-to-b from-transparent to-black/90 pointer-events-none"></div>
                <pre class="whitespace-pre-wrap font-sans leading-relaxed" x-text="negotiationDojo.generateNegotiationPrompt()"></pre>
            </div>

            <!-- Copy Button -->
            <button @click="
                    copyToClipboard(negotiationDojo.generateNegotiationPrompt(), 'Analysis Data');
                    $el.innerHTML = '<i class=\'fa-solid fa-check\'></i> COPIED';
                    $el.classList.add('bg-green-500', 'text-white', 'border-green-500');
                    setTimeout(() => {
                        $el.innerHTML = '<i class=\'fa-solid fa-wand-magic-sparkles\'></i> ANALYZE MY PSYCHOLOGY (AI)';
                        $el.classList.remove('bg-green-500', 'text-white', 'border-green-500');
                    }, 2000)
                    " 
                    class="relative z-10 w-full py-4 bg-transparent border border-orange-500 text-orange-400 hover:bg-orange-400 hover:text-black font-bold rounded-lg transition-all duration-300 flex items-center justify-center gap-2 font-mono text-xs uppercase tracking-widest shadow-[0_0_10px_rgba(251,146,60,0.1)] hover:shadow-[0_0_20px_rgba(251,146,60,0.4)]">
                <i class="fa-solid fa-wand-magic-sparkles"></i> ANALYZE MY PSYCHOLOGY (AI)
            </button>
            
            <p class="text-center text-[10px] text-slate-500 mt-3 relative z-10">
                Generates a detailed breakdown of your negotiation tactics, leverage points, and mistakes.
            </p>
        </div>

        <div class="mt-8">
            <button @click="negotiationDojo.restart()" class="text-slate-500 hover:text-white text-sm underline decoration-dotted">
                Return to Lobby
            </button>
        </div>

    </div>

</div>
             
             <!-- CULTURAL DEBT MONITOR TAB -->
            <div x-show="currentTab === 'culture'" x-cloak class="max-w-4xl mx-auto">
                
                <div class="flex justify-between items-end mb-6">
                    <div>
                        <h2 class="text-3xl font-mono font-bold text-white">Cultural Debt Monitor</h2>
                        <p class="text-textMuted text-sm mt-1">Intangible friction, measured.</p>
                    </div>
                    <button @click="culturalMonitor.isCheckinOpen = true" class="bg-primary hover:bg-green-400 text-dark font-bold py-2 px-6 rounded-full shadow-glow transition-all">
                        <i class="fa-solid fa-plus mr-2"></i>Log Check-In
                    </button>
                </div>

                <!-- EMPTY STATE -->
                <div x-show="culturalMonitor.history.length === 0" class="text-center py-12 bg-card border border-slate-700 rounded-xl border-dashed">
                    <i class="fa-solid fa-chart-line text-4xl text-slate-500 mb-4"></i>
                    <p class="text-slate-400">No data points yet. Log your first weekly check-in.</p>
                </div>

                <!-- DASHBOARD (Visible if history exists) -->
                <div x-show="culturalMonitor.history.length > 0">
                    
                    <!-- The Meter -->
                    <div class="grid md:grid-cols-2 gap-6 mb-8">
                        <div class="bg-card border border-slate-700 p-6 rounded-xl relative overflow-hidden">
                            <h3 class="font-mono text-xs text-slate-400 uppercase mb-2">Current Debt Level</h3>
                            <div class="flex items-baseline gap-2">
                                <span class="text-6xl font-bold font-mono" :class="culturalMonitor.status.color" x-text="culturalMonitor.currentScore + '%'"></span>
                                <span class="text-sm font-bold uppercase tracking-widest" :class="culturalMonitor.status.color" x-text="culturalMonitor.status.label"></span>
                            </div>
                            <p class="text-xs text-slate-300 mt-2" x-text="culturalMonitor.status.desc"></p>
                            
                            <!-- Background Pulse -->
                            <div class="absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-transparent to-white opacity-5 rounded-full blur-2xl"></div>
                        </div>

                        <div class="bg-card border border-slate-700 p-6 rounded-xl flex flex-col justify-center">
                            <h3 class="font-mono text-xs text-slate-400 uppercase mb-2"><i class="fa-solid fa-user-doctor mr-2"></i>Prescription</h3>
                            <p class="text-white text-sm leading-relaxed font-medium">"<span x-text="culturalMonitor.recommendation"></span>"</p>
                        </div>
                    </div>

                    <!-- The Chart -->
                    <div class="bg-card border border-slate-700 p-6 rounded-xl shadow-lg mb-8">
                        <h3 class="font-mono text-xs text-slate-400 uppercase mb-4">Trend Analysis (Last 10 Check-ins)</h3>
                        <div class="h-64 w-full">
                            <canvas id="debtChart"></canvas>
                        </div>
                        <!-- CULTURAL AI PROMPT BOX -->
<div x-show="culturalMonitor.history.length > 0" class="mt-8 bg-slate-900 border border-risk/30 p-6 rounded-xl relative overflow-hidden group">
    
    <!-- Decorative Icon -->
    <div class="absolute top-0 right-0 p-4 opacity-10 pointer-events-none">
        <i class="fa-solid fa-user-doctor text-9xl text-risk"></i>
    </div>

    <!-- Header -->
    <div class="flex justify-between items-center mb-4 relative z-10">
        <h3 class="font-mono text-white font-bold flex items-center gap-2">
            <i class="fa-solid fa-heart-pulse text-risk"></i> 
            CULTURAL DIAGNOSTICS
        </h3>
        <span class="text-[10px] uppercase bg-risk/20 text-risk px-2 py-1 rounded border border-risk/30 font-bold tracking-wider">
            Intervention Ready
        </span>
    </div>

    <!-- The Prompt Preview -->
    <div class="relative z-10 font-mono text-xs text-slate-300 bg-black/60 p-4 rounded border border-slate-700 mb-4 h-28 overflow-hidden">
        <div class="absolute inset-0 bg-gradient-to-b from-transparent to-black/90 pointer-events-none"></div>
        <pre class="whitespace-pre-wrap font-sans leading-relaxed" x-text="culturalMonitor.generateCulturePrompt()"></pre>
    </div>

    <!-- Copy Button -->
    <button @click="
            copyToClipboard(culturalMonitor.generateCulturePrompt(), 'Culture Prompt');
            $el.innerHTML = '<i class=\'fa-solid fa-check\'></i> COPIED';
            $el.classList.remove('border-risk', 'text-risk', 'hover:bg-risk');
            $el.classList.add('bg-green-500', 'text-white', 'border-green-500');
            setTimeout(() => {
                $el.innerHTML = '<i class=\'fa-solid fa-wand-magic-sparkles\'></i> COPY FOR AI COACH';
                $el.classList.remove('bg-green-500', 'text-white', 'border-green-500');
                $el.classList.add('border-risk', 'text-risk', 'hover:bg-risk');
            }, 2000)
            " 
            class="relative z-10 w-full py-4 bg-transparent border border-risk text-risk hover:bg-risk hover:text-dark font-bold rounded-lg transition-all duration-300 flex items-center justify-center gap-2 font-mono text-xs uppercase tracking-widest group-hover:shadow-glow">
        <i class="fa-solid fa-wand-magic-sparkles"></i> COPY FOR AI COACH
    </button>
    
    <p class="text-center text-[10px] text-slate-500 mt-3 relative z-10">
        Generates a psychological safety intervention based on your debt score.
    </p>

</div>
                    </div>

                    <div class="text-center">
                        <button @click="culturalMonitor.reset()" class="text-xs text-red-400 hover:text-red-300 underline">Reset History</button>
                    </div>
                </div>

                <!-- CHECK-IN MODAL -->
                <div x-show="culturalMonitor.isCheckinOpen" x-transition.opacity 
                     class="fixed inset-0 z-[60] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4">
                    <div class="bg-card border border-slate-600 p-8 rounded-2xl max-w-md w-full shadow-2xl relative">
                        <button @click="culturalMonitor.isCheckinOpen = false" class="absolute top-4 right-4 text-slate-400 hover:text-white"><i class="fa-solid fa-xmark text-xl"></i></button>
                        
                        <h3 class="text-2xl font-bold text-white mb-1">Weekly Pulse</h3>
                        <p class="text-xs text-textMuted mb-6 uppercase tracking-widest">Honesty required</p>

                        <div class="space-y-6">
                            <!-- Q1 -->
                            <div>
                                <p class="text-sm text-white mb-2 font-bold">1. Did anyone share "Bad News" openly this week?</p>
                                <div class="grid grid-cols-2 gap-3">
                                    <button @click="culturalMonitor.answers.q1 = 'yes'" :class="culturalMonitor.answers.q1 === 'yes' ? 'bg-primary text-dark ring-2 ring-primary' : 'bg-slate-800 text-slate-400'" class="p-3 rounded-lg text-sm font-bold transition-all">Yes (Safety)</button>
                                    <button @click="culturalMonitor.answers.q1 = 'no'" :class="culturalMonitor.answers.q1 === 'no' ? 'bg-risk text-dark ring-2 ring-risk' : 'bg-slate-800 text-slate-400'" class="p-3 rounded-lg text-sm font-bold transition-all">No (Fear)</button>
                                </div>
                            </div>

                            <!-- Q2 -->
                            <div>
                                <p class="text-sm text-white mb-2 font-bold">2. Did a senior opinion override data?</p>
                                <div class="grid grid-cols-2 gap-3">
                                    <button @click="culturalMonitor.answers.q2 = 'yes'" :class="culturalMonitor.answers.q2 === 'yes' ? 'bg-risk text-dark ring-2 ring-risk' : 'bg-slate-800 text-slate-400'" class="p-3 rounded-lg text-sm font-bold transition-all">Yes (HiPPO)</button>
                                    <button @click="culturalMonitor.answers.q2 = 'no'" :class="culturalMonitor.answers.q2 === 'no' ? 'bg-primary text-dark ring-2 ring-primary' : 'bg-slate-800 text-slate-400'" class="p-3 rounded-lg text-sm font-bold transition-all">No (Data)</button>
                                </div>
                            </div>

                            <!-- Q3 -->
                            <div>
                                <p class="text-sm text-white mb-2 font-bold">3. Did your team ship value to a customer?</p>
                                <div class="grid grid-cols-2 gap-3">
                                    <button @click="culturalMonitor.answers.q3 = 'yes'" :class="culturalMonitor.answers.q3 === 'yes' ? 'bg-primary text-dark ring-2 ring-primary' : 'bg-slate-800 text-slate-400'" class="p-3 rounded-lg text-sm font-bold transition-all">Yes (Flow)</button>
                                    <button @click="culturalMonitor.answers.q3 = 'no'" :class="culturalMonitor.answers.q3 === 'no' ? 'bg-risk text-dark ring-2 ring-risk' : 'bg-slate-800 text-slate-400'" class="p-3 rounded-lg text-sm font-bold transition-all">No (Stuck)</button>
                                </div>
                            </div>
                        </div>

                        <button @click="culturalMonitor.submitCheckin()" 
                                :disabled="!culturalMonitor.answers.q1 || !culturalMonitor.answers.q2 || !culturalMonitor.answers.q3"
                                class="w-full mt-8 bg-white hover:bg-slate-200 text-dark font-bold py-3 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed">
                            CALCULATE DEBT
                        </button>
                    </div>
                </div>

            </div>


<!-- VISUAL ARCHITECTURE SANDBOX -->
<div x-show="currentTab === 'sandbox'" class="max-w-5xl mx-auto space-y-6">
    
    <!-- Header -->
    <div class="text-center space-y-2">
        <div class="inline-flex items-center justify-center w-12 h-12 rounded-full bg-cyan-500/20 text-cyan-400 mb-2">
            <i class="fa-solid fa-shapes text-2xl"></i>
        </div>
        <h2 class="text-2xl font-bold text-white">Architecture Canvas</h2>
        <p class="text-slate-400">Drag & drop to visualize coupling, bottlenecks, and security risks.</p>
    </div>

    <!-- Toolbar -->
    <div class="bg-slate-800 p-4 rounded-xl border border-slate-700 flex flex-wrap gap-2 justify-center shadow-lg relative z-10">
        <template x-for="tool in apiSandbox.catalog">
            <button @click="apiSandbox.addNode(tool.type)"
                    class="px-4 py-2 bg-slate-700 hover:bg-slate-600 rounded-lg text-xs font-bold text-white flex gap-2 items-center transition-colors border border-slate-600">
                <i :class="'fa-solid ' + tool.icon"></i>
                <span x-text="tool.label"></span>
            </button>
        </template>
        <div class="w-px h-8 bg-slate-600 mx-2"></div>
        <button @click="apiSandbox.clearBoard()" class="px-4 py-2 text-red-400 hover:text-red-300 text-xs font-bold">
            <i class="fa-solid fa-trash mr-1"></i> Reset
        </button>
    </div>

    <!-- The Canvas Area -->
    <div class="relative w-full h-[500px] bg-slate-900 rounded-xl border border-slate-700 overflow-hidden shadow-inner group"
         @mousemove="apiSandbox.onDrag($event)" 
         @mouseup="apiSandbox.stopDrag()"
         @mouseleave="apiSandbox.stopDrag()">
        
        <!-- Background Grid -->
        <div class="absolute inset-0 opacity-10 pointer-events-none" 
             style="background-image: radial-gradient(#94a3b8 1px, transparent 1px); background-size: 20px 20px;">
        </div>

        <!-- Hint Text (Empty State) -->
        <div x-show="apiSandbox.nodes.length === 0" class="absolute inset-0 flex items-center justify-center pointer-events-none">
            <p class="text-slate-600 font-mono text-sm">Add components from the toolbar...</p>
        </div>

        <!-- LAYER 1: SVG Lines (The Wires) -->
        <!-- pointer-events-none ensures we can click through the lines to the divs below if needed -->
        <svg class="absolute inset-0 w-full h-full pointer-events-none z-0">
            <defs>
                <!-- Arrowhead marker -->
                <marker id="arrow" markerWidth="10" markerHeight="10" refX="10" refY="3" orient="auto" markerUnits="strokeWidth">
                  <path d="M0,0 L0,6 L9,3 z" fill="#64748b" />
                </marker>
            </defs>
            <template x-for="edge in apiSandbox.edges" :key="edge.id">
                <line 
                    :x1="apiSandbox.nodes.find(n => n.id === edge.from).x + 60" 
                    :y1="apiSandbox.nodes.find(n => n.id === edge.from).y + 30"
                    :x2="apiSandbox.nodes.find(n => n.id === edge.to).x + 60" 
                    :y2="apiSandbox.nodes.find(n => n.id === edge.to).y + 30"
                    stroke="#64748b" 
                    stroke-width="2" 
                    marker-end="url(#arrow)"
                />
            </template>
            <!-- Draw the "active" line if linking -->
            <template x-if="apiSandbox.linkingNode">
               <!-- Placeholder for dynamic line visual if desired later -->
            </template>
        </svg>

        <!-- LAYER 2: The Nodes (Draggable Divs) -->
        <template x-for="node in apiSandbox.nodes" :key="node.id">
            <div class="absolute w-[120px] h-[60px] bg-slate-800 border rounded-lg flex flex-col items-center justify-center shadow-lg cursor-grab active:cursor-grabbing select-none transition-shadow z-10"
                 :class="apiSandbox.linkingNode === node.id ? 'border-yellow-400 ring-2 ring-yellow-400/50' : 'border-slate-600 hover:border-cyan-400'"
                 :style="`left: ${node.x}px; top: ${node.y}px`"
                 @mousedown="apiSandbox.startDrag(node.id, $event)">
                
                <!-- Icon & Label -->
                <i class="fa-solid text-lg mb-1" 
                   :class="{
                       'fa-mobile-screen text-blue-400': node.type==='mobile',
                       'fa-server text-red-400': node.type==='core',
                       'fa-network-wired text-green-400': node.type==='api',
                       'fa-database text-yellow-400': node.type==='db',
                       'fa-cubes text-purple-400': node.type==='micro',
                       'fa-cloud text-slate-400': node.type==='3rd'
                   }"></i>
                <span class="text-[10px] font-bold text-slate-300 uppercase tracking-wide" x-text="node.label"></span>

                <!-- Link Action Button -->
                <button @click.stop="apiSandbox.startLink(node.id)" 
                        title="Connect"
                        class="absolute -right-3 top-1/2 -translate-y-1/2 w-6 h-6 rounded-full bg-slate-700 border border-slate-500 text-slate-300 hover:bg-cyan-500 hover:text-white hover:border-cyan-400 flex items-center justify-center transition-all shadow-md z-20">
                    <i class="fa-solid fa-link text-[10px]"></i>
                </button>

                <!-- Delete Button (Hover Only) -->
                <button @click.stop="apiSandbox.removeNode(node.id)"
                        class="absolute -top-2 -left-2 w-5 h-5 rounded-full bg-red-500/20 text-red-500 hover:bg-red-500 hover:text-white flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity"
                        title="Delete">
                    <i class="fa-solid fa-xmark text-[10px]"></i>
                </button>
            </div>
        </template>

    </div>

    <!-- 3. Diagnostics Panel -->
    <div class="grid md:grid-cols-2 gap-4">
        
        <!-- Scorecard -->
        <div class="bg-slate-800 p-5 rounded-xl border border-slate-700 flex items-center justify-between">
            <div>
                <h4 class="text-xs text-slate-400 uppercase font-bold tracking-wider mb-1">Architecture Score</h4>
                <div class="text-3xl font-black" :class="apiSandbox.analysis.color" x-text="apiSandbox.analysis.score + '%'"></div>
                <div class="text-sm font-bold text-white mt-1" x-text="apiSandbox.analysis.verdict"></div>
            </div>
            <div class="h-12 w-12 rounded-full bg-slate-700 flex items-center justify-center">
                 <i class="fa-solid fa-stethoscope text-slate-400"></i>
            </div>
        </div>

        <!-- Issues List -->
        <div class="bg-slate-800 p-5 rounded-xl border border-slate-700">
            <h4 class="text-xs text-slate-400 uppercase font-bold tracking-wider mb-3">Detected Risks</h4>
            
            <template x-if="apiSandbox.analysis.issues.length === 0">
                <div class="text-green-400 text-sm flex items-center gap-2">
                    <i class="fa-solid fa-check-circle"></i> System appears stable.
                </div>
            </template>

            <ul class="space-y-2">
                <template x-for="issue in apiSandbox.analysis.issues">
                    <li class="text-xs text-slate-300 bg-slate-900/50 p-2 rounded border border-slate-700/50 flex gap-2 items-start">
                        <span x-text="issue.includes('CRITICAL') ? '' : ''"></span>
                        <span x-text="issue"></span>
                    </li>
                </template>
            </ul>
        </div>
    </div>

    <!-- AI Prompt Button -->
    <div class="text-center pt-4">
        <button @click="copyToClipboard(apiSandbox.generateArchPrompt(), 'Architecture Assessment')"
                class="inline-flex items-center gap-2 px-6 py-3 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg font-bold transition-all shadow-lg shadow-indigo-900/20">
            <i class="fa-solid fa-wand-magic-sparkles"></i>
            Generate Architect's Memo
        </button>
        <p class="text-xs text-slate-500 mt-2">Copies a blueprint analysis prompt for ChatGPT.</p>
    </div>

</div>
             
             <!-- WAR GAMES TAB (REDESIGNED) -->
<div x-show="currentTab === 'whatif'" x-cloak class="max-w-5xl mx-auto pb-20">
    
    <!-- PHASE 1: MISSION SELECT -->
    <div x-show="!warGames.active">
        <div class="text-center py-12">
            <h2 class="text-3xl font-mono font-bold text-purple-500 mb-4">Strategic War Games</h2>
            <p class="text-textMuted mb-8">Choose a crisis. Make executive decisions. Live with the consequences.</p>
            
            <div class="grid md:grid-cols-1 gap-6 max-w-lg mx-auto">
                <template x-for="(scen, idx) in warGames.scenarios" :key="idx">
                    <button @click="warGames.start(idx)" 
                            class="bg-slate-900 border border-slate-700 hover:border-purple-500 p-6 rounded-xl text-left transition-all hover:shadow-[0_0_20px_rgba(168,85,247,0.2)] group">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-[10px] font-bold bg-purple-900/50 text-purple-400 px-2 py-1 rounded border border-purple-500/30">SCENARIO 001</span>
                            <i class="fa-solid fa-play text-slate-500 group-hover:text-purple-400"></i>
                        </div>
                        <h3 class="text-xl font-bold text-white mb-2" x-text="scen.title"></h3>
                        <p class="text-sm text-slate-400 leading-relaxed" x-text="scen.brief"></p>
                    </button>
                </template>
            </div>
        </div>
    </div>

    <!-- PHASE 2: WAR ROOM (ACTIVE) -->
    <div x-show="warGames.active && !warGames.gameOver" class="space-y-6">
        
        <!-- Strategic HUD -->
        <div class="bg-slate-900 border-y md:border border-slate-700 p-4 md:rounded-xl flex justify-between items-center shadow-2xl sticky top-0 z-20 backdrop-blur-md bg-slate-900/90">
            <!-- Capital -->
            <div class="flex-1 px-2 md:px-6 border-r border-slate-700 text-center">
                <div class="text-[10px] uppercase font-bold text-slate-500 mb-1">Capital</div>
                <div class="text-lg md:text-2xl font-mono font-bold" :class="warGames.metrics.capital < 30 ? 'text-red-500' : 'text-green-400'">
                    $<span x-text="warGames.metrics.capital"></span>M
                </div>
            </div>
            <!-- Innovation -->
            <div class="flex-1 px-2 md:px-6 border-r border-slate-700 text-center">
                <div class="text-[10px] uppercase font-bold text-slate-500 mb-1">Innovation</div>
                <div class="text-lg md:text-2xl font-mono font-bold text-purple-400">
                    <span x-text="warGames.metrics.innovation"></span> pts
                </div>
            </div>
            <!-- Stability -->
            <div class="flex-1 px-2 md:px-6 text-center">
                <div class="text-[10px] uppercase font-bold text-slate-500 mb-1">Stability</div>
                <div class="text-lg md:text-2xl font-mono font-bold" :class="warGames.metrics.stability < 40 ? 'text-red-500' : 'text-blue-400'">
                    <span x-text="warGames.metrics.stability"></span>%
                </div>
            </div>
        </div>

        <!-- The Situation Board -->
        <div class="bg-card border border-slate-700 p-8 rounded-xl shadow-lg relative min-h-[200px] flex items-center justify-center">
            <div class="absolute top-0 left-0 w-1 h-full bg-purple-500 rounded-l-xl"></div>
            <p class="text-xl md:text-2xl text-white font-medium text-center leading-relaxed">
                "<span x-text="warGames.currentScenario?.nodes[warGames.currentNode].text"></span>"
            </p>
        </div>

        <!-- Command Console (Choices) -->
        <div class="grid md:grid-cols-2 gap-4">
            <template x-for="(opt, idx) in warGames.currentScenario?.nodes[warGames.currentNode].options" :key="idx">
                <button @click="warGames.choose(opt)" 
                        class="group text-left p-6 rounded-xl border border-slate-600 bg-slate-800 hover:bg-slate-700 hover:border-purple-400 transition-all relative overflow-hidden h-full">
                    
                    <div class="relative z-10">
                        <span class="text-[10px] font-mono text-slate-500 uppercase mb-2 block">STRATAGEM <span x-text="String.fromCharCode(65 + idx)"></span></span>
                        <span class="text-sm font-bold text-white block mb-4" x-text="opt.text"></span>
                        
                        <!-- Mini Impact Preview -->
                        <div class="flex gap-2 text-[10px] font-mono opacity-50 group-hover:opacity-100 transition-opacity">
                            <span x-show="opt.impact.capital < 0" class="text-red-400">Cap <i class="fa-solid fa-arrow-down"></i></span>
                            <span x-show="opt.impact.innovation > 0" class="text-purple-400">Inn <i class="fa-solid fa-arrow-up"></i></span>
                            <span x-show="opt.impact.stability < 0" class="text-orange-400">Stb <i class="fa-solid fa-arrow-down"></i></span>
                        </div>
                    </div>
                </button>
            </template>
        </div>

    </div>

    <!-- PHASE 3: DEBRIEF & AI ANALYSIS -->
    <div x-show="warGames.gameOver" class="max-w-3xl mx-auto text-center pt-10">
        
        <!-- Outcome Visual -->
        <div class="mb-6 inline-flex items-center justify-center w-24 h-24 rounded-full border-4 shadow-[0_0_30px_currentColor]"
             :class="{
                'border-green-500 text-green-500 bg-green-500/10': warGames.result === 'victory',
                'border-red-500 text-red-500 bg-red-500/10': warGames.result === 'bankruptcy' || warGames.result === 'regulatory_shutdown',
                'border-yellow-500 text-yellow-500 bg-yellow-500/10': warGames.result === 'stagnation'
             }">
            <i class="fa-solid text-5xl" 
               :class="{
                'fa-trophy': warGames.result === 'victory',
                'fa-land-mine-on': warGames.result === 'bankruptcy',
                'fa-gavel': warGames.result === 'regulatory_shutdown',
                'fa-stopwatch': warGames.result === 'stagnation'
               }"></i>
        </div>

        <h2 class="text-4xl font-bold text-white mb-2 uppercase" x-text="warGames.result.replace('_', ' ')"></h2>
        <p class="text-slate-400 mb-10 text-lg" x-text="warGames.finalMessage"></p>

        <!-- AI Post-Mortem Box -->
        <div class="bg-slate-900 border border-purple-500/30 p-6 rounded-xl text-left relative overflow-hidden group mb-8">
            
            <div class="flex justify-between items-center mb-4 relative z-10">
                <h3 class="font-mono text-white font-bold flex items-center gap-2">
                    <i class="fa-solid fa-chess text-purple-400"></i> 
                    STRATEGIC POST-MORTEM
                </h3>
                <span class="text-[10px] uppercase bg-purple-900/50 text-purple-400 px-2 py-1 rounded border border-purple-500/30 font-bold tracking-wider">
                    Game Logs Ready
                </span>
            </div>

            <!-- Preview -->
            <div class="relative z-10 font-mono text-xs text-slate-300 bg-black/60 p-4 rounded border border-slate-700 mb-4 h-32 overflow-hidden">
                <div class="absolute inset-0 bg-gradient-to-b from-transparent to-black/90 pointer-events-none"></div>
                <pre class="whitespace-pre-wrap font-sans leading-relaxed" x-text="warGames.generateWarGamePrompt()"></pre>
            </div>

            <!-- Copy Button -->
            <button @click="
                    copyToClipboard(warGames.generateWarGamePrompt(), 'Strategy Logs');
                    $el.innerHTML = '<i class=\'fa-solid fa-check\'></i> COPIED';
                    $el.classList.add('bg-green-500', 'text-white', 'border-green-500');
                    setTimeout(() => {
                        $el.innerHTML = '<i class=\'fa-solid fa-wand-magic-sparkles\'></i> GENERATE POST-MORTEM (AI)';
                        $el.classList.remove('bg-green-500', 'text-white', 'border-green-500');
                    }, 2000)
                    " 
                    class="relative z-10 w-full py-4 bg-transparent border border-purple-500 text-purple-400 hover:bg-purple-400 hover:text-black font-bold rounded-lg transition-all duration-300 flex items-center justify-center gap-2 font-mono text-xs uppercase tracking-widest shadow-[0_0_10px_rgba(168,85,247,0.1)] hover:shadow-[0_0_20px_rgba(168,85,247,0.4)]">
                <i class="fa-solid fa-wand-magic-sparkles"></i> GENERATE POST-MORTEM (AI)
            </button>
            
            <p class="text-center text-[10px] text-slate-500 mt-3 relative z-10">
                Paste into AI to analyze your strategic blind spots and "Second Order Effects".
            </p>
        </div>

        <div class="mt-8">
            <button @click="warGames.restart()" class="text-slate-500 hover:text-white text-sm underline decoration-dotted">
                <i class="fa-solid fa-rotate-left mr-2"></i>Play Another Scenario
            </button>
        </div>

    </div>

</div>

             
             <!-- ASSESSMENT -->
            <div x-show="currentTab === 'assessment'" x-cloak class="max-w-4xl mx-auto">

                                <!-- TEAM COLLABORATION INTERFACE -->
                <div class="mb-8 border-b border-slate-700 pb-8">
                    
                    <!-- State 0: Intro (Join or Create) -->
                    <div x-show="!teamManager.activeTeam" class="bg-gradient-to-r from-slate-800 to-slate-900 p-6 rounded-xl border border-slate-700 flex flex-col md:flex-row items-center justify-between gap-6">
                        <div class="flex-1">
                            <h3 class="font-mono text-xl font-bold text-white mb-2"><i class="fa-solid fa-users mr-2 text-hotpink"></i>Team Mode</h3>
                            <p class="text-sm text-textMuted">Align your Board. Compare scores with your colleagues to find the "Reality Gap."</p>
                        </div>
                        <div class="flex flex-col md:flex-row gap-3 w-full md:w-auto">
                            <div class="flex">
                                <input type="text" x-model="teamManager.joinInput" placeholder="Enter Code" class="bg-dark border border-slate-600 rounded-l px-3 py-2 w-28 text-sm focus:outline-none uppercase font-mono">
                                <button @click="teamManager.joinTeam()" class="bg-slate-700 hover:bg-slate-600 px-4 py-2 rounded-r text-sm font-bold border border-l-0 border-slate-600">JOIN</button>
                            </div>
                            <div class="text-xs text-slate-500 flex items-center font-mono">OR</div>
                            <div class="flex">
                                <input type="text" x-model="teamManager.createInput" placeholder="New Team Name" class="bg-dark border border-slate-600 rounded-l px-3 py-2 w-32 text-sm focus:outline-none">
                                <button @click="teamManager.createTeam()" class="bg-hotpink hover:bg-pink-600 text-white px-4 py-2 rounded-r text-sm font-bold shadow-glow-vip">CREATE</button>
                            </div>
                        </div>
                    </div>

                    <!-- State 1: Active Team Dashboard -->
                    <div x-show="teamManager.activeTeam" class="bg-card border border-hotpink/30 p-6 rounded-xl relative overflow-hidden">
                        <!-- Header -->
                        <div class="flex justify-between items-start mb-6 relative z-10">
                            <div>
                                <span class="text-[10px] font-mono text-hotpink uppercase tracking-widest">ACTIVE SESSION</span>
                                <h3 class="text-2xl font-bold text-white flex items-center gap-3">
                                    <span x-text="teamManager.activeTeam?.name"></span>
                                    <span class="bg-slate-800 text-xs px-2 py-1 rounded font-mono text-slate-300" x-text="teamManager.activeTeam?.join_code"></span>
                                </h3>
                            </div>
                            <div class="flex gap-2">
                                <button @click="teamManager.copyInvite()" class="text-xs bg-slate-800 hover:bg-slate-700 text-white px-3 py-2 rounded transition-colors"><i class="fa-solid fa-share-nodes mr-2"></i>Invite</button>
                                <button @click="teamManager.logout()" class="text-xs bg-slate-800 hover:bg-red-900/50 text-slate-400 hover:text-red-400 px-3 py-2 rounded transition-colors"><i class="fa-solid fa-power-off"></i></button>
                            </div>
                        </div>

                        <!-- Stats Grid -->
                        <div x-show="teamManager.memberResults.length > 0" class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6 relative z-10">
                            <div class="bg-dark/50 p-4 rounded-lg border border-slate-700">
                                <div class="text-xs text-slate-400 font-mono uppercase mb-1">Respondents</div>
                                <div class="text-2xl font-bold text-white" x-text="teamManager.memberResults.length"></div>
                            </div>
                            <div class="bg-dark/50 p-4 rounded-lg border border-slate-700">
                                <div class="text-xs text-slate-400 font-mono uppercase mb-1">Avg Score</div>
                                <div class="text-2xl font-bold text-primary">
                                    <span x-text="Math.round(teamManager.memberResults.reduce((a,b)=>a+b.total_score,0)/teamManager.memberResults.length)"></span>/75
                                </div>
                            </div>
                            <div class="bg-dark/50 p-4 rounded-lg border border-slate-700">
                                <div class="text-xs text-slate-400 font-mono uppercase mb-1">Alignment</div>
                                <div class="text-2xl font-bold" :class="teamManager.alignmentScore > 80 ? 'text-primary' : 'text-warn'" x-text="teamManager.alignmentScore + '%'"></div>
                            </div>
                        </div>

                        <div x-show="teamManager.memberResults.length === 0" class="text-center py-6 text-slate-500 font-mono text-sm relative z-10">
                            Waiting for team members to submit...
                        </div>

                        <!-- Team List -->
                        <div x-show="teamManager.memberResults.length > 0" class="relative z-10">
                            <h4 class="font-mono text-xs text-slate-400 uppercase mb-3">Submission Log</h4>
                            <div class="space-y-2 max-h-40 overflow-y-auto pr-2">
                                <template x-for="member in teamManager.memberResults" :key="member.id">
                                    <div class="flex justify-between items-center text-sm p-2 rounded bg-slate-800/50">
                                        <span x-text="member.role" class="font-bold text-white"></span>
                                        <span class="font-mono" :class="member.total_score < 40 ? 'text-risk' : 'text-primary'" x-text="member.total_score"></span>
                                    </div>
                                </template>
                            </div>
                        </div>

                        <!-- Background Decoration -->
                        <div class="absolute -right-10 -bottom-10 opacity-10">
                            <i class="fa-solid fa-people-group text-9xl text-hotpink"></i>
                        </div>
                    </div>
                </div>

                <div x-show="!assessmentSubmitted">
                    <div class="flex justify-between items-center mb-6"><h2 class="font-mono text-2xl font-bold text-primary flex items-center"><i class="fa-solid fa-clipboard-check mr-3"></i>Agile Readiness Assessment</h2><button @click="resetAssessment()" class="text-xs text-textMuted underline hover:text-white"><i class="fa-solid fa-rotate-left mr-1"></i>Reset</button></div>
                      <div class="bg-card border border-slate-700 rounded-xl p-6 mb-6 border-l-4 border-blue-400">
        <label class="block text-sm font-mono text-white font-bold mb-4 uppercase">Step 0: Profile & Context</label>
        <div class="grid md:grid-cols-2 gap-6">
            <div>
                <label class="block text-xs font-mono text-textMuted mb-2">ORGANIZATION TYPE</label>
                <select x-model="selectedIndustry" class="w-full bg-dark border border-slate-600 rounded p-3 text-white font-mono focus:border-primary focus:outline-none">
                    <option value="" disabled selected>Select Organization...</option>
                    <option value="Tier-1 Bank">Tier-1 Bank (Global)</option>
                    <option value="Regional Bank">Regional Bank</option>
                    <option value="Fintech">Fintech / Scale-up</option>
                    <option value="Neobank">Neobank</option>
                    <option value="Regulator">Regulator / Central Bank</option>
                </select>
            </div>
            <div>
                <label class="block text-xs font-mono text-textMuted mb-2">YOUR ROLE</label>
                <select x-model="selectedTitle" class="w-full bg-dark border border-slate-600 rounded p-3 text-white font-mono focus:border-primary focus:outline-none">
                    <option value="" disabled selected>Select Your Role...</option>
                    <option value="C-Suite / Executive">C-Suite / Executive</option>
                    <option value="Head of Business / Product">Head of Business / Product</option>
                    <option value="Head of Technology">Head of Technology</option>
                    <option value="Architecture / Data">Architecture / Data</option>
                    <option value="Risk / Compliance">Risk / Compliance</option>
                </select>
            </div>
        </div>
    </div>
                    <div class="space-y-12 mb-20">
                        <template x-for="(section, sIdx) in assessmentData" :key="sIdx">
                            <div class="bg-card/50 p-6 rounded-xl border border-slate-800"><h3 class="font-mono text-xl text-white mb-6 border-l-4 border-primary pl-3" x-text="section.title"></h3><div class="space-y-8"><template x-for="(q, qIdx) in section.questions" :key="qIdx"><div class="bg-dark/50 p-5 rounded border border-slate-700"><div class="flex justify-between items-start mb-2"><label class="font-mono font-bold text-slate-200 text-sm uppercase tracking-wide" x-text="q.text"></label><span class="font-mono text-primary font-bold text-lg" x-text="q.score"></span></div><p class="text-xs text-textMuted mb-2" x-text="q.desc"></p><input type="range" min="1" max="5" step="1" x-model.number="q.score" class="w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer"></div></template></div></div>
                        </template>
                        <button @click="finishAssessment()" class="w-full py-4 bg-primary text-dark font-mono font-bold rounded-lg shadow-glow hover:bg-green-400 transition-colors flex justify-center items-center gap-2">CALCULATE SCORE <i class="fa-solid fa-calculator"></i></button>
                    </div>
                </div>

                <!-- Results -->
               <div x-show="calculateScore.isSafetyVeto" class="mb-4 p-4 border border-risk bg-risk/10 rounded flex items-start gap-3 text-left max-w-lg mx-auto"><i class="fa-solid fa-ban text-risk mt-1"></i><div><h4 class="font-mono font-bold text-risk text-sm">SAFETY VETO APPLIED</h4><p class="text-xs text-slate-300 mt-1">Low Safety score. Agility is impossible in fear. Score capped at 40.</p></div></div>
                        <div x-show="calculateScore.isManualDrag" class="mb-6 p-4 border border-warn bg-warn/10 rounded flex items-start gap-3 text-left max-w-lg mx-auto"><i class="fa-solid fa-hand text-warn mt-1"></i><div><h4 class="font-mono font-bold text-warn text-sm">MANUAL DRAG PENALTY</h4><p class="text-xs text-slate-300 mt-1">Manual compliance reduces velocity. -20% final score reduction applied.</p></div></div>

                        <!-- NEW ROADMAP GENERATOR UI -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 max-w-2xl mx-auto">
                            
                            <!-- Standard PDF Report -->
                            <button @click="generatePDF()" class="bg-card hover:bg-slate-700 border border-slate-600 text-white p-4 rounded-xl flex items-center justify-center gap-3 transition-all group">
                                <div class="bg-slate-700 group-hover:bg-slate-600 w-10 h-10 rounded-full flex items-center justify-center">
                                    <i class="fa-solid fa-file-pdf"></i>
                                </div>
                                <div class="text-left">
                                    <span class="block font-bold text-xs">DOWNLOAD REPORT</span>
                                    <span class="block text-[10px] text-textMuted">Standard Audit Certificate</span>
                                </div>
                            </button>

                            <!-- The New Roadmap Generator -->
                            <button @click="generateRoadmap()" class="bg-primary/10 hover:bg-primary/20 border border-primary text-primary p-4 rounded-xl flex items-center justify-center gap-3 transition-all group shadow-glow">
                                <div class="bg-primary text-dark w-10 h-10 rounded-full flex items-center justify-center group-hover:scale-110 transition-transform">
                                    <i class="fa-solid fa-map-location-dot"></i>
                                </div>
                                <div class="text-left">
                                    <span class="block font-bold text-xs">GENERATE PLAYBOOK</span>
                                    <span class="block text-[10px] opacity-80">90-Day Action Plan</span>
                                </div>
                            </button>
                        </div>


                <!-- STRATEGIC AI PROMPT BOX -->
<div x-show="assessmentSubmitted" class="mt-8 bg-slate-900 border border-primary/30 p-6 rounded-xl relative overflow-hidden group">
    
    <!-- Decorative Background -->
    <div class="absolute top-0 right-0 p-4 opacity-10 pointer-events-none">
        <i class="fa-solid fa-microchip text-9xl text-primary"></i>
    </div>

    <!-- Header -->
    <div class="flex justify-between items-center mb-4 relative z-10">
        <h3 class="font-mono text-white font-bold flex items-center gap-2">
            <i class="fa-solid fa-brain text-primary"></i> 
            STRATEGIC AI ANALYSIS
        </h3>
        <span class="text-[10px] uppercase bg-primary/20 text-primary px-2 py-1 rounded border border-primary/30 font-bold tracking-wider">
            Report Ready
        </span>
    </div>

    <!-- The Prompt Preview -->
    <div class="relative z-10 font-mono text-xs text-slate-300 bg-black/60 p-4 rounded border border-slate-700 mb-4 h-28 overflow-hidden">
        <div class="absolute inset-0 bg-gradient-to-b from-transparent to-black/90 pointer-events-none"></div>
        <pre class="whitespace-pre-wrap font-sans leading-relaxed" x-text="generateAuditPrompt()"></pre>
    </div>

    <!-- Action Buttons Row -->
    <div class="flex gap-3 relative z-10">
        
        <!-- Copy Button (Generic) -->
        <button @click="
                copyToClipboard(generateAuditPrompt(), 'Strategy Prompt');
                $el.innerHTML = '<i class=\'fa-solid fa-check\'></i> COPIED';
                $el.classList.add('bg-primary', 'text-dark', 'border-primary');
                setTimeout(() => {
                    $el.innerHTML = '<i class=\'fa-solid fa-wand-magic-sparkles\'></i> COPY FOR AI AGENT';
                    $el.classList.remove('bg-primary', 'text-dark', 'border-primary');
                }, 2000)
                " 
                class="flex-1 py-4 bg-transparent border border-primary text-primary hover:bg-primary hover:text-dark font-bold rounded-lg transition-all duration-300 flex items-center justify-center gap-2 font-mono text-xs uppercase tracking-widest group-hover:shadow-glow">
            <i class="fa-solid fa-wand-magic-sparkles"></i> COPY FOR AI AGENT
        </button>

        <!-- Reset Button -->
        <button @click="resetAssessment()" 
                class="px-6 py-4 bg-slate-800 border border-slate-600 text-slate-400 hover:text-white hover:bg-slate-700 hover:border-white font-bold rounded-lg transition-all duration-300 flex items-center justify-center gap-2 font-mono text-xs uppercase tracking-widest">
            <i class="fa-solid fa-rotate-left"></i> RESET
        </button>
    </div>
    
    <p class="text-center text-[10px] text-slate-500 mt-3 relative z-10">
        Compatible with ChatGPT, Claude, Gemini, or DeepSeek.
    </p>

</div>
                
                
                    <div class="mt-8 bg-card border border-slate-700 rounded-xl p-6 shadow-glow border-l-4 border-blue-400">
        <div class="flex justify-between items-start">
            <div>
                <h3 class="font-mono text-xl font-bold text-white mb-2 flex items-center">
                    <i class="fa-solid fa-globe mr-2 text-blue-400"></i>THE INDUSTRY INDEX
                </h3>
                
                <!-- State 1: Ready to Benchmark -->
                <div x-show="!percentileResult && !benchmarkLoading">
                    <p class="text-sm text-textMuted mb-3">Compare your score against the global database.</p>
                    <button @click="submitAndBenchmark()" class="px-6 py-2 bg-blue-500 hover:bg-blue-400 text-white font-mono text-sm font-bold rounded shadow-glow transition-all">
                        CALCULATE BENCHMARK
                    </button>
                </div>

                <!-- State 2: Loading -->
                <div x-show="benchmarkLoading" class="flex items-center gap-2 text-blue-400 font-mono text-sm py-2">
                    <i class="fa-solid fa-circle-notch fa-spin"></i> CONNECTING TO SATELLITE...
                </div>

                <!-- State 3: Result -->
<template x-if="percentileResult">
    <div class="mt-2" x-transition>
        <span class="text-xs font-mono text-slate-400 uppercase tracking-widest">MARKET POSITION</span>
        <div class="text-4xl font-mono font-bold text-blue-400 my-1" x-text="percentileResult.rank"></div>
        <p class="text-sm text-white font-medium" x-text="percentileResult.msg"></p>
        <p class="text-xs text-slate-500 mt-2 font-mono">Based on <span x-text="totalBenchmarks"></span> verified audits.</p>
    </div>
</template>     
         </div>
                
            <div class="hidden md:block opacity-30">
                <i class="fa-solid fa-ranking-star text-6xl"></i>
            </div>
        </div>


                        <div class="mt-6">
                            <button @click="copyChallengeLink()" class="text-xs text-textMuted hover:text-white underline"><i class="fa-solid fa-link mr-2"></i><span x-text="copyBtnText"></span></button>
                        </div>
                    </div>
                 </div>
             </div>
            
<!-- TRANSLATOR TAB -->
            <div x-show="currentTab === 'translator'" x-cloak class="max-w-5xl mx-auto h-full flex flex-col">
                
                <!-- Header with Toggles -->
                <div class="flex flex-col md:flex-row md:items-center justify-between mb-6">
                    <h2 class="font-mono text-2xl font-bold text-blue-400 flex items-center">
                        <i class="fa-solid fa-language mr-3"></i>The Translator
                    </h2>
                    <div class="flex space-x-4 mt-4 md:mt-0 font-mono text-sm border-b border-slate-700 pb-2 md:border-0 md:pb-0">
                        <button @click="translatorView = 'dict'" 
                                :class="translatorView === 'dict' ? 'text-blue-400 border-b-2 border-blue-400' : 'text-slate-500 hover:text-white transition-colors'">
                            Dictionary
                        </button>
                        <button @click="translatorView = 'reporting'" 
                                :class="translatorView === 'reporting' ? 'text-blue-400 border-b-2 border-blue-400' : 'text-slate-500 hover:text-white transition-colors'">
                            Reporting Guide
                        </button>
                    </div>
                </div>

                <!-- VIEW 1: DICTIONARY -->
                <div x-show="translatorView === 'dict'" class="flex-1 flex flex-col">
                    <div class="mb-6 relative">
                        <input type="text" x-model="searchQuery" placeholder="Search technical or business terms..." class="w-full bg-card border border-slate-700 rounded-lg py-4 pl-12 pr-4 text-white focus:outline-none focus:border-blue-400 font-mono">
                        <i class="fa-solid fa-search absolute left-4 top-5 text-slate-500"></i>
                    </div>
                    <div class="grid gap-4 pb-20">
                        <template x-for="row in filteredDictionary" :key="row.banker">
                            <div class="bg-card border border-slate-800 p-5 rounded-lg hover:border-blue-400/50 transition-colors">
                                <div class="grid md:grid-cols-3 gap-4">
                                    <div><span class="text-[10px] text-textMuted font-mono block uppercase mb-1">Banker Says</span><p class="font-bold text-white" x-text="row.banker"></p></div>
                                    <div><span class="text-[10px] text-textMuted font-mono block uppercase mb-1">Engineer Says</span><p class="font-mono text-blue-300 text-sm" x-text="row.tech"></p></div>
                                    <div class="md:border-l border-slate-700 md:pl-4"><span class="text-[10px] text-primary font-mono block uppercase mb-1">True Meaning</span><p class="text-sm text-slate-300 italic" x-text="row.translation"></p></div>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>

                <!-- VIEW 2: REPORTING GUIDE -->
                <div x-show="translatorView === 'reporting'" class="pb-20 space-y-8">
                    <div class="bg-card border border-slate-700 rounded-xl p-6 border-l-4 border-blue-400">
                        <h3 class="font-mono text-lg font-bold text-white mb-2">The Rosetta Stone for Board Reporting</h3>
                        <p class="text-sm text-textMuted">Never present a raw technical metric to the Board. Always translate it into a financial outcome.</p>
                    </div>

                    <div class="grid gap-6">
                        <template x-for="item in reportingData" :key="item.metric">
                            <div class="bg-dark p-5 rounded-lg border border-slate-700 hover:border-blue-400 transition-colors">
                                <div class="grid md:grid-cols-12 gap-4 items-start">
                                    <div class="md:col-span-3">
                                        <span class="text-[10px] font-mono text-slate-500 uppercase tracking-widest block mb-1">IF YOU MEASURE...</span>
                                        <span class="font-mono text-sm font-bold text-blue-300" x-text="item.metric"></span>
                                    </div>
                                    <div class="hidden md:flex md:col-span-1 justify-center items-center pt-3">
                                        <i class="fa-solid fa-arrow-right text-slate-600"></i>
                                    </div>
                                    <div class="md:col-span-3">
                                        <span class="text-[10px] font-mono text-slate-500 uppercase tracking-widest block mb-1">TRANSLATE TO...</span>
                                        <span class="font-mono text-sm font-bold text-primary" x-text="item.financial"></span>
                                    </div>
                                    <div class="md:col-span-5 bg-slate-800/50 p-3 rounded border border-slate-700/50">
                                        <span class="text-[10px] font-mono text-slate-500 uppercase tracking-widest block mb-1">THE SCRIPT</span>
                                        <p class="text-sm italic text-slate-300 leading-relaxed">
                                            <i class="fa-solid fa-quote-left text-slate-600 text-xs mr-1"></i>
                                            <span x-text="item.script"></span>
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>

            </div>

<!-- MATRIX TAB (REDESIGNED) -->
<div x-show="currentTab === 'matrix'" x-cloak class="max-w-6xl mx-auto pb-20">
    
    <!-- Header -->
    <div class="mb-8 flex flex-col md:flex-row md:items-end justify-between border-b border-slate-800 pb-6">
        <div>
            <h2 class="font-mono text-3xl font-bold text-purple-400 flex items-center">
                <i class="fa-solid fa-chess-board mr-3"></i>Execution Strategy Matrix
            </h2>
            <p class="text-textMuted text-sm mt-2 max-w-xl">
                The "Build vs. Buy" decision framework. Don't build commodities. Don't outsource your secret sauce.
            </p>
        </div>
        <!-- Live Result Badge -->
        <div class="mt-4 md:mt-0 text-right">
            <span class="text-[10px] font-mono text-slate-500 uppercase tracking-widest block mb-1">RECOMMENDED STRATEGY</span>
            <div class="text-xl font-bold text-white bg-slate-800 px-4 py-2 rounded-lg border border-purple-500/30 shadow-[0_0_15px_rgba(168,85,247,0.1)]">
                <span x-text="getMatrixResult().strategy"></span>
            </div>
        </div>
    </div>

    <!-- Main Content Grid -->
    <div class="grid lg:grid-cols-12 gap-8 mb-8">
        
        <!-- Left Column: Controls -->
        <div class="lg:col-span-5 space-y-6">
            
            <!-- Y-Axis Control -->
            <div class="bg-card border border-slate-700 p-6 rounded-xl">
                <div class="flex justify-between mb-4 font-mono text-xs font-bold text-white">
                    <span>Commodity (Low Value)</span>
                    <span class="text-purple-400">Differentiator (High IP)</span>
                </div>
                <input type="range" min="0" max="100" x-model="matrixCoords.y" 
                       class="w-full h-2 bg-slate-800 rounded-lg appearance-none cursor-pointer accent-purple-500">
                <div class="mt-3 text-right font-mono text-xs text-slate-400">
                    Strategic Importance: <span x-text="matrixCoords.y"></span>%
                </div>
                <p class="text-[10px] text-slate-500 mt-2 leading-relaxed">
                    <strong class="text-white">The Test:</strong> If this software disappeared tomorrow, would your customers leave you?
                </p>
            </div>

            <!-- X-Axis Control -->
            <div class="bg-card border border-slate-700 p-6 rounded-xl">
                <div class="flex justify-between mb-4 font-mono text-xs font-bold text-white">
                    <span>Simple (CRUD App)</span>
                    <span class="text-purple-400">Complex (Rocket Science)</span>
                </div>
                <input type="range" min="0" max="100" x-model="matrixCoords.x" 
                       class="w-full h-2 bg-slate-800 rounded-lg appearance-none cursor-pointer accent-purple-500">
                <div class="mt-3 text-right font-mono text-xs text-slate-400">
                    Technical Complexity: <span x-text="matrixCoords.x"></span>%
                </div>
                <p class="text-[10px] text-slate-500 mt-2 leading-relaxed">
                    <strong class="text-white">The Test:</strong> Is this standard tech available off-the-shelf, or does it require specialized R&D?
                </p>
            </div>

        </div>

        <!-- Right Column: The Matrix Visual -->
        <div class="lg:col-span-7">
            <div class="bg-slate-900 border border-slate-700 rounded-xl relative aspect-square w-full max-w-[500px] mx-auto flex items-center justify-center overflow-hidden shadow-2xl">
                
                <!-- Background Labels -->
                <div class="absolute inset-0 grid grid-cols-2 grid-rows-2 pointer-events-none">
                    <!-- Top Left: BUILD -->
                    <div class="border-r border-b border-slate-800/50 p-4 relative bg-purple-500/5">
                        <span class="absolute top-4 left-4 text-xs font-bold font-mono text-purple-400">BUILD</span>
                        <span class="absolute top-8 left-4 text-[8px] text-slate-500 uppercase tracking-wider">Secret Sauce</span>
                    </div>
                    <!-- Top Right: PARTNER -->
                    <div class="border-b border-slate-800/50 p-4 relative">
                        <span class="absolute top-4 right-4 text-xs font-bold font-mono text-slate-400">PARTNER</span>
                        <span class="absolute top-8 right-4 text-[8px] text-slate-500 uppercase tracking-wider text-right">Hard but Needed</span>
                    </div>
                    <!-- Bottom Left: DEPRIORITIZE -->
                    <div class="border-r border-slate-800/50 p-4 relative">
                        <span class="absolute bottom-4 left-4 text-xs font-bold font-mono text-slate-600">IGNORE</span>
                        <span class="absolute bottom-8 left-4 text-[8px] text-slate-500 uppercase tracking-wider">Don't do it</span>
                    </div>
                    <!-- Bottom Right: OUTSOURCE -->
                    <div class="p-4 relative">
                        <span class="absolute bottom-4 right-4 text-xs font-bold font-mono text-slate-400">OUTSOURCE</span>
                        <span class="absolute bottom-8 right-4 text-[8px] text-slate-500 uppercase tracking-wider text-right">Commodity</span>
                    </div>
                </div>

                <!-- Center Grid Lines -->
                <div class="absolute inset-0 flex items-center justify-center pointer-events-none">
                    <div class="w-full h-px bg-slate-700"></div>
                    <div class="h-full w-px bg-slate-700 absolute"></div>
                </div>

                <!-- The Floating Dot -->
                <div class="absolute w-6 h-6 bg-purple-500 border-2 border-white rounded-full shadow-[0_0_20px_rgba(168,85,247,0.6)] transform -translate-x-1/2 -translate-y-1/2 transition-all duration-300 ease-out z-20 flex items-center justify-center" 
                     :style="`left: ${matrixCoords.x}%; bottom: ${matrixCoords.y}%`">
                    <div class="w-1 h-1 bg-white rounded-full"></div>
                </div>

            </div>
            
            <div class="mt-4 text-center">
                <p class="text-sm text-slate-300 italic" x-text="getMatrixResult().desc"></p>
            </div>
        </div>
    </div>

    <!-- AI DECISION MEMO BOX -->
    <div class="mt-8 bg-slate-900 border border-purple-500/30 p-6 rounded-xl relative overflow-hidden group">
        
        <!-- Icon -->
        <div class="absolute top-0 right-0 p-4 opacity-10 pointer-events-none">
            <i class="fa-solid fa-file-signature text-9xl text-purple-500"></i>
        </div>

        <!-- Header -->
        <div class="flex justify-between items-center mb-4 relative z-10">
            <h3 class="font-mono text-white font-bold flex items-center gap-2">
                <i class="fa-solid fa-robot text-purple-400"></i> 
                INVESTMENT COMMITTEE MEMO
            </h3>
            <span class="text-[10px] uppercase bg-purple-900/50 text-purple-400 px-2 py-1 rounded border border-purple-500/30 font-bold tracking-wider">
                <span x-text="getMatrixResult().strategy"></span> MODE
            </span>
        </div>

        <!-- Preview -->
        <div class="relative z-10 font-mono text-xs text-slate-300 bg-black/60 p-4 rounded border border-slate-700 mb-4 h-28 overflow-hidden">
            <div class="absolute inset-0 bg-gradient-to-b from-transparent to-black/90 pointer-events-none"></div>
            <pre class="whitespace-pre-wrap font-sans leading-relaxed" x-text="generateMatrixPrompt()"></pre>
        </div>

        <!-- Interactive Copy Button -->
        <button @click="
                copyToClipboard(generateMatrixPrompt(), 'Strategy Memo');
                $el.innerHTML = '<i class=\'fa-solid fa-check\'></i> DECISION LOGGED';
                $el.classList.remove('border-purple-500', 'text-purple-400', 'hover:bg-purple-400', 'hover:text-black');
                $el.classList.add('bg-green-500', 'text-white', 'border-green-500');
                setTimeout(() => {
                    $el.innerHTML = '<i class=\'fa-solid fa-wand-magic-sparkles\'></i> COPY MEMO FOR AI';
                    $el.classList.remove('bg-green-500', 'text-white', 'border-green-500');
                    $el.classList.add('border-purple-500', 'text-purple-400', 'hover:bg-purple-400', 'hover:text-black');
                }, 2000)
                " 
                class="relative z-10 w-full py-4 bg-transparent border border-purple-500 text-purple-400 hover:bg-purple-400 hover:text-black font-bold rounded-lg transition-all duration-300 flex items-center justify-center gap-2 font-mono text-xs uppercase tracking-widest shadow-[0_0_10px_rgba(168,85,247,0.1)] hover:shadow-[0_0_20px_rgba(168,85,247,0.4)]">
            <i class="fa-solid fa-wand-magic-sparkles"></i> COPY MEMO FOR AI
        </button>
        
        <p class="text-center text-[10px] text-slate-500 mt-3 relative z-10">
            Generates a rigorous justification for building, buying, or killing this project.
        </p>

    </div>

</div>
        <!-- COMPASS TAB (REDESIGNED) -->
<div x-show="currentTab === 'compass'" x-cloak class="max-w-6xl mx-auto pb-20">
    
    <!-- Header Area -->
    <div class="mb-8 flex flex-col md:flex-row md:items-end justify-between border-b border-slate-800 pb-6">
        <div>
            <h2 class="font-mono text-3xl font-bold text-cyan-400 flex items-center">
                <i class="fa-regular fa-compass mr-3"></i>The Bilingual Compass
            </h2>
            <p class="text-textMuted text-sm mt-2 max-w-xl">
                Map your leadership style. Are you building value, or just cutting costs? Are you moving fast, or just minimizing risk?
            </p>
        </div>
        <!-- Live Result Badge -->
        <div class="mt-4 md:mt-0 text-right">
            <span class="text-[10px] font-mono text-slate-500 uppercase tracking-widest block mb-1">CURRENT TRAJECTORY</span>
            <div class="text-xl font-bold text-white bg-slate-800 px-4 py-2 rounded-lg border border-cyan-400/30 shadow-[0_0_15px_rgba(34,211,238,0.1)]">
                <span x-text="getCompassResult().title"></span>
            </div>
        </div>
    </div>

    <!-- Main Content Grid -->
    <div class="grid lg:grid-cols-12 gap-8 mb-8">
        
        <!-- Left Column: The Controls -->
        <div class="lg:col-span-5 space-y-6">
            
            <!-- Axis 1 Control -->
            <div class="bg-card border border-slate-700 p-6 rounded-xl">
                <div class="flex justify-between mb-4 font-mono text-xs font-bold text-white">
                    <span>SOUTH (Cost Center)</span>
                    <span class="text-cyan-400">NORTH (Value Gen)</span>
                </div>
                <input type="range" min="0" max="100" x-model="compassCoords.y" 
                       class="w-full h-2 bg-slate-800 rounded-lg appearance-none cursor-pointer accent-cyan-400">
                <div class="mt-3 text-right font-mono text-xs text-slate-400">
                    Coordinate Y: <span x-text="compassCoords.y"></span>%
                </div>
                <p class="text-[10px] text-slate-500 mt-2 leading-relaxed">
                    <strong class="text-white">Ask yourself:</strong> Is your primary mandate to "Keep the lights on for cheap" (0%) or "Create new revenue streams" (100%)?
                </p>
            </div>

            <!-- Axis 2 Control -->
            <div class="bg-card border border-slate-700 p-6 rounded-xl">
                <div class="flex justify-between mb-4 font-mono text-xs font-bold text-white">
                    <span>WEST (Risk Control)</span>
                    <span class="text-cyan-400">EAST (High Speed)</span>
                </div>
                <input type="range" min="0" max="100" x-model="compassCoords.x" 
                       class="w-full h-2 bg-slate-800 rounded-lg appearance-none cursor-pointer accent-cyan-400">
                <div class="mt-3 text-right font-mono text-xs text-slate-400">
                    Coordinate X: <span x-text="compassCoords.x"></span>%
                </div>
                <p class="text-[10px] text-slate-500 mt-2 leading-relaxed">
                    <strong class="text-white">Ask yourself:</strong> Do you need 5 signatures to deploy code (0%) or do you deploy on demand (100%)?
                </p>
            </div>

        </div>

        <!-- Right Column: The Visualizer -->
        <div class="lg:col-span-7">
            <div class="bg-slate-900 border border-slate-700 rounded-xl relative aspect-square w-full max-w-[500px] mx-auto flex items-center justify-center overflow-hidden shadow-2xl">
                
                <!-- Grid Lines -->
                <div class="absolute inset-0 grid grid-cols-2 grid-rows-2 pointer-events-none">
                    <div class="border-r border-b border-slate-800/50 p-2 relative">
                        <span class="absolute top-2 left-2 text-[10px] font-mono text-slate-600">RISK TAKER (NW)</span>
                    </div>
                    <div class="border-b border-slate-800/50 p-2 relative">
                        <span class="absolute top-2 right-2 text-[10px] font-mono text-cyan-400/50">LEADER (NE)</span>
                    </div>
                    <div class="border-r border-slate-800/50 p-2 relative">
                        <span class="absolute bottom-2 left-2 text-[10px] font-mono text-slate-600">TRADITIONAL (SW)</span>
                    </div>
                    <div class="p-2 relative">
                        <span class="absolute bottom-2 right-2 text-[10px] font-mono text-slate-600">FACTORY (SE)</span>
                    </div>
                </div>

                <!-- Center Crosshair -->
                <div class="absolute inset-0 flex items-center justify-center pointer-events-none">
                    <div class="w-full h-px bg-cyan-400/20"></div>
                    <div class="h-full w-px bg-cyan-400/20 absolute"></div>
                </div>

                <!-- The Floating Dot (Now unobscured) -->
                <div class="absolute w-6 h-6 bg-cyan-400 border-2 border-white rounded-full shadow-[0_0_20px_rgba(34,211,238,0.6)] transform -translate-x-1/2 -translate-y-1/2 transition-all duration-300 ease-out z-20 flex items-center justify-center" 
                     :style="`left: ${compassCoords.x}%; bottom: ${compassCoords.y}%`">
                    <div class="w-1 h-1 bg-white rounded-full"></div>
                </div>

                <!-- Radar Sweep Animation -->
                <div class="absolute inset-0 rounded-full border border-cyan-400/10 scale-0 animate-[ping_3s_ease-out_infinite]"></div>
                <div class="absolute inset-0 rounded-full border border-cyan-400/10 scale-0 animate-[ping_3s_ease-out_infinite_1s]"></div>

            </div>
            
            <!-- Result Description (Moved below chart) -->
            <div class="mt-4 text-center">
                <p class="text-sm text-slate-300 italic" x-text="getCompassResult().desc"></p>
            </div>
        </div>
    </div>

    <!-- NEW: AI STRATEGY BOX -->
    <div class="mt-8 bg-slate-900 border border-cyan-500/30 p-6 rounded-xl relative overflow-hidden group">
        
        <!-- Decorative Icon -->
        <div class="absolute top-0 right-0 p-4 opacity-10 pointer-events-none">
            <i class="fa-solid fa-map-location-dot text-9xl text-cyan-400"></i>
        </div>

        <!-- Header -->
        <div class="flex justify-between items-center mb-4 relative z-10">
            <h3 class="font-mono text-white font-bold flex items-center gap-2">
                <i class="fa-solid fa-robot text-cyan-400"></i> 
                NAVIGATION AI STRATEGY
            </h3>
            <span class="text-[10px] uppercase bg-cyan-900/50 text-cyan-400 px-2 py-1 rounded border border-cyan-500/30 font-bold tracking-wider">
                <span x-text="compassCoords.x"></span>, <span x-text="compassCoords.y"></span>
            </span>
        </div>

        <!-- Prompt Preview -->
        <div class="relative z-10 font-mono text-xs text-slate-300 bg-black/60 p-4 rounded border border-slate-700 mb-4 h-28 overflow-hidden">
            <div class="absolute inset-0 bg-gradient-to-b from-transparent to-black/90 pointer-events-none"></div>
            <pre class="whitespace-pre-wrap font-sans leading-relaxed" x-text="generateCompassPrompt()"></pre>
        </div>

        <!-- Interactive Copy Button -->
        <button @click="
                copyToClipboard(generateCompassPrompt(), 'Compass Strategy');
                $el.innerHTML = '<i class=\'fa-solid fa-check\'></i> COURSE PLOTTED (COPIED)';
                $el.classList.remove('border-cyan-500', 'text-cyan-400', 'hover:bg-cyan-400', 'hover:text-black');
                $el.classList.add('bg-green-500', 'text-white', 'border-green-500');
                setTimeout(() => {
                    $el.innerHTML = '<i class=\'fa-solid fa-wand-magic-sparkles\'></i> COPY STRATEGY FOR AI';
                    $el.classList.remove('bg-green-500', 'text-white', 'border-green-500');
                    $el.classList.add('border-cyan-500', 'text-cyan-400', 'hover:bg-cyan-400', 'hover:text-black');
                }, 2000)
                " 
                class="relative z-10 w-full py-4 bg-transparent border border-cyan-500 text-cyan-400 hover:bg-cyan-400 hover:text-black font-bold rounded-lg transition-all duration-300 flex items-center justify-center gap-2 font-mono text-xs uppercase tracking-widest shadow-[0_0_10px_rgba(34,211,238,0.1)] hover:shadow-[0_0_20px_rgba(34,211,238,0.4)]">
            <i class="fa-solid fa-wand-magic-sparkles"></i> COPY STRATEGY FOR AI
        </button>
        
        <p class="text-center text-[10px] text-slate-500 mt-3 relative z-10">
            Get a tailored pivot strategy to move from "<span x-text="getCompassResult().title"></span>" to Market Leader.
        </p>

    </div>

</div>

            <!-- CANVAS -->
            <div x-show="currentTab === 'canvas'" x-cloak class="max-w-4xl mx-auto"><h2 class="font-mono text-2xl font-bold mb-6 text-white flex items-center"><i class="fa-solid fa-file-contract mr-3 text-blue-400"></i>Data Product Canvas</h2><div class="grid md:grid-cols-2 gap-8"><div class="space-y-4"><div><label class="text-xs font-mono text-textMuted">PRODUCT NAME</label><input type="text" x-model="canvasData.name" class="w-full bg-card border border-slate-700 rounded p-2 text-white font-mono"></div><div><label class="text-xs font-mono text-textMuted">OWNER</label><input type="text" x-model="canvasData.owner" class="w-full bg-card border border-slate-700 rounded p-2 text-white font-mono"></div><div><label class="text-xs font-mono text-textMuted">JOBS TO BE DONE</label><textarea x-model="canvasData.jobs" class="w-full bg-card border border-slate-700 rounded p-2 text-white font-mono h-20"></textarea></div><div><label class="text-xs font-mono text-textMuted">SLO: FRESHNESS</label><input type="text" x-model="canvasData.slo1" class="w-full bg-card border border-slate-700 rounded p-2 text-white font-mono"></div></div><div class="bg-white text-dark p-6 rounded-lg shadow-2xl relative font-sans"><div class="absolute top-0 left-0 w-full h-2 bg-blue-500 rounded-t-lg"></div><div class="flex justify-between items-start mb-6 mt-2"><div><h3 class="font-bold text-2xl uppercase tracking-tighter" x-text="canvasData.name || 'PRODUCT NAME'"></h3><p class="text-xs text-slate-500 font-mono mt-1">OWNER: <span x-text="canvasData.owner || '---'"></span></p></div><div class="bg-blue-100 text-blue-800 text-xs font-bold px-2 py-1 rounded">CERTIFIED</div></div><div class="grid grid-cols-2 gap-4 mb-4"><div class="border border-slate-200 p-3 rounded"><p class="text-[10px] text-slate-400 font-bold uppercase mb-1">CONSUMER JOB</p><p class="text-sm font-medium leading-tight" x-text="canvasData.jobs || '---'"></p></div><div class="border border-slate-200 p-3 rounded bg-slate-50"><p class="text-[10px] text-slate-400 font-bold uppercase mb-1">GUARANTEE (SLO)</p><ul class="text-sm font-mono space-y-1"><li class="flex items-center"><i class="fa-solid fa-clock mr-2 text-blue-500"></i> <span x-text="canvasData.slo1 || '---'"></span></li></ul></div></div></div></div></div>

        <!-- TALENT RADAR (Your Fixed Layout) -->
<div x-show="currentTab === 'talent'" x-cloak class="max-w-6xl mx-auto w-full pb-10">
    
    <!-- Compact Header -->
    <div class="flex flex-col md:flex-row justify-between items-start md:items-end mb-6 md:mb-8 border-b border-slate-800 pb-6">
        <div class="mb-4 md:mb-0">
            <h2 class="font-mono text-2xl md:text-3xl font-bold text-hotpink flex items-center mb-2">
                <i class="fa-solid fa-fingerprint mr-3"></i>Talent Radar
            </h2>
            <p class="hidden md:block text-textMuted text-sm max-w-2xl leading-relaxed">
                "We don't look for a 3/5 Mediocre Generalist. We look for <strong class="text-white">Spiky Profiles</strong>."
            </p>
        </div>
        <!-- Archetype Badge -->
        <div class="w-full md:w-auto">
             <div class="px-4 py-3 rounded bg-slate-800 border border-slate-700 flex items-center justify-between gap-3 shadow-lg">
                <span class="text-[10px] uppercase font-mono text-slate-500">Radar Shape</span>
                <div class="flex items-center gap-2">
                    <span class="font-bold text-white text-sm" x-text="talentManager.getArchetype(talentSkills).label"></span>
                    <i :class="talentManager.getArchetype(talentSkills).icon" class="text-hotpink"></i>
                </div>
             </div>
        </div>
    </div>

    <!-- Grid Layout -->
    <div class="flex flex-col lg:grid lg:grid-cols-12 gap-6 md:gap-8">
        
        <!-- CHART (Top on Mobile) -->
        <div class="order-1 lg:order-2 lg:col-span-5 flex flex-col gap-6">
            <div class="bg-card border border-slate-700 p-4 rounded-xl shadow-2xl relative overflow-hidden">
                <!-- UPDATED CHART CONTAINER -->
                <div class="h-56 md:h-64 w-full flex items-center justify-center relative z-10">
                    <canvas id="talentChart" width="400" height="400"></canvas>
                </div>
            </div>
            <!-- NEW DYNAMIC PROMPT AREA (Replaces Desktop Button) -->
<div class="mt-6 bg-slate-900 border border-slate-700 p-6 rounded-xl relative overflow-hidden group">
    
    <!-- Header -->
    <div class="flex justify-between items-center mb-4">
        <h3 class="font-mono text-white font-bold flex items-center gap-2">
            <i class="fa-solid fa-robot text-hotpink"></i> 
            AI CO-PILOT PROMPT
        </h3>
        <span class="text-[10px] uppercase bg-hotpink/20 text-hotpink px-2 py-1 rounded border border-hotpink/30">
            Based on your Radar
        </span>
    </div>

    <!-- Preview Text (Truncated) -->
    <div class="font-mono text-xs text-slate-400 bg-black/50 p-4 rounded border border-slate-800 mb-4 h-24 overflow-hidden relative">
        <div class="absolute inset-0 bg-gradient-to-b from-transparent to-black/90 pointer-events-none"></div>
        <pre class="whitespace-pre-wrap font-sans" x-text="talentManager.generateSystemPrompt(talentSkills)"></pre>
    </div>

    <!-- Interactive Copy Button -->
    <button @click="
            copyToClipboard(talentManager.generateSystemPrompt(talentSkills), 'AI Coach Prompt');
            $el.innerHTML = '<i class=\'fa-solid fa-check\'></i> COPIED TO CLIPBOARD';
            setTimeout(() => $el.innerHTML = '<i class=\'fa-solid fa-copy\'></i> COPY FULL PROMPT FOR CHATGPT', 2000)
            " 
            class="w-full py-4 bg-hotpink hover:bg-pink-600 text-white font-bold rounded-lg transition-all shadow-glow-vip flex items-center justify-center gap-2 font-mono text-xs uppercase tracking-widest">
        <i class="fa-regular fa-copy"></i> COPY FULL PROMPT FOR CHATGPT
    </button>
    
    <p class="text-center text-[10px] text-slate-500 mt-3">
        Paste this into ChatGPT, Claude, or Gemini to get a personalized career strategy.
    </p>

</div>
        </div>

        <!-- SLIDERS (Bottom on Mobile) -->
        <div class="order-2 lg:order-1 lg:col-span-7 space-y-4 md:space-y-6">
            <template x-for="(skill, idx) in talentSkills" :key="idx">
                <div class="bg-card/50 p-4 rounded-xl border border-slate-700/50 active:border-hotpink/50 transition-colors relative overflow-hidden">
                    <div class="absolute right-0 top-0 bottom-0 bg-hotpink/5 transition-all duration-500 pointer-events-none" :style="`width: ${(skill.val / 5) * 100}%`"></div>
                    <div class="relative z-10">
                        <div class="flex justify-between items-center mb-4">
                            <label class="font-mono text-xs md:text-sm font-bold text-white uppercase tracking-wider flex items-center gap-2">
                                <i :class="skill.icon" class="text-slate-500 w-5 text-center"></i>
                                <span x-text="skill.label"></span>
                            </label>
                            <span class="font-mono font-bold text-lg" :class="skill.val >= 4 ? 'text-hotpink' : (skill.val <= 2 ? 'text-slate-500' : 'text-white')" x-text="skill.val + '/5'"></span>
                        </div>
                        <div class="relative h-8 mb-2 flex items-center">
                            <!-- UPDATED INPUT WITH PROPER EVENT HANDLERS -->
                            <input type="range" 
                                   min="1" 
                                   max="5" 
                                   step="1" 
                                   x-model.number="skill.val" 
                                   @change="updateTalentChart()"
                                   @input="updateTalentChart()"
                                   class="w-full h-2 bg-slate-800 rounded-lg appearance-none cursor-pointer z-20 relative">
                        </div>
                        <div class="min-h-[2.5em]">
                            <p class="text-xs text-slate-300 italic leading-relaxed">"<span x-text="talentManager.getBehavior(idx, skill.val)"></span>"</p>
                        </div>
                    </div>
                </div>
            </template>
        </div>
    </div>
</div>

<!-- LIGHTHOUSE TAB (REDESIGNED) -->
<div x-show="currentTab === 'lighthouse'" x-cloak class="max-w-6xl mx-auto pb-20">
    
    <!-- Header -->
    <div class="mb-8 flex flex-col md:flex-row md:items-end justify-between border-b border-slate-800 pb-6">
        <div>
            <h2 class="font-mono text-3xl font-bold text-warn flex items-center">
                <i class="fa-solid fa-lightbulb mr-3"></i>Lighthouse Kit
            </h2>
            <p class="text-textMuted text-sm mt-2 max-w-xl">
                The "Definition of Ready" for digital initiatives. If you cannot verify all 10 signals, you are building a legacy silo.
            </p>
        </div>
        <!-- Live Counter -->
        <div class="mt-4 md:mt-0 text-right">
            <span class="text-[10px] font-mono text-slate-500 uppercase tracking-widest block mb-1">READINESS INDEX</span>
            <div class="text-2xl font-bold font-mono" :class="lighthouseCount === 10 ? 'text-primary' : (lighthouseCount >= 8 ? 'text-warn' : 'text-risk')">
                <span x-text="lighthouseCount"></span>/10 CHECKS
            </div>
        </div>
    </div>

    <!-- Main Content Grid -->
    <div class="grid lg:grid-cols-12 gap-8 mb-8">
        
        <!-- Left Column: The Checklist (Launch Controls) -->
        <div class="lg:col-span-7 space-y-3">
            <template x-for="(item, index) in lighthouseData" :key="index">
                <label class="group relative flex items-center justify-between p-4 rounded-xl border transition-all cursor-pointer select-none"
                       :class="item.checked ? 'bg-slate-800/80 border-warn/50 shadow-[0_0_10px_rgba(251,191,36,0.1)]' : 'bg-card border-slate-700 hover:border-slate-500'">
                    
                    <div class="flex items-center gap-4">
                        <!-- Custom Checkbox UI -->
                        <div class="w-6 h-6 rounded border flex items-center justify-center transition-colors"
                             :class="item.checked ? 'bg-warn border-warn text-black' : 'bg-dark border-slate-600 text-transparent'">
                            <i class="fa-solid fa-check text-xs font-bold"></i>
                        </div>
                        
                        <div>
                            <span class="text-[10px] font-mono uppercase tracking-widest block mb-0.5" 
                                  :class="item.checked ? 'text-warn' : 'text-slate-500'" 
                                  x-text="item.category"></span>
                            <span class="text-sm font-bold transition-colors"
                                  :class="item.checked ? 'text-white' : 'text-slate-300'"
                                  x-text="item.text"></span>
                        </div>
                    </div>

                    <!-- Hidden Input -->
                    <input type="checkbox" x-model="item.checked" class="hidden">
                    
                    <!-- Glow Effect -->
                    <div class="absolute right-4 w-2 h-2 rounded-full transition-all duration-500"
                         :class="item.checked ? 'bg-warn shadow-[0_0_10px_#fbbf24]' : 'bg-slate-700'"></div>
                </label>
            </template>
        </div>

        <!-- Right Column: The Signal Tower (Visualizer) -->
        <div class="lg:col-span-5">
            <div class="sticky top-6">
                <!-- Status Card -->
                <div class="bg-slate-900 border-2 rounded-xl p-8 text-center shadow-2xl relative overflow-hidden transition-all duration-500"
                     :class="getLighthouseStatus().border">
                    
                    <!-- Background Glow -->
                    <div class="absolute inset-0 opacity-20 transition-colors duration-500" :class="getLighthouseStatus().bg"></div>

                    <!-- Big Icon -->
                    <div class="relative z-10 mb-6 transition-transform duration-500" :class="lighthouseCount === 10 ? 'scale-110' : ''">
                        <i class="fa-solid fa-tower-broadcast text-6xl transition-colors duration-300" :class="getLighthouseStatus().text"></i>
                    </div>

                    <!-- Status Text -->
                    <h3 class="relative z-10 font-mono text-3xl font-bold mb-2 transition-colors duration-300" 
                        :class="getLighthouseStatus().text" 
                        x-text="getLighthouseStatus().title"></h3>
                    
                    <p class="relative z-10 text-slate-300 text-sm italic" x-text="getLighthouseStatus().desc"></p>

                    <!-- Progress Bar -->
                    <div class="relative z-10 mt-8 w-full bg-slate-800 h-2 rounded-full overflow-hidden">
                        <div class="h-full transition-all duration-700 ease-out"
                             :class="getLighthouseStatus().text.replace('text-', 'bg-')"
                             :style="`width: ${(lighthouseCount / 10) * 100}%`"></div>
                    </div>
                </div>

                <!-- Helper Text -->
                <div class="mt-6 bg-card border border-slate-700 p-4 rounded-lg">
                    <h4 class="text-xs font-mono text-white font-bold mb-2"><i class="fa-solid fa-circle-info mr-2 text-slate-500"></i>RULES OF ENGAGEMENT</h4>
                    <ul class="text-xs text-slate-400 space-y-2 list-disc list-inside">
                        <li><span class="text-primary">10/10</span> = Approved for production funding.</li>
                        <li><span class="text-warn">8/10</span> = Approved for "Alpha" only. Waiver needed.</li>
                        <li><span class="text-risk">&lt; 8/10</span> = Back to the drawing board.</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- AI LAUNCH MEMO BOX -->
    <div class="mt-8 bg-slate-900 border border-warn/30 p-6 rounded-xl relative overflow-hidden group">
        
        <!-- Icon -->
        <div class="absolute top-0 right-0 p-4 opacity-10 pointer-events-none">
            <i class="fa-solid fa-rocket text-9xl text-warn"></i>
        </div>

        <!-- Header -->
        <div class="flex justify-between items-center mb-4 relative z-10">
            <h3 class="font-mono text-white font-bold flex items-center gap-2">
                <i class="fa-solid fa-robot text-warn"></i> 
                LAUNCH DECISION MEMO
            </h3>
            <span class="text-[10px] uppercase bg-yellow-900/50 text-warn px-2 py-1 rounded border border-warn/30 font-bold tracking-wider">
                <span x-text="getLighthouseStatus().title"></span> PHASE
            </span>
        </div>

        <!-- Preview -->
        <div class="relative z-10 font-mono text-xs text-slate-300 bg-black/60 p-4 rounded border border-slate-700 mb-4 h-28 overflow-hidden">
            <div class="absolute inset-0 bg-gradient-to-b from-transparent to-black/90 pointer-events-none"></div>
            <pre class="whitespace-pre-wrap font-sans leading-relaxed" x-text="generateLighthousePrompt()"></pre>
        </div>

        <!-- Interactive Copy Button -->
        <button @click="
                copyToClipboard(generateLighthousePrompt(), 'Launch Memo');
                $el.innerHTML = '<i class=\'fa-solid fa-check\'></i> MEMO GENERATED';
                $el.classList.remove('border-warn', 'text-warn', 'hover:bg-warn', 'hover:text-black');
                $el.classList.add('bg-green-500', 'text-white', 'border-green-500');
                setTimeout(() => {
                    $el.innerHTML = '<i class=\'fa-solid fa-wand-magic-sparkles\'></i> COPY MEMO FOR AI';
                    $el.classList.remove('bg-green-500', 'text-white', 'border-green-500');
                    $el.classList.add('border-warn', 'text-warn', 'hover:bg-warn', 'hover:text-black');
                }, 2000)
                " 
                class="relative z-10 w-full py-4 bg-transparent border border-warn text-warn hover:bg-warn hover:text-black font-bold rounded-lg transition-all duration-300 flex items-center justify-center gap-2 font-mono text-xs uppercase tracking-widest shadow-[0_0_10px_rgba(251,191,36,0.1)] hover:shadow-[0_0_20px_rgba(251,191,36,0.4)]">
            <i class="fa-solid fa-wand-magic-sparkles"></i> COPY MEMO FOR AI
        </button>
        
        <p class="text-center text-[10px] text-slate-500 mt-3 relative z-10">
            Generates a Go/No-Go decision document based on your missing criteria.
        </p>

    </div>

</div>
        
            <!-- BOARD -->
            <div x-show="currentTab === 'board'" x-cloak class="max-w-4xl mx-auto"><h2 class="font-mono text-2xl font-bold mb-6 text-risk flex items-center"><i class="fa-solid fa-chess-king mr-3"></i>The Board Director's Guide</h2><div class="space-y-6"><template x-for="risk in boardRisks" :key="risk.title"><div class="bg-card border border-slate-700 border-l-4 border-l-risk rounded-r-xl overflow-hidden"><div class="bg-risk/10 p-4 border-b border-slate-700"><h3 class="font-mono font-bold text-risk" x-text="risk.title"></h3><p class="text-white font-bold" x-text="risk.subtitle"></p></div><div class="p-6 grid md:grid-cols-2 gap-8"><div><div class="mb-4"><span class="text-[10px] font-mono text-risk bg-risk/10 px-2 py-1 rounded">THE LIE</span><p class="mt-2 text-slate-300 italic text-sm" x-text="risk.lie"></p></div><div><span class="text-[10px] font-mono text-primary bg-primary/10 px-2 py-1 rounded">THE TRUTH</span><p class="mt-2 text-white font-medium text-sm" x-text="risk.truth"></p></div></div><div class="bg-dark p-4 rounded border border-slate-700 flex flex-col justify-center"><span class="text-[10px] font-mono text-slate-500 mb-2 uppercase">The Question for the CEO</span><p class="font-mono text-sm text-primary leading-relaxed"><i class="fa-solid fa-quote-left text-slate-600 mr-2"></i><span x-text="risk.question"></span></p></div></div></div></template></div></div>

            <!-- REPAIR -->
            <div x-show="currentTab === 'repair'" x-cloak class="max-w-4xl mx-auto"><h2 class="font-mono text-2xl font-bold mb-6 text-risk flex items-center"><i class="fa-solid fa-toolbox mr-3"></i>Transformation Repair Kit</h2><div class="space-y-4"><template x-for="(item, index) in repairKitData" :key="index"><div class="bg-card border border-slate-700 rounded-xl overflow-hidden"><button @click="activeRepair = activeRepair === index ? null : index" class="w-full flex justify-between items-center p-5 text-left hover:bg-slate-800 transition-colors"><div><span class="font-mono text-[10px] text-risk mb-1 block">SYMPTOM</span><span class="font-bold text-lg text-slate-200" x-text="item.symptom"></span></div><i class="fa-solid fa-chevron-down text-slate-500 transition-transform duration-300" :class="activeRepair === index ? 'rotate-180' : ''"></i></button><div x-show="activeRepair === index" x-collapse><div class="p-5 border-t border-slate-700 bg-dark/30"><div class="mb-4"><h4 class="font-mono text-primary text-xs font-bold mb-2">// DIAGNOSIS</h4><p class="text-slate-300 text-sm" x-text="item.diagnosis"></p></div><div class="p-4 bg-slate-800/50 rounded border-l-2 border-primary"><h4 class="font-mono text-white text-xs font-bold mb-2">RX: PRESCRIPTION</h4><ul class="list-disc list-inside text-slate-400 text-sm space-y-1"><template x-for="step in item.prescription" :key="step"><li x-text="step"></li></template></ul></div></div></div></div></template></div></div>
            
            <!-- GLOSSARY -->
            <div x-show="currentTab === 'glossary'" x-cloak class="max-w-4xl mx-auto"><h2 class="font-mono text-2xl font-bold mb-6 text-purple-400 flex items-center"><i class="fa-solid fa-book-open mr-3"></i>The Glossary</h2><div class="mb-6"><input type="text" x-model="glossarySearch" placeholder="Filter terms..." class="w-full bg-card border border-slate-700 rounded-lg py-3 px-4 text-white focus:outline-none focus:border-purple-400 font-mono"></div><div class="grid grid-cols-1 md:grid-cols-2 gap-4 pb-20"><template x-for="term in filteredGlossary" :key="term.term"><div class="bg-card border border-slate-700 p-5 rounded-lg hover:border-purple-400/50 transition-colors"><h3 class="font-mono text-primary font-bold mb-2" x-text="term.term"></h3><p class="text-sm text-slate-300 leading-relaxed" x-text="term.def"></p></div></template></div></div>

            <!-- RESOURCES -->
            <div x-show="currentTab === 'resources'" x-cloak class="max-w-4xl mx-auto"><h2 class="font-mono text-2xl font-bold mb-6 text-green-300 flex items-center"><i class="fa-solid fa-book-bookmark mr-3"></i>Recommended Resources</h2><div class="bg-card border border-slate-700 rounded-xl p-6"><ul class="space-y-4"><li class="p-4 border-b border-slate-700 last:border-0"><h4 class="text-white font-bold">Project to Product (Mik Kersten)</h4><p class="text-sm text-textMuted">Definitive guide to the "Flow Framework".</p></li><li class="p-4 border-b border-slate-700 last:border-0"><h4 class="text-white font-bold">Team Topologies (Skelton & Pais)</h4><p class="text-sm text-textMuted">Blueprint for structuring squads.</p></li><li class="p-4 border-b border-slate-700 last:border-0"><h4 class="text-white font-bold">Sooner Safer Happier (Jonathan Smart)</h4><p class="text-sm text-textMuted">Agile for regulated banks.</p></li><li class="p-4 border-b border-slate-700 last:border-0"><h4 class="text-white font-bold">Data Mesh (Zhamak Dehghani)</h4><p class="text-sm text-textMuted">Data as a Product.</p></li></ul></div></div>

          <!-- KPI DESIGNER TAB -->
<div x-show="currentTab === 'kpi'" x-cloak class="max-w-3xl mx-auto">
    
    <div class="text-center mb-8">
        <h2 class="font-mono text-3xl font-bold text-white mb-2">Outcome Generator</h2>
        <p class="text-textMuted text-sm">Don't write the prompt. Let the machine build the prompt.</p>
    </div>

    <!-- MAIN CARD -->
    <div class="bg-card border border-slate-700 rounded-xl p-8 relative overflow-hidden shadow-2xl min-h-[450px] flex flex-col">
        
        <!-- Progress Bar (Visible only on Steps 1-4) -->
        <div x-show="kpiDesigner.step < 5" class="flex gap-2 mb-8">
            <template x-for="i in 4">
                <div class="h-1 flex-1 rounded-full transition-all duration-500" 
                     :class="kpiDesigner.step >= i ? 'bg-green-500' : 'bg-slate-700'"></div>
            </template>
        </div>

        <!-- STEP 1: THE PROJECT (Output) -->
        <div x-show="kpiDesigner.step === 1" x-transition:enter="transition ease-out duration-300 transform" x-transition:enter-start="opacity-0 translate-x-10" x-transition:enter-end="opacity-100 translate-x-0">
            <label class="block text-xs font-mono text-green-400 font-bold uppercase mb-2">Step 1/4: The Output</label>
            <h3 class="text-xl font-bold text-white mb-4">What are you being asked to build?</h3>
            <input type="text" x-model="kpiDesigner.form.project" @keydown.enter="kpiDesigner.next()"
                   placeholder="e.g. A new Mobile Banking App" 
                   class="w-full bg-dark border border-slate-600 rounded p-4 text-white focus:border-green-400 focus:outline-none mb-6">
            
            <div class="grid grid-cols-2 gap-3">
                <template x-for="preset in kpiDesigner.presets">
                    <button @click="kpiDesigner.quickFill(preset)" class="text-left text-xs p-3 rounded border border-slate-700 bg-slate-800/50 hover:border-green-500 hover:text-white text-slate-400 transition-all">
                        <span class="block font-bold text-white" x-text="preset.label"></span>
                        <span class="opacity-50 text-[10px]">Autofill Demo</span>
                    </button>
                </template>
            </div>
        </div>

        <!-- STEP 2: THE WHO (User) -->
        <div x-show="kpiDesigner.step === 2" x-transition:enter="transition ease-out duration-300 transform" x-transition:enter-start="opacity-0 translate-x-10" x-transition:enter-end="opacity-100 translate-x-0">
            <label class="block text-xs font-mono text-green-400 font-bold uppercase mb-2">Step 2/4: The Customer</label>
            <h3 class="text-xl font-bold text-white mb-4">Who is going to use this?</h3>
            <p class="text-xs text-slate-400 mb-4">Be specific. "Everyone" is the wrong answer.</p>
            <input type="text" x-model="kpiDesigner.form.who" @keydown.enter="kpiDesigner.next()"
                   placeholder="e.g. Small Business Owners needing cashflow" 
                   class="w-full bg-dark border border-slate-600 rounded p-4 text-white focus:border-green-400 focus:outline-none">
        </div>

        <!-- STEP 3: THE PAIN (Problem) -->
        <div x-show="kpiDesigner.step === 3" x-transition:enter="transition ease-out duration-300 transform" x-transition:enter-start="opacity-0 translate-x-10" x-transition:enter-end="opacity-100 translate-x-0">
            <label class="block text-xs font-mono text-green-400 font-bold uppercase mb-2">Step 3/4: The Friction</label>
            <h3 class="text-xl font-bold text-white mb-4">Why do they hate the current process?</h3>
            <textarea x-model="kpiDesigner.form.pain" 
                      placeholder="e.g. It takes 3 weeks to get approved and they have to fax documents." 
                      class="w-full h-32 bg-dark border border-slate-600 rounded p-4 text-white focus:border-green-400 focus:outline-none"></textarea>
        </div>

        <!-- STEP 4: THE VALUE (Goal) -->
        <div x-show="kpiDesigner.step === 4" x-transition:enter="transition ease-out duration-300 transform" x-transition:enter-start="opacity-0 translate-x-10" x-transition:enter-end="opacity-100 translate-x-0">
            <label class="block text-xs font-mono text-green-400 font-bold uppercase mb-2">Step 4/4: The Business Value</label>
            <h3 class="text-xl font-bold text-white mb-4">What does the Bank get out of this?</h3>
            <div class="grid grid-cols-2 gap-3 mb-4">
                <button @click="kpiDesigner.form.value = 'Reduce Cost to Serve'" :class="kpiDesigner.form.value === 'Reduce Cost to Serve' ? 'bg-green-600 text-white' : 'bg-slate-800 text-slate-400'" class="p-3 rounded border border-slate-600 text-xs font-bold transition-all">Reduce Cost</button>
                <button @click="kpiDesigner.form.value = 'Increase Revenue / Sales'" :class="kpiDesigner.form.value === 'Increase Revenue / Sales' ? 'bg-green-600 text-white' : 'bg-slate-800 text-slate-400'" class="p-3 rounded border border-slate-600 text-xs font-bold transition-all">Increase Revenue</button>
                <button @click="kpiDesigner.form.value = 'Reduce Compliance Risk'" :class="kpiDesigner.form.value === 'Reduce Compliance Risk' ? 'bg-green-600 text-white' : 'bg-slate-800 text-slate-400'" class="p-3 rounded border border-slate-600 text-xs font-bold transition-all">Reduce Risk</button>
                <button @click="kpiDesigner.form.value = 'Increase Velocity (Speed)'" :class="kpiDesigner.form.value === 'Increase Velocity (Speed)' ? 'bg-green-600 text-white' : 'bg-slate-800 text-slate-400'" class="p-3 rounded border border-slate-600 text-xs font-bold transition-all">Increase Speed</button>
            </div>
            <input type="text" x-model="kpiDesigner.form.value" placeholder="Or type custom value..." class="w-full bg-dark border border-slate-600 rounded p-3 text-white text-sm focus:border-green-400 focus:outline-none">
        </div>

        <!-- STEP 5: THE RESULT (The Prompt) -->
        <div x-show="kpiDesigner.step === 5" x-transition:enter="transition ease-out duration-500 transform" x-transition:enter-start="opacity-0 translate-y-4" x-transition:enter-end="opacity-100 translate-y-0" class="h-full flex flex-col">
            
            <div x-show="kpiDesigner.loading" class="flex-1 flex flex-col items-center justify-center text-green-400">
                <i class="fa-solid fa-circle-notch fa-spin text-4xl mb-4"></i>
                <p class="font-mono text-xs">ENGINEERING PROMPT...</p>
            </div>

            <div x-show="!kpiDesigner.loading" class="flex-1 flex flex-col">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="font-bold text-white text-lg"><i class="fa-solid fa-robot mr-2 text-green-400"></i>Prompt Generated</h3>
                    <button @click="kpiDesigner.reset()" class="text-xs text-slate-500 hover:text-white">Start Over</button>
                </div>

                <div class="bg-black p-4 rounded-lg border-l-4 border-green-500 flex-1 overflow-y-auto max-h-[300px] font-mono text-xs text-slate-300 whitespace-pre-wrap leading-relaxed shadow-inner" x-text="kpiDesigner.generatedPrompt"></div>

                <button @click="kpiDesigner.copyPrompt()" class="mt-6 w-full bg-green-600 hover:bg-green-500 text-white font-bold py-4 rounded-lg shadow-glow transition-all flex items-center justify-center gap-2 group">
                    <i class="fa-regular fa-copy group-hover:scale-110 transition-transform"></i> COPY TO CLIPBOARD
                </button>
                <p class="text-center text-[10px] text-slate-500 mt-2">Ready to paste into ChatGPT / Claude / Gemini.</p>
            </div>
        </div>

        <!-- NAV BUTTONS (Bottom) -->
        <div x-show="kpiDesigner.step < 5" class="mt-auto pt-8 flex justify-between border-t border-slate-700/50">
            <button @click="kpiDesigner.back()" x-show="kpiDesigner.step > 1" class="text-slate-400 hover:text-white text-sm font-mono flex items-center gap-2">
                <i class="fa-solid fa-arrow-left"></i> Back
            </button>
            <div x-show="kpiDesigner.step === 1"></div> <!-- Spacer -->
            
            <button @click="kpiDesigner.step === 4 ? kpiDesigner.generate() : kpiDesigner.next()" 
                    class="bg-white hover:bg-slate-200 text-dark font-bold px-6 py-2 rounded-lg text-sm transition-all flex items-center gap-2">
                <span x-text="kpiDesigner.step === 4 ? 'GENERATE PROMPT' : 'NEXT'"></span>
                <i class="fa-solid" :class="kpiDesigner.step === 4 ? 'fa-wand-magic-sparkles' : 'fa-arrow-right'"></i>
            </button>
        </div>

    </div>
</div>

        <!-- SQUAD BUILDER TAB (REDESIGNED) -->
<div x-show="currentTab === 'squad'" x-cloak class="max-w-6xl mx-auto pb-20">
    
    <div class="text-center mb-10">
        <h2 class="font-mono text-3xl font-bold text-indigo-400 mb-2">Bilingual Squad Designer</h2>
        <p class="text-textMuted text-sm">Optimize for Flow, not Headcount. Respect Brooks' Law.</p>
    </div>

    <div class="grid lg:grid-cols-12 gap-6 items-start">
        
        <!-- LEFT: THE BENCH (Select Roles) -->
        <div class="lg:col-span-3 bg-card border border-slate-700 p-4 rounded-xl h-fit">
            <h3 class="font-mono text-xs text-slate-400 uppercase mb-4 pl-2 tracking-widest">Available Talent</h3>
            <div class="space-y-2">
                <template x-for="role in squadBuilder.catalog" :key="role.id">
                    <button @click="squadBuilder.addRole(role)" 
                            class="w-full flex items-center p-3 rounded-lg border border-slate-600 bg-slate-800/50 hover:bg-slate-700 hover:border-indigo-400 transition-all text-left group relative overflow-hidden">
                        <!-- Icon -->
                        <div class="w-8 h-8 rounded bg-dark flex items-center justify-center text-slate-300 group-hover:text-white mr-3 shrink-0">
                            <i :class="'fa-solid ' + role.icon"></i>
                        </div>
                        <!-- Text -->
                        <div class="flex-1 min-w-0">
                            <div class="text-xs font-bold text-white truncate" x-text="role.title"></div>
                            <div class="flex gap-1 mt-1">
                                <!-- Mini Stat Bars -->
                                <div class="h-1 bg-blue-500 rounded" :style="`width: ${role.tech * 5}px`" title="Tech"></div>
                                <div class="h-1 bg-green-500 rounded" :style="`width: ${role.biz * 5}px`" title="Biz"></div>
                            </div>
                        </div>
                        <i class="fa-solid fa-plus text-slate-500 group-hover:text-indigo-400 ml-2"></i>
                    </button>
                </template>
            </div>
        </div>

        <!-- CENTER: THE FIELD (Active Roster) -->
        <div class="lg:col-span-5">
            <div class="bg-dark border-2 border-dashed border-slate-700 rounded-xl p-4 min-h-[500px] relative flex flex-col">
                
                <!-- Roster Header -->
                <div class="flex justify-between items-center mb-4 pb-2 border-b border-slate-700">
                    <h3 class="font-mono text-xs text-indigo-400 uppercase">Active Roster</h3>
                    <span class="text-xs font-mono" :class="squadBuilder.roster.length > 8 ? 'text-red-400' : 'text-slate-400'">
                        <span x-text="squadBuilder.roster.length"></span>/12 Members
                    </span>
                </div>

                <!-- Empty State -->
                <div x-show="squadBuilder.roster.length === 0" class="flex-1 flex flex-col items-center justify-center text-slate-600 pointer-events-none">
                    <div class="w-20 h-20 rounded-full border-2 border-dashed border-slate-700 flex items-center justify-center mb-4">
                        <i class="fa-solid fa-users text-2xl"></i>
                    </div>
                    <p class="text-xs font-mono">Squad is empty.</p>
                </div>

                <!-- The Grid of Heads -->
                <div class="grid grid-cols-2 gap-2 content-start">
                    <template x-for="member in squadBuilder.roster" :key="member.uid">
                        <div class="flex items-center p-2 rounded bg-slate-800 border border-slate-600 animate-[fadeIn_0.3s]">
                            <i :class="'fa-solid ' + member.icon + ' text-slate-400 mr-2 text-xs'"></i>
                            <span class="text-xs text-white font-bold truncate flex-1" x-text="member.title"></span>
                            <button @click="squadBuilder.removeRole(member.uid)" class="text-slate-600 hover:text-red-400 px-1">
                                <i class="fa-solid fa-xmark text-xs"></i>
                            </button>
                        </div>
                    </template>
                </div>

                <!-- Footer Actions -->
                <div class="mt-auto pt-4 flex justify-center">
                    <button x-show="squadBuilder.roster.length > 0" @click="squadBuilder.reset()" class="text-[10px] text-red-400 hover:text-red-300 underline">
                        CLEAR SQUAD
                    </button>
                </div>
            </div>
        </div>

        <!-- RIGHT: TELEMETRY (Math Output) -->
        <div class="lg:col-span-4 space-y-6">
            
            <!-- Main Status Card -->
            <div class="bg-card border border-slate-700 p-6 rounded-xl relative overflow-hidden">
                <p class="text-[10px] font-mono text-slate-500 uppercase tracking-widest mb-1">SYSTEM DIAGNOSIS</p>
                <h3 class="text-2xl font-bold font-mono uppercase mb-4" :class="squadBuilder.stats.statusColor" x-text="squadBuilder.stats.status"></h3>
                
                <!-- Velocity Meter -->
                <div class="mb-4">
                    <div class="flex justify-between text-xs text-slate-300 mb-1">
                        <span>Raw Velocity</span>
                        <span class="font-mono text-white" x-text="squadBuilder.stats.velocity"></span>
                    </div>
                    <div class="w-full bg-slate-800 h-2 rounded-full overflow-hidden">
                        <div class="bg-indigo-500 h-full transition-all duration-500" :style="`width: ${Math.min(100, squadBuilder.stats.velocity)}%`"></div>
                    </div>
                </div>

                <!-- Friction/Overhead Meter (The Inverse) -->
                <div class="mb-4">
                    <div class="flex justify-between text-xs text-slate-300 mb-1">
                        <span>Comm. Overhead (Brooks' Law)</span>
                        <span class="font-mono text-red-400" x-text="'-' + squadBuilder.stats.overhead"></span>
                    </div>
                    <div class="w-full bg-slate-800 h-2 rounded-full overflow-hidden">
                        <div class="bg-red-500/80 h-full transition-all duration-500" :style="`width: ${Math.min(100, squadBuilder.stats.overhead * 2)}%`"></div>
                    </div>
                </div>

                <!-- Alignment Meter -->
                <div>
                    <div class="flex justify-between text-xs text-slate-300 mb-1">
                        <span>Biz/Tech Alignment</span>
                        <span class="font-mono text-white" x-text="squadBuilder.stats.alignment + '%'"></span>
                    </div>
                    <div class="w-full bg-slate-800 h-2 rounded-full overflow-hidden">
                        <div class="h-full transition-all duration-500" 
                             :class="squadBuilder.stats.alignment > 60 ? 'bg-green-500' : 'bg-yellow-500'" 
                             :style="`width: ${squadBuilder.stats.alignment}%`"></div>
                    </div>
                </div>
            </div>

            <!-- AI Prompt Box -->
            <div x-show="squadBuilder.roster.length > 0" x-transition class="bg-slate-900 border border-indigo-500/30 p-5 rounded-xl group relative overflow-hidden">
                <div class="absolute top-0 right-0 p-3 opacity-10 pointer-events-none"><i class="fa-solid fa-robot text-6xl text-indigo-500"></i></div>
                
                <h4 class="font-mono text-xs text-indigo-400 font-bold uppercase mb-2">Simulation Engine</h4>
                <p class="text-[10px] text-slate-400 mb-4">Run a "Pre-Mortem" on this specific team composition to see how it fails.</p>
                
                <button @click="
                        copyToClipboard(squadBuilder.generateSquadPrompt(), 'Simulation Config');
                        $el.innerHTML = '<i class=\'fa-solid fa-check\'></i> COPIED';
                        $el.classList.add('bg-green-500', 'text-white', 'border-green-500');
                        setTimeout(() => {
                            $el.innerHTML = '<i class=\'fa-solid fa-wand-magic-sparkles\'></i> COPY SIMULATION PROMPT';
                            $el.classList.remove('bg-green-500', 'text-white', 'border-green-500');
                        }, 2000)
                        " 
                        class="w-full py-3 bg-transparent border border-indigo-500 text-indigo-400 hover:bg-indigo-500 hover:text-white font-bold rounded-lg transition-all flex items-center justify-center gap-2 font-mono text-[10px] uppercase tracking-widest shadow-[0_0_10px_rgba(99,102,241,0.1)] hover:shadow-[0_0_15px_rgba(99,102,241,0.4)]">
                    <i class="fa-solid fa-wand-magic-sparkles"></i> COPY SIMULATION PROMPT
                </button>
            </div>

        </div>
    </div>
</div>

        <!-- EXCEL CALCULATOR TAB (REDESIGNED) -->
<div x-show="currentTab === 'excel'" x-cloak class="max-w-6xl mx-auto pb-20">
    
    <div class="text-center mb-10">
        <h2 class="font-mono text-3xl font-bold text-green-400 mb-2">The "Excel Factory" Auditor</h2>
        <p class="text-textMuted text-sm">Turn hidden manual work into a quantitative business case for automation.</p>
    </div>

    <div class="grid lg:grid-cols-12 gap-8 items-start">
        
        <!-- LEFT: INPUTS -->
        <div class="lg:col-span-5 bg-card border border-slate-700 p-6 rounded-xl space-y-6">
            <h3 class="font-mono text-xs text-slate-400 uppercase border-b border-slate-700 pb-2 tracking-widest">Process Parameters</h3>
            
            <!-- Name -->
            <div>
                <label class="block text-xs font-bold text-white mb-1">Process Name</label>
                <input type="text" x-model="excelCalc.inputs.process_name" placeholder="e.g. Monthly Reg Report" class="w-full bg-dark border border-slate-600 rounded p-2 text-white focus:border-green-500 focus:outline-none">
            </div>

            <!-- Steps Slider -->
            <div>
                <div class="flex justify-between mb-2">
                    <label class="text-xs font-bold text-white">Manual Actions (Copy/Pastes)</label>
                    <span class="font-mono text-xs text-green-400" x-text="excelCalc.inputs.steps"></span>
                </div>
                <input type="range" min="5" max="200" step="5" x-model="excelCalc.inputs.steps" class="w-full h-2 bg-slate-800 rounded-lg appearance-none cursor-pointer accent-green-500">
                <p class="text-[10px] text-slate-500 mt-1">Every touchpoint increases error probability.</p>
            </div>

            <!-- Frequency -->
            <div>
                <label class="block text-xs font-bold text-white mb-2">Frequency</label>
                <select x-model="excelCalc.inputs.frequency" class="w-full bg-dark border border-slate-600 rounded p-2 text-sm text-white focus:border-green-500">
                    <option value="1">Annual (1x)</option>
                    <option value="4">Quarterly (4x)</option>
                    <option value="12">Monthly (12x)</option>
                    <option value="52">Weekly (52x)</option>
                    <option value="250">Daily (250x)</option>
                </select>
            </div>

            <!-- Criticality Buttons -->
            <div>
                <label class="block text-xs font-bold text-white mb-2">Risk Impact</label>
                <div class="grid grid-cols-3 gap-2">
                    <button @click="excelCalc.inputs.criticality = 1" :class="excelCalc.inputs.criticality === 1 ? 'bg-slate-600 text-white' : 'bg-slate-800 text-slate-400'" class="p-2 rounded text-[10px] font-bold border border-slate-600 hover:border-white transition-all">
                        Internal
                    </button>
                    <button @click="excelCalc.inputs.criticality = 2" :class="excelCalc.inputs.criticality === 2 ? 'bg-yellow-600 text-white' : 'bg-slate-800 text-slate-400'" class="p-2 rounded text-[10px] font-bold border border-slate-600 hover:border-yellow-500 transition-all">
                        Regulatory
                    </button>
                    <button @click="excelCalc.inputs.criticality = 3" :class="excelCalc.inputs.criticality === 3 ? 'bg-red-600 text-white' : 'bg-slate-800 text-slate-400'" class="p-2 rounded text-[10px] font-bold border border-slate-600 hover:border-red-500 transition-all">
                        Customer
                    </button>
                </div>
            </div>

            <button @click="excelCalc.calculate()" class="w-full bg-green-600 hover:bg-green-500 text-white font-bold py-3 rounded-lg shadow-glow transition-all">
                CALCULATE EXPOSURE
            </button>
        </div>

        <!-- RIGHT: RESULTS -->
        <div class="lg:col-span-7">
            
            <!-- Empty State -->
            <div x-show="!excelCalc.result" class="h-64 border-2 border-dashed border-slate-700 rounded-xl flex flex-col items-center justify-center text-slate-500">
                <i class="fa-solid fa-calculator text-4xl mb-3 opacity-20"></i>
                <p class="text-xs font-mono">Awaiting inputs...</p>
            </div>

            <!-- Result Card -->
            <div x-show="excelCalc.result" x-transition class="space-y-6">
                
                <!-- Main Metrics -->
                <div class="grid grid-cols-2 gap-4">
                    <div class="bg-card border border-slate-700 p-4 rounded-xl text-center">
                        <p class="text-[10px] text-slate-500 uppercase tracking-widest">ANNUAL WASTE (OPEX)</p>
                        <h3 class="text-3xl font-bold font-mono text-white my-1" x-text="'$' + excelCalc.result?.annualCost.toLocaleString()"></h3>
                        <p class="text-[10px] text-slate-400"><span x-text="excelCalc.result?.annualHours"></span> wasted hours</p>
                    </div>
                    <div class="bg-card border border-slate-700 p-4 rounded-xl text-center relative overflow-hidden">
                        <div class="absolute inset-0 bg-red-500/5" x-show="excelCalc.result?.errorProb > 50"></div>
                        <p class="text-[10px] text-slate-500 uppercase tracking-widest">ERROR PROBABILITY</p>
                        <h3 class="text-3xl font-bold font-mono my-1" :class="excelCalc.result?.errorProb > 50 ? 'text-red-500' : 'text-yellow-500'">
                            <span x-text="excelCalc.result?.errorProb"></span>%
                        </h3>
                        <p class="text-[10px] text-slate-400">Swiss Cheese Model</p>
                    </div>
                </div>

                <!-- Liability Warning -->
                <div class="bg-slate-900 border-l-4 p-5 rounded-r-xl flex items-center justify-between"
                     :class="excelCalc.result?.riskExposure > 100000 ? 'border-red-500' : 'border-yellow-500'">
                    <div>
                        <p class="text-[10px] font-bold uppercase mb-1" :class="excelCalc.result?.riskExposure > 100000 ? 'text-red-500' : 'text-yellow-500'">TOTAL RISK LIABILITY</p>
                        <h2 class="text-2xl font-mono font-bold text-white" x-text="'$' + excelCalc.result?.riskExposure.toLocaleString()"></h2>
                    </div>
                    <div class="text-right">
                        <span class="block text-xs font-bold text-white bg-slate-800 px-3 py-1 rounded border border-slate-600">
                            <span x-text="excelCalc.result?.verdict"></span>
                        </span>
                    </div>
                </div>

                <!-- AI Business Case Box -->
                <div class="bg-slate-900 border border-green-500/30 p-5 rounded-xl group relative overflow-hidden">
                    <div class="absolute top-0 right-0 p-3 opacity-10 pointer-events-none"><i class="fa-solid fa-file-invoice-dollar text-6xl text-green-500"></i></div>
                    
                    <h4 class="font-mono text-xs text-green-400 font-bold uppercase mb-2">Automated Business Case</h4>
                    <p class="text-[10px] text-slate-400 mb-4">Use this prompt to generate the funding request for IT.</p>
                    
                    <button @click="
                            copyToClipboard(excelCalc.generateExcelPrompt(), 'Business Case');
                            $el.innerHTML = '<i class=\'fa-solid fa-check\'></i> COPIED';
                            $el.classList.add('bg-white', 'text-black', 'border-white');
                            setTimeout(() => {
                                $el.innerHTML = '<i class=\'fa-solid fa-wand-magic-sparkles\'></i> COPY PROMPT FOR AI';
                                $el.classList.remove('bg-white', 'text-black', 'border-white');
                            }, 2000)
                            " 
                            class="w-full py-3 bg-transparent border border-green-500 text-green-400 hover:bg-green-500 hover:text-black font-bold rounded-lg transition-all flex items-center justify-center gap-2 font-mono text-[10px] uppercase tracking-widest shadow-[0_0_10px_rgba(74,222,128,0.1)] hover:shadow-[0_0_15px_rgba(74,222,128,0.4)]">
                        <i class="fa-solid fa-wand-magic-sparkles"></i> COPY PROMPT FOR AI
                    </button>
                </div>

            </div>
        </div>
    </div>
</div>

        <!-- LIGHTHOUSE ROI TAB (REDESIGNED) -->
<div x-show="currentTab === 'roi'" x-cloak class="max-w-6xl mx-auto pb-20">
    
    <div class="text-center mb-10">
        <h2 class="font-mono text-3xl font-bold text-green-400 mb-2">Lighthouse Value Engine</h2>
        <p class="text-textMuted text-sm">Translate "Agile Velocity" into "Balance Sheet Impact". Speak the CFO's language.</p>
    </div>

    <div class="grid lg:grid-cols-12 gap-8 items-start">
        
        <!-- LEFT: THE INPUTS -->
        <div class="lg:col-span-5 bg-card border border-slate-700 p-6 rounded-xl space-y-6">
            <div class="flex justify-between items-center border-b border-slate-700 pb-2">
                <h3 class="font-mono text-xs text-slate-400 uppercase tracking-widest">Pilot Parameters</h3>
                <i class="fa-solid fa-sliders text-slate-500"></i>
            </div>
            
            <div>
                <label class="block text-xs font-bold text-white mb-1">Project Name</label>
                <input type="text" x-model="lighthouseROI.inputs.name" placeholder="e.g. Instant SME Loan" class="w-full bg-dark border border-slate-600 rounded p-2 text-white focus:border-green-500 focus:outline-none">
            </div>

            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="block text-[10px] text-slate-400 mb-1 uppercase">Duration (Weeks)</label>
                    <input type="number" x-model="lighthouseROI.inputs.duration_weeks" class="w-full bg-dark border border-slate-600 rounded p-2 text-white">
                </div>
                <div>
                    <label class="block text-[10px] text-slate-400 mb-1 uppercase">Squad Cost ($/Wk)</label>
                    <input type="number" x-model="lighthouseROI.inputs.squad_cost_per_week" class="w-full bg-dark border border-slate-600 rounded p-2 text-white">
                </div>
            </div>

            <div class="bg-green-900/10 border border-green-500/30 p-4 rounded-lg space-y-4">
                <p class="text-[10px] text-green-400 font-bold uppercase mb-2">Value Capture (Annual)</p>
                <div>
                    <label class="block text-[10px] text-slate-400 mb-1">New Revenue Generated ($)</label>
                    <input type="number" x-model="lighthouseROI.inputs.revenue_generated" class="w-full bg-dark border border-green-500/50 rounded p-2 text-white">
                </div>
                <div>
                    <label class="block text-[10px] text-slate-400 mb-1">Cost Avoided / Saved ($)</label>
                    <input type="number" x-model="lighthouseROI.inputs.cost_avoided" class="w-full bg-dark border border-green-500/50 rounded p-2 text-white">
                </div>
            </div>

            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="block text-[10px] text-slate-400 mb-1 uppercase">Old Speed (Weeks)</label>
                    <input type="number" x-model="lighthouseROI.inputs.old_cycle_time" class="w-full bg-dark border border-slate-600 rounded p-2 text-white">
                </div>
                <div>
                    <label class="block text-[10px] text-slate-400 mb-1 uppercase">New Speed (Weeks)</label>
                    <input type="number" x-model="lighthouseROI.inputs.new_cycle_time" class="w-full bg-dark border border-slate-600 rounded p-2 text-white">
                </div>
            </div>

            <button @click="lighthouseROI.calculate()" class="w-full bg-white hover:bg-slate-200 text-dark font-bold py-3 rounded-lg shadow-glow transition-all flex items-center justify-center gap-2">
                <i class="fa-solid fa-calculator text-green-600"></i> CALCULATE ROI
            </button>
        </div>

        <!-- RIGHT: THE DASHBOARD -->
        <div class="lg:col-span-7">
            
            <!-- Empty State -->
            <div x-show="!lighthouseROI.results" class="h-64 border-2 border-dashed border-slate-700 rounded-xl flex flex-col items-center justify-center text-slate-500">
                <i class="fa-solid fa-chart-pie text-4xl mb-3 opacity-20"></i>
                <p class="text-xs font-mono">Input data to generate business case.</p>
            </div>

            <!-- Results -->
            <div x-show="lighthouseROI.results" x-transition class="space-y-6">
                
                <!-- 1. The Verdict Header -->
                <div class="flex justify-between items-center bg-slate-900 border-l-4 p-4 rounded-r-xl shadow-lg"
                     :class="lighthouseROI.results?.roiPercent > 0 ? 'border-green-500' : 'border-red-500'">
                    <div>
                        <p class="text-[10px] font-mono text-slate-400 uppercase tracking-widest">INVESTMENT VERDICT</p>
                        <h3 class="text-2xl font-bold text-white font-mono" :class="lighthouseROI.results?.color" x-text="lighthouseROI.results?.verdict"></h3>
                    </div>
                    <div class="text-right">
                        <p class="text-[10px] font-mono text-slate-400 uppercase tracking-widest">1-YEAR ROI</p>
                        <h3 class="text-4xl font-bold text-white" x-text="lighthouseROI.results?.roiPercent + '%'"></h3>
                    </div>
                </div>

                <!-- 2. The Metrics Grid -->
                <div class="grid grid-cols-2 gap-4">
                    <div class="bg-card border border-slate-700 p-4 rounded-xl">
                        <div class="flex justify-between items-start mb-2">
                            <span class="text-[10px] text-slate-500 uppercase">Payback Period</span>
                            <i class="fa-solid fa-hourglass-half text-slate-600"></i>
                        </div>
                        <p class="text-xl font-bold text-white"><span x-text="lighthouseROI.results?.paybackMonths"></span> Months</p>
                        <p class="text-[10px] text-slate-400 mt-1">Time to break even</p>
                    </div>
                    <div class="bg-card border border-slate-700 p-4 rounded-xl">
                        <div class="flex justify-between items-start mb-2">
                            <span class="text-[10px] text-slate-500 uppercase">Velocity Gain</span>
                            <i class="fa-solid fa-gauge-high text-purple-400"></i>
                        </div>
                        <p class="text-xl font-bold text-white"><span x-text="lighthouseROI.results?.speedFactor"></span>x Faster</p>
                        <p class="text-[10px] text-slate-400 mt-1">Time-to-Market multiplier</p>
                    </div>
                </div>

                <!-- 3. The Cost of Delay (Scary Metric) -->
                <div class="bg-red-900/10 border border-red-500/30 p-5 rounded-xl flex items-center gap-4">
                    <div class="w-10 h-10 rounded-full bg-red-500/20 flex items-center justify-center text-red-500">
                        <i class="fa-solid fa-stopwatch text-xl"></i>
                    </div>
                    <div>
                        <p class="text-[10px] font-bold text-red-400 uppercase tracking-widest">COST OF DELAY (COD)</p>
                        <p class="text-sm text-slate-300">
                            Every week of indecision costs the bank <strong class="text-white" x-text="'$' + lighthouseROI.results?.weeklyValue.toLocaleString()"></strong> in lost value.
                        </p>
                    </div>
                </div>

                <!-- 4. AI CFO Script -->
                <div class="bg-slate-900 border border-green-500/30 p-5 rounded-xl group relative overflow-hidden">
                    <div class="absolute top-0 right-0 p-3 opacity-10 pointer-events-none"><i class="fa-solid fa-file-contract text-6xl text-green-500"></i></div>
                    
                    <h4 class="font-mono text-xs text-green-400 font-bold uppercase mb-2 flex items-center gap-2">
                        <i class="fa-solid fa-robot"></i> CFO Defense Script
                    </h4>
                    
                    <!-- Prompt Preview -->
                    <div class="relative z-10 font-mono text-xs text-slate-300 bg-black/60 p-3 rounded border border-slate-700 mb-4 h-24 overflow-hidden">
                        <div class="absolute inset-0 bg-gradient-to-b from-transparent to-black/90 pointer-events-none"></div>
                        <pre class="whitespace-pre-wrap font-sans leading-relaxed" x-text="lighthouseROI.generateROIPrompt()"></pre>
                    </div>
                    
                    <button @click="
                            copyToClipboard(lighthouseROI.generateROIPrompt(), 'CFO Script');
                            $el.innerHTML = '<i class=\'fa-solid fa-check\'></i> COPIED';
                            $el.classList.add('bg-white', 'text-black', 'border-white');
                            setTimeout(() => {
                                $el.innerHTML = '<i class=\'fa-solid fa-wand-magic-sparkles\'></i> COPY SCRIPT FOR AI';
                                $el.classList.remove('bg-white', 'text-black', 'border-white');
                            }, 2000)
                            " 
                            class="w-full py-3 bg-transparent border border-green-500 text-green-400 hover:bg-green-500 hover:text-black font-bold rounded-lg transition-all flex items-center justify-center gap-2 font-mono text-[10px] uppercase tracking-widest shadow-[0_0_10px_rgba(74,222,128,0.1)] hover:shadow-[0_0_15px_rgba(74,222,128,0.4)]">
                        <i class="fa-solid fa-wand-magic-sparkles"></i> COPY SCRIPT FOR AI
                    </button>
                </div>

            </div>

        </div>
    </div>
</div>

        <!-- FUTURE BANK SCENARIO BUILDER TAB -->
<div x-show="currentTab === 'future'" x-cloak class="max-w-6xl mx-auto pb-20">
    
    <div class="text-center mb-10">
        <h2 class="font-mono text-3xl font-bold text-white mb-2">The Future Bank Simulator</h2>
        <p class="text-textMuted text-sm">Decisions have compounding interest. Choose a strategy and navigate the crises of 2026-2030.</p>
    </div>

    <!-- 1. SCENARIO SELECTOR -->
    <div x-show="!futureBank.activeScenario" class="grid md:grid-cols-3 gap-6">
        <template x-for="scenario in futureBank.scenarios" :key="scenario.id">
            <button @click="futureBank.selectScenario(scenario.id)" 
                    class="bg-card border border-slate-700 hover:border-purple-500 p-8 rounded-xl text-center group transition-all hover:-translate-y-2 relative overflow-hidden shadow-lg">
                <div class="w-16 h-16 rounded-full bg-slate-800 flex items-center justify-center mx-auto mb-6 group-hover:bg-slate-700 transition-colors relative z-10">
                    <i :class="'fa-solid ' + scenario.icon + ' text-3xl ' + scenario.color"></i>
                </div>
                <h3 class="font-bold text-white text-xl mb-2 relative z-10" x-text="scenario.title"></h3>
                <p class="text-sm text-slate-400 leading-relaxed relative z-10" x-text="scenario.desc"></p>
                <div class="mt-6 text-xs font-mono text-purple-400 opacity-0 group-hover:opacity-100 transition-opacity relative z-10">
                    INITIALIZE SIMULATION <i class="fa-solid fa-arrow-right ml-1"></i>
                </div>
                <div class="absolute inset-0 bg-gradient-to-b from-transparent to-purple-900/10 opacity-0 group-hover:opacity-100 transition-opacity"></div>
            </button>
        </template>
    </div>

    <!-- 2. ACTIVE SIMULATION -->
    <div x-show="futureBank.activeScenario" x-transition class="relative min-h-[500px]">
        
        <!-- Timeline Header -->
        <div class="flex justify-between items-center mb-8 border-b border-slate-700 pb-4">
            <button @click="futureBank.activeScenario = null" :disabled="futureBank.isPlaying" class="text-xs text-slate-400 hover:text-white disabled:opacity-30 flex items-center">
                <i class="fa-solid fa-arrow-left mr-2"></i> ABORT
            </button>
            <div class="text-center">
                <p class="text-[10px] text-slate-500 uppercase tracking-widest mb-1">FISCAL YEAR</p>
                <h2 class="text-6xl font-mono font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-500" 
                    x-text="futureBank.year"></h2>
            </div>
            <div class="w-24 text-right">
                <span class="text-xs font-bold px-2 py-1 rounded bg-slate-800 text-slate-300 border border-slate-600">
                    <i class="fa-solid fa-play mr-1 text-green-400" x-show="futureBank.isPlaying && !futureBank.activeEvent"></i>
                    <i class="fa-solid fa-pause mr-1 text-yellow-400" x-show="futureBank.activeEvent"></i>
                    <span x-text="futureBank.activeEvent ? 'ACTION' : (futureBank.isPlaying ? 'RUNNING' : 'COMPLETE')"></span>
                </span>
            </div>
        </div>

        <!-- LIVE TELEMETRY GRID -->
        <div class="grid md:grid-cols-4 gap-6 mb-8">
            <div class="bg-card border border-slate-700 p-6 rounded-xl relative overflow-hidden">
                <p class="text-[10px] text-slate-500 uppercase tracking-widest mb-2">NET PROFIT</p>
                <h3 class="text-2xl font-mono font-bold text-green-400 mb-2">
                    $<span x-text="(futureBank.metrics.profit / 1000).toFixed(1)"></span>B
                </h3>
                <div class="w-full bg-slate-800 h-1 rounded-full mt-4">
                    <div class="bg-green-500 h-1 rounded-full transition-all duration-500" :style="`width: ${(futureBank.metrics.profit / 5000) * 100}%`"></div>
                </div>
            </div>
            <div class="bg-card border border-slate-700 p-6 rounded-xl relative overflow-hidden">
                <p class="text-[10px] text-slate-500 uppercase tracking-widest mb-2">CUSTOMER BASE</p>
                <h3 class="text-2xl font-bold text-white mb-2">
                    <span x-text="futureBank.metrics.customers.toFixed(1)"></span>M
                </h3>
                <div class="w-full bg-slate-800 h-1 rounded-full mt-4">
                    <div class="bg-blue-500 h-1 rounded-full transition-all duration-500" :style="`width: ${(futureBank.metrics.customers / 20) * 100}%`"></div>
                </div>
            </div>
            <div class="bg-card border border-slate-700 p-6 rounded-xl relative overflow-hidden">
                <p class="text-[10px] text-slate-500 uppercase tracking-widest mb-2">EFFICIENCY RATIO</p>
                <h3 class="text-2xl font-mono font-bold mb-2" :class="futureBank.metrics.efficiency < 50 ? 'text-primary' : 'text-orange-400'">
                    <span x-text="futureBank.metrics.efficiency.toFixed(0)"></span>%
                </h3>
                <p class="text-[9px] text-slate-500">Lower is better</p>
            </div>
            <div class="bg-card border border-slate-700 p-6 rounded-xl relative overflow-hidden">
                <p class="text-[10px] text-slate-500 uppercase tracking-widest mb-2">TECH DEBT</p>
                <h3 class="text-2xl font-mono font-bold mb-2" :class="futureBank.metrics.techDebt > 50 ? 'text-red-500' : 'text-slate-300'">
                    <span x-text="futureBank.metrics.techDebt"></span>/100
                </h3>
                <div class="w-full bg-slate-800 h-1 rounded-full mt-4">
                    <div class="h-1 rounded-full transition-all duration-500" 
                         :class="futureBank.metrics.techDebt > 50 ? 'bg-red-500' : 'bg-slate-500'"
                         :style="`width: ${futureBank.metrics.techDebt}%`"></div>
                </div>
            </div>
        </div>

        <!-- *** THE INTERACTIVE EVENT OVERLAY *** -->
        <div x-show="futureBank.activeEvent" 
             x-transition:enter="transition ease-out duration-300"
             x-transition:enter-start="opacity-0 scale-90"
             x-transition:enter-end="opacity-100 scale-100"
             class="absolute inset-0 z-50 flex items-center justify-center p-4">
            
            <!-- Backdrop -->
            <div class="absolute inset-0 bg-black/90 backdrop-blur-sm rounded-xl"></div>
            
            <!-- Card -->
            <div class="bg-slate-900 border-2 border-red-500 rounded-2xl p-8 max-w-lg w-full relative z-10 shadow-[0_0_50px_rgba(239,68,68,0.3)]">
                <div class="flex items-center gap-3 mb-4 text-red-500 animate-pulse">
                    <i class="fa-solid fa-triangle-exclamation text-2xl"></i>
                    <h3 class="font-mono text-xl font-bold uppercase">Breaking News</h3>
                </div>
                
                <h4 class="text-2xl font-bold text-white mb-2" x-text="futureBank.activeEvent?.title"></h4>
                <p class="text-slate-300 mb-8 leading-relaxed" x-text="futureBank.activeEvent?.desc"></p>
                
                <div class="space-y-3">
                    <template x-for="choice in futureBank.activeEvent?.choices">
                        <button @click="futureBank.resolveEvent(choice)" 
                                class="w-full text-left p-4 rounded-lg bg-slate-800 border border-slate-600 hover:border-white hover:bg-slate-700 transition-all group">
                            <div class="flex justify-between items-center">
                                <span class="font-bold text-sm text-white" x-text="choice.label"></span>
                                <i class="fa-solid fa-arrow-right text-slate-500 group-hover:text-white"></i>
                            </div>
                            <div class="text-[10px] text-slate-400 mt-1 flex gap-3">
                                <span x-show="choice.cost > 0">Cost: $<span x-text="choice.cost"></span>M</span>
                                <span x-show="choice.debt < 0" class="text-green-400">Debt Down</span>
                                <span x-show="choice.debt > 0" class="text-red-400">Debt Up</span>
                            </div>
                        </button>
                    </template>
                </div>
            </div>
        </div>

        <!-- 3. AI PROMPT BOX (End State) -->
        <div x-show="!futureBank.isPlaying && futureBank.year === 2030" 
             x-transition:enter="transition ease-out duration-1000 delay-200" 
             class="bg-slate-900 border border-purple-500/30 p-6 rounded-xl relative overflow-hidden group mt-4">
            
            <div class="flex justify-between items-center mb-4 relative z-10">
                <h3 class="font-mono text-white font-bold flex items-center gap-2">
                    <i class="fa-solid fa-robot text-purple-400"></i> 
                    WALL STREET ANALYST REPORT
                </h3>
                <span class="text-[10px] uppercase bg-purple-900/50 text-purple-400 px-2 py-1 rounded border border-purple-500/30 font-bold tracking-wider">
                    Simulation Complete
                </span>
            </div>

            <div class="relative z-10 font-mono text-xs text-slate-300 bg-black/60 p-4 rounded border border-slate-700 mb-4 h-32 overflow-hidden">
                <div class="absolute inset-0 bg-gradient-to-b from-transparent to-black/90 pointer-events-none"></div>
                <pre class="whitespace-pre-wrap font-sans leading-relaxed" x-text="futureBank.generateFuturePrompt()"></pre>
            </div>

            <button @click="
                    copyToClipboard(futureBank.generateFuturePrompt(), 'Simulation Data');
                    $el.innerHTML = '<i class=\'fa-solid fa-check\'></i> COPIED';
                    $el.classList.add('bg-green-500', 'text-white', 'border-green-500');
                    setTimeout(() => {
                        $el.innerHTML = '<i class=\'fa-solid fa-wand-magic-sparkles\'></i> GENERATE REPORT (AI)';
                        $el.classList.remove('bg-green-500', 'text-white', 'border-green-500');
                    }, 2000)
                    " 
                    class="relative z-10 w-full py-4 bg-transparent border border-purple-500 text-purple-400 hover:bg-purple-400 hover:text-black font-bold rounded-lg transition-all duration-300 flex items-center justify-center gap-2 font-mono text-xs uppercase tracking-widest shadow-[0_0_10px_rgba(168,85,247,0.1)] hover:shadow-[0_0_20px_rgba(168,85,247,0.4)]">
                <i class="fa-solid fa-wand-magic-sparkles"></i> GENERATE REPORT (AI)
            </button>
            
            <p class="text-center text-[10px] text-slate-500 mt-3 relative z-10">
                Includes your specific crisis decisions (2027/2029) in the prompt.
            </p>
        </div>

    </div>
</div>
        <!-- CONWAY'S LAW VISUALIZER TAB -->
<div x-show="currentTab === 'conway'" x-cloak class="max-w-6xl mx-auto pb-20">
    
    <div class="text-center mb-10">
        <h2 class="font-mono text-3xl font-bold text-white mb-2">Conway's Law Simulator</h2>
        <p class="text-textMuted text-sm">"You don't have a code problem. You have an org chart problem."</p>
    </div>

    <!-- 1. BUILDER UI -->
    <div class="grid lg:grid-cols-12 gap-8 items-start">
        
        <!-- LEFT: Org Chart Builder -->
        <div class="lg:col-span-4 bg-card border border-slate-700 p-6 rounded-xl">
            <h3 class="font-mono text-xs text-indigo-400 uppercase mb-4 font-bold">1. Define the Org</h3>
            
            <div class="space-y-4">
                <div>
                    <label class="text-[10px] text-slate-500 uppercase">Team Name</label>
                    <input type="text" x-model="conwaySim.newTeamName" @keydown.enter="conwaySim.addTeam()" class="w-full bg-dark border border-slate-600 rounded p-2 text-white text-sm focus:border-indigo-500 focus:outline-none">
                </div>
                <div>
                    <label class="text-[10px] text-slate-500 uppercase">Team Archetype</label>
                    <div class="grid grid-cols-2 gap-2 mt-1">
                        <button @click="conwaySim.newTeamType = 'silo'" :class="conwaySim.newTeamType === 'silo' ? 'bg-orange-500/20 border-orange-500 text-orange-400' : 'bg-slate-800 border-slate-600 text-slate-400'" class="p-2 rounded border text-xs font-bold transition-all">
                            <i class="fa-solid fa-building-columns mr-1"></i> Silo
                        </button>
                        <button @click="conwaySim.newTeamType = 'squad'" :class="conwaySim.newTeamType === 'squad' ? 'bg-green-500/20 border-green-500 text-green-400' : 'bg-slate-800 border-slate-600 text-slate-400'" class="p-2 rounded border text-xs font-bold transition-all">
                            <i class="fa-solid fa-rocket mr-1"></i> Squad
                        </button>
                        <button @click="conwaySim.newTeamType = 'platform'" :class="conwaySim.newTeamType === 'platform' ? 'bg-blue-500/20 border-blue-500 text-blue-400' : 'bg-slate-800 border-slate-600 text-slate-400'" class="p-2 rounded border text-xs font-bold transition-all">
                            <i class="fa-solid fa-layer-group mr-1"></i> Platform
                        </button>
                        <button @click="conwaySim.newTeamType = 'gatekeeper'" :class="conwaySim.newTeamType === 'gatekeeper' ? 'bg-red-500/20 border-red-500 text-red-400' : 'bg-slate-800 border-slate-600 text-slate-400'" class="p-2 rounded border text-xs font-bold transition-all">
                            <i class="fa-solid fa-hand-paper mr-1"></i> Gatekeeper
                        </button>
                    </div>
                </div>
                <button @click="conwaySim.addTeam()" class="w-full bg-white hover:bg-gray-200 text-dark font-bold py-2 rounded-lg text-xs transition-all">
                    + ADD TEAM
                </button>
            </div>

            <!-- Help Text -->
            <div class="mt-6 p-4 bg-slate-800/50 rounded-lg border border-slate-700">
                <p class="text-[10px] text-slate-400 leading-relaxed">
                    <strong class="text-white">How it works:</strong> Add teams. Then, on the right panel, click any two teams to create a <span class="text-red-400">Dependency Line</span>. The simulator calculates the resulting architectural mess.
                </p>
            </div>
        </div>

        <!-- RIGHT: Interactive Graph -->
        <div class="lg:col-span-8 space-y-6">
            
            <!-- Matrix Visualizer -->
            <div class="bg-dark border-2 border-dashed border-slate-700 rounded-xl p-6 relative min-h-[400px]">
                
                <p class="text-[10px] text-slate-500 uppercase tracking-widest absolute top-4 left-4">DEPENDENCY MATRIX (CLICK TO CONNECT)</p>
                
                <div x-show="conwaySim.teams.length === 0" class="flex h-full items-center justify-center text-slate-600">
                    <div class="text-center">
                        <i class="fa-solid fa-sitemap text-4xl mb-2 opacity-30"></i>
                        <p class="text-xs">Add teams to visualize architecture.</p>
                    </div>
                </div>

                <div class="grid grid-cols-2 md:grid-cols-3 gap-6 mt-8">
                    <template x-for="team in conwaySim.teams" :key="team.id">
                        <div class="relative bg-slate-800 p-4 rounded-lg border transition-all group"
                             :class="{
                                'border-orange-500': team.type === 'silo',
                                'border-green-500': team.type === 'squad',
                                'border-blue-500': team.type === 'platform',
                                'border-red-500': team.type === 'gatekeeper'
                             }">
                            
                            <!-- Delete Button -->
                            <button @click.stop="conwaySim.removeTeam(team.id)" class="absolute -top-2 -right-2 w-6 h-6 bg-red-600 text-white rounded-full text-xs opacity-0 group-hover:opacity-100 transition-opacity z-20">
                                <i class="fa-solid fa-xmark"></i>
                            </button>

                            <div class="flex items-center gap-2 mb-2">
                                <i class="fa-solid" :class="{
                                    'fa-building-columns text-orange-400': team.type === 'silo',
                                    'fa-rocket text-green-400': team.type === 'squad',
                                    'fa-layer-group text-blue-400': team.type === 'platform',
                                    'fa-hand-paper text-red-400': team.type === 'gatekeeper'
                                }"></i>
                                <span class="font-bold text-white text-sm truncate" x-text="team.name"></span>
                            </div>

                            <!-- Connection Grid -->
                            <div class="mt-3 pt-3 border-t border-slate-700/50">
                                <p class="text-[9px] text-slate-500 mb-2 uppercase">Depends on:</p>
                                <div class="flex flex-wrap gap-2">
                                    <template x-for="target in conwaySim.teams" :key="target.id">
                                        <button x-show="team.id !== target.id" 
                                                @click="conwaySim.toggleDependency(team.id, target.id)"
                                                class="text-[9px] px-2 py-1 rounded border transition-all"
                                                :class="conwaySim.hasDependency(team.id, target.id) 
                                                    ? 'bg-red-500/20 border-red-500 text-red-300' 
                                                    : 'bg-slate-900 border-slate-700 text-slate-500 hover:border-slate-500'">
                                            <span x-text="target.name"></span>
                                        </button>
                                    </template>
                                </div>
                            </div>
                        </div>
                    </template>
                </div>
            </div>

            <!-- Calculated Results -->
            <div class="grid grid-cols-3 gap-4" x-show="conwaySim.teams.length > 0">
                <div class="bg-card border border-slate-700 p-4 rounded-xl text-center">
                    <p class="text-[10px] text-slate-500 uppercase tracking-widest">COUPLING SCORE</p>
                    <h3 class="text-2xl font-mono font-bold my-1" :class="conwaySim.metrics.couplingScore > 50 ? 'text-red-500' : 'text-green-400'">
                        <span x-text="conwaySim.metrics.couplingScore"></span>/100
                    </h3>
                    <p class="text-[9px] text-slate-400">Integration Pain</p>
                </div>
                <div class="bg-card border border-slate-700 p-4 rounded-xl text-center">
                    <p class="text-[10px] text-slate-500 uppercase tracking-widest">VELOCITY</p>
                    <h3 class="text-2xl font-mono font-bold my-1 text-blue-400">
                        <span x-text="conwaySim.metrics.velocity.toFixed(0)"></span>
                    </h3>
                    <p class="text-[9px] text-slate-400">Deployment Speed</p>
                </div>
                <div class="bg-card border border-slate-700 p-4 rounded-xl text-center">
                    <p class="text-[10px] text-slate-500 uppercase tracking-widest">RESULTING SYSTEM</p>
                    <h3 class="text-sm font-bold text-white my-2" x-text="conwaySim.metrics.archType"></h3>
                </div>
            </div>

        </div>
    </div>

    <!-- 2. AI DIAGNOSIS BOX -->
    <div x-show="conwaySim.teams.length > 0" 
         class="mt-8 bg-slate-900 border border-indigo-500/30 p-6 rounded-xl relative overflow-hidden group">
        
        <div class="flex justify-between items-center mb-4 relative z-10">
            <h3 class="font-mono text-white font-bold flex items-center gap-2">
                <i class="fa-solid fa-robot text-indigo-400"></i> 
                ARCHITECTURAL DIAGNOSIS AI
            </h3>
            <span class="text-[10px] uppercase bg-indigo-900/50 text-indigo-400 px-2 py-1 rounded border border-indigo-500/30 font-bold tracking-wider">
                Topology Mapped
            </span>
        </div>

        <div class="relative z-10 font-mono text-xs text-slate-300 bg-black/60 p-4 rounded border border-slate-700 mb-4 h-32 overflow-hidden">
            <div class="absolute inset-0 bg-gradient-to-b from-transparent to-black/90 pointer-events-none"></div>
            <pre class="whitespace-pre-wrap font-sans leading-relaxed" x-text="conwaySim.generateConwayPrompt()"></pre>
        </div>

        <button @click="
                copyToClipboard(conwaySim.generateConwayPrompt(), 'Topology Data');
                $el.innerHTML = '<i class=\'fa-solid fa-check\'></i> COPIED';
                $el.classList.add('bg-green-500', 'text-white', 'border-green-500');
                setTimeout(() => {
                    $el.innerHTML = '<i class=\'fa-solid fa-wand-magic-sparkles\'></i> GENERATE RE-ORG PLAN (AI)';
                    $el.classList.remove('bg-green-500', 'text-white', 'border-green-500');
                }, 2000)
                " 
                class="relative z-10 w-full py-4 bg-transparent border border-indigo-500 text-indigo-400 hover:bg-indigo-400 hover:text-black font-bold rounded-lg transition-all duration-300 flex items-center justify-center gap-2 font-mono text-xs uppercase tracking-widest shadow-[0_0_10px_rgba(129,140,248,0.1)] hover:shadow-[0_0_20px_rgba(129,140,248,0.4)]">
            <i class="fa-solid fa-wand-magic-sparkles"></i> GENERATE RE-ORG PLAN (AI)
        </button>
        
        <p class="text-center text-[10px] text-slate-500 mt-3 relative z-10">
            Paste into AI to get the "Inverse Conway Maneuver" strategy.
        </p>
    </div>

</div>

        <!-- DUMB PIPE RISK CALCULATOR TAB -->
<div x-show="currentTab === 'dumbpipe'" x-cloak class="max-w-6xl mx-auto pb-20">
    
    <div class="text-center mb-10">
        <h2 class="font-mono text-3xl font-bold text-white mb-2">Dumb Pipe Risk Calculator</h2>
        <p class="text-textMuted text-sm">"If you lose the interface, you lose the margin." Are you becoming a utility?</p>
    </div>

    <div class="grid lg:grid-cols-12 gap-8 items-start">
        
        <!-- LEFT: INPUTS -->
        <div class="lg:col-span-5 bg-card border border-slate-700 p-6 rounded-xl space-y-8">
            
            <!-- Revenue Mix -->
            <div>
                <div class="flex justify-between mb-2">
                    <label class="text-xs font-mono text-slate-400 uppercase font-bold"><i class="fa-solid fa-money-bill-transfer mr-2"></i>Commodity Revenue</label>
                    <span class="text-xs font-bold text-white" x-text="dumbPipeCalc.inputs.commodity_share + '%'"></span>
                </div>
                <input type="range" min="0" max="100" x-model="dumbPipeCalc.inputs.commodity_share" @input="dumbPipeCalc.result = null" class="w-full h-2 bg-slate-800 rounded-lg appearance-none cursor-pointer accent-red-500">
                <p class="text-[10px] text-slate-500 mt-2">Revenue from Interchange, FX, or Overdrafts (Low Loyalty).</p>
            </div>

            <!-- Aggregator Traffic -->
            <div>
                <div class="flex justify-between mb-2">
                    <label class="text-xs font-mono text-slate-400 uppercase font-bold"><i class="fa-solid fa-server mr-2"></i>3rd Party Traffic</label>
                    <span class="text-xs font-bold text-white" x-text="dumbPipeCalc.inputs.aggregator_share + '%'"></span>
                </div>
                <input type="range" min="0" max="100" x-model="dumbPipeCalc.inputs.aggregator_share" @input="dumbPipeCalc.result = null" class="w-full h-2 bg-slate-800 rounded-lg appearance-none cursor-pointer accent-yellow-500">
                <p class="text-[10px] text-slate-500 mt-2">Customers accessing you via Apple Wallet, Mint, or Plaid.</p>
            </div>

            <!-- Engagement -->
            <div>
                <div class="flex justify-between mb-2">
                    <label class="text-xs font-mono text-slate-400 uppercase font-bold"><i class="fa-solid fa-mobile-screen mr-2"></i>Daily Logins (DAU)</label>
                    <span class="text-xs font-bold text-white" x-text="dumbPipeCalc.inputs.daily_logins + '%'"></span>
                </div>
                <input type="range" min="0" max="100" x-model="dumbPipeCalc.inputs.daily_logins" @input="dumbPipeCalc.result = null" class="w-full h-2 bg-slate-800 rounded-lg appearance-none cursor-pointer accent-blue-500">
                <p class="text-[10px] text-slate-500 mt-2">Percentage of customer base checking the app daily.</p>
            </div>

            <!-- NPS -->
            <div>
                <div class="flex justify-between mb-2">
                    <label class="text-xs font-mono text-slate-400 uppercase font-bold"><i class="fa-solid fa-heart mr-2"></i>Net Promoter Score</label>
                    <span class="text-xs font-bold text-white" x-text="dumbPipeCalc.inputs.nps"></span>
                </div>
                <input type="range" min="-100" max="100" x-model="dumbPipeCalc.inputs.nps" @input="dumbPipeCalc.result = null" class="w-full h-2 bg-slate-800 rounded-lg appearance-none cursor-pointer accent-green-500">
            </div>

            <button @click="dumbPipeCalc.analyze()" 
                    class="w-full py-4 bg-red-600 hover:bg-red-500 text-white font-bold rounded-lg shadow-glow transition-all flex items-center justify-center gap-2">
                <i class="fa-solid fa-calculator"></i> CALCULATE RISK
            </button>
        </div>

        <!-- RIGHT: RESULTS & STRATEGY -->
        <div class="lg:col-span-7 relative min-h-[400px]">
            
            <!-- Empty State -->
            <div x-show="!dumbPipeCalc.result" class="absolute inset-0 flex flex-col items-center justify-center border-2 border-dashed border-slate-700 rounded-xl text-slate-500">
                <i class="fa-solid fa-faucet-drip text-4xl mb-4 opacity-20"></i>
                <p class="font-mono text-xs uppercase">Adjust Inputs to Audit</p>
            </div>

            <!-- Result Card -->
            <div x-show="dumbPipeCalc.result" x-transition class="bg-card border border-slate-700 rounded-xl overflow-hidden shadow-2xl relative group">
                
                <!-- The Gauge Header -->
                <div class="p-8 text-center bg-gradient-to-b from-slate-800 to-slate-900 border-b border-slate-700 relative overflow-hidden">
                    <!-- Background Glow -->
                    <div class="absolute inset-0 opacity-10 transition-colors duration-500" :class="'bg-' + dumbPipeCalc.result?.color.replace('text-', '')"></div>
                    
                    <p class="text-[10px] font-mono text-slate-400 uppercase tracking-widest mb-4">COMMODITIZATION INDEX</p>
                    
                    <div class="relative w-48 h-24 mx-auto overflow-hidden">
                        <!-- Gauge Arc (CSS Trick) -->
                        <div class="w-48 h-48 rounded-full border-[12px] border-slate-700 border-t-transparent border-l-transparent -rotate-45 absolute top-0 left-0"></div>
                        <div class="w-48 h-48 rounded-full border-[12px] border-transparent border-t-current border-l-current -rotate-45 absolute top-0 left-0 transition-all duration-1000"
                             :class="dumbPipeCalc.result?.color"
                             :style="`transform: rotate(${(dumbPipeCalc.result?.score / 100 * 180) - 135}deg)`"></div>
                    </div>
                    <div class="relative -mt-10">
                        <span class="text-5xl font-bold font-mono text-white" x-text="dumbPipeCalc.result?.score"></span>
                    </div>
                    
                    <h3 class="text-2xl font-bold mt-4 uppercase tracking-tight" :class="dumbPipeCalc.result?.color" x-text="dumbPipeCalc.result?.verdict"></h3>
                    <p class="text-xs text-slate-400 mt-2 font-mono">Archetype: <span class="text-white font-bold" x-text="dumbPipeCalc.result?.archetype"></span></p>
                </div>

                <!-- AI Prompt Box -->
                <div class="p-6 bg-slate-900">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="font-mono text-white font-bold flex items-center gap-2 text-xs uppercase">
                            <i class="fa-solid fa-robot text-red-400"></i> Strategic Defense AI
                        </h3>
                        <span class="text-[9px] bg-red-900/50 text-red-400 px-2 py-1 rounded border border-red-500/30 font-bold uppercase tracking-wider">
                            Gap Identified
                        </span>
                    </div>

                    <div class="relative font-mono text-xs text-slate-300 bg-black/60 p-4 rounded border border-slate-700 mb-4 h-24 overflow-hidden">
                        <div class="absolute inset-0 bg-gradient-to-b from-transparent to-black/90 pointer-events-none"></div>
                        <pre class="whitespace-pre-wrap font-sans leading-relaxed" x-text="dumbPipeCalc.generateStrategyPrompt()"></pre>
                    </div>

                    <button @click="
                            copyToClipboard(dumbPipeCalc.generateStrategyPrompt(), 'Strategy Memo');
                            $el.innerHTML = '<i class=\'fa-solid fa-check\'></i> COPIED';
                            $el.classList.add('bg-green-500', 'text-white', 'border-green-500');
                            setTimeout(() => {
                                $el.innerHTML = '<i class=\'fa-solid fa-wand-magic-sparkles\'></i> GENERATE DEFENSE STRATEGY (AI)';
                                $el.classList.remove('bg-green-500', 'text-white', 'border-green-500');
                            }, 2000)
                            " 
                            class="w-full py-4 bg-transparent border border-red-500 text-red-400 hover:bg-red-500 hover:text-white font-bold rounded-lg transition-all duration-300 flex items-center justify-center gap-2 font-mono text-xs uppercase tracking-widest shadow-[0_0_10px_rgba(239,68,68,0.1)] hover:shadow-[0_0_20px_rgba(239,68,68,0.4)]">
                        <i class="fa-solid fa-wand-magic-sparkles"></i> GENERATE DEFENSE STRATEGY (AI)
                    </button>
                    
                    <p class="text-center text-[10px] text-slate-500 mt-3">
                        Paste into AI to get a roadmap for escaping the "Utility Trap".
                    </p>
                </div>

            </div>
        </div>

    </div>
</div>

        <!-- AGILE DATA GOVERNANCE DASHBOARD TAB -->
<div x-show="currentTab === 'datagov'" x-cloak class="max-w-6xl mx-auto pb-20">
    
    <!-- Header: Optimized for Mobile Stacking -->
    <div class="flex flex-col md:flex-row justify-between items-start md:items-end mb-6 md:mb-8 gap-4">
        <div>
            <h2 class="font-mono text-2xl md:text-3xl font-bold text-white mb-2">Agile Data Governance</h2>
            <p class="text-textMuted text-sm">Don't fix data downstream (Janitor). Fix it at the source (Guardrails).</p>
        </div>
        
        <!-- Controls: Full width on mobile -->
        <div class="flex gap-2 w-full md:w-auto">
             <button @click="dataGovDash.injectFailure('schema')" class="flex-1 md:flex-none justify-center px-4 py-3 md:py-2 border border-red-500/50 text-red-400 hover:bg-red-900/20 rounded-full text-xs font-bold transition-all shadow-[0_0_15px_rgba(239,68,68,0.2)]">
                <i class="fa-solid fa-bug mr-2"></i> <span class="md:inline">INJECT BREAK</span>
            </button>
            <button @click="dataGovDash.toggleSim()" 
                    class="flex-1 md:flex-none justify-center font-bold py-3 md:py-2 px-6 rounded-full shadow-glow transition-all flex items-center gap-2 text-xs"
                    :class="dataGovDash.isLive ? 'bg-blue-500/20 text-blue-400 border border-blue-500' : 'bg-slate-700 text-white'">
                <i class="fa-solid" :class="dataGovDash.isLive ? 'fa-spin fa-circle-notch' : 'fa-play'"></i>
                <span x-text="dataGovDash.isLive ? 'LIVE' : 'MONITOR'"></span>
            </button>
        </div>
    </div>

    <!-- Main Grid: 1 Col Mobile, 3 Cols Desktop -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 items-start">
        
        <!-- LEFT: DATA PRODUCTS GRID -->
        <div class="lg:col-span-2 space-y-4">
            <template x-for="product in dataGovDash.products" :key="product.id">
                <div @click="dataGovDash.selectedProduct = product; $nextTick(() => { if(window.innerWidth < 1024) $refs.govPanel.scrollIntoView({behavior: 'smooth', block: 'center'}) })"
                     class="bg-card border p-4 md:p-6 rounded-xl cursor-pointer transition-all hover:translate-x-1 relative overflow-hidden group active:scale-95 duration-200"
                     :class="product.status === 'critical' ? 'border-red-500 shadow-[0_0_15px_rgba(239,68,68,0.3)]' : (dataGovDash.selectedProduct?.id === product.id ? 'border-blue-500' : 'border-slate-700')">
                    
                    <!-- Critical Alert Overlay -->
                    <div x-show="product.status === 'critical'" class="absolute inset-0 bg-red-900/10 z-0 animate-pulse"></div>

                    <div class="relative z-10">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <div class="flex items-center gap-2 mb-1">
                                    <span class="w-2 h-2 rounded-full shrink-0" :class="product.status === 'critical' ? 'bg-red-500 shadow-[0_0_10px_red]' : 'bg-green-400'"></span>
                                    <h3 class="font-bold text-white text-base md:text-lg leading-tight" x-text="product.name"></h3>
                                </div>
                                <p class="text-xs text-slate-400 font-mono">Owner: <span class="text-white" x-text="product.owner"></span></p>
                            </div>
                            <div class="text-right shrink-0 ml-2">
                                <span class="text-[9px] md:text-[10px] uppercase tracking-widest text-slate-500 block">Service Level</span>
                                <div class="text-xl md:text-2xl font-mono font-bold" :class="product.status === 'critical' ? 'text-red-500' : 'text-green-400'">
                                    <span x-text="Math.min(product.slo.freshness, product.slo.accuracy).toFixed(1)"></span>%
                                </div>
                            </div>
                        </div>

                        <!-- SLO Metrics -->
                        <div class="grid grid-cols-2 gap-2 md:gap-4 text-center">
                            <div class="bg-slate-900 rounded p-2 border border-slate-800">
                                <p class="text-[9px] text-slate-400 uppercase">Freshness</p>
                                <div class="w-full bg-slate-800 h-1.5 rounded-full mt-1 mb-1 overflow-hidden">
                                    <div class="h-full transition-all duration-300" :class="product.slo.freshness < 99 ? 'bg-red-500' : 'bg-blue-400'" :style="`width: ${product.slo.freshness}%`"></div>
                                </div>
                                <p class="font-mono font-bold text-xs" :class="product.slo.freshness < 99 ? 'text-red-400' : 'text-white'" x-text="product.slo.freshness.toFixed(1) + '%'"></p>
                            </div>
                            <div class="bg-slate-900 rounded p-2 border border-slate-800">
                                <p class="text-[9px] text-slate-400 uppercase">Quality</p>
                                <div class="w-full bg-slate-800 h-1.5 rounded-full mt-1 mb-1 overflow-hidden">
                                    <div class="h-full transition-all duration-300" :class="product.slo.accuracy < 99 ? 'bg-red-500' : 'bg-blue-400'" :style="`width: ${product.slo.accuracy}%`"></div>
                                </div>
                                <p class="font-mono font-bold text-xs" :class="product.slo.accuracy < 99 ? 'text-red-400' : 'text-white'" x-text="product.slo.accuracy.toFixed(1) + '%'"></p>
                            </div>
                        </div>
                    </div>
                </div>
            </template>
        </div>

        <!-- RIGHT: INCIDENT COMMAND & PROMPT GEN -->
        <!-- Added x-ref="govPanel" for auto-scrolling -->
        <div x-ref="govPanel" class="bg-dark border border-slate-700 rounded-xl p-4 md:p-6 flex flex-col h-full min-h-[300px] md:min-h-[500px] shadow-2xl">
            <h3 class="font-mono text-xs text-blue-400 uppercase mb-4 tracking-widest border-b border-slate-800 pb-2">Incident Command Center</h3>
            
            <!-- Empty State -->
            <div x-show="!dataGovDash.selectedProduct" class="text-center text-slate-600 mt-10 md:mt-20">
                <i class="fa-solid fa-tower-observation text-4xl mb-4 opacity-20"></i>
                <p class="text-xs font-mono">Select a Data Product above<br>to open monitor.</p>
            </div>

            <!-- Active Product Details -->
            <div x-show="dataGovDash.selectedProduct" class="flex-1 flex flex-col">
                <div class="mb-6 pb-4 border-b border-slate-800">
                     <span class="text-lg font-bold text-white block mb-1" x-text="dataGovDash.selectedProduct?.name"></span>
                     <div class="flex flex-wrap items-center gap-2">
                         <span class="text-[10px] px-2 py-0.5 rounded border font-bold" 
                               :class="dataGovDash.selectedProduct?.status === 'critical' ? 'bg-red-900/30 border-red-500 text-red-400' : 'bg-green-900/30 border-green-500 text-green-400'"
                               x-text="dataGovDash.selectedProduct?.status === 'critical' ? 'CRITICAL INCIDENT' : 'OPERATIONAL'"></span>
                         <span class="text-[10px] text-slate-500 font-mono" x-text="'$' + dataGovDash.selectedProduct?.costPerMinute + '/min impact'"></span>
                     </div>
                </div>

                <!-- INCIDENT ALERT (Only shows if broken) -->
                <div x-show="dataGovDash.selectedProduct?.status === 'critical'" x-transition class="space-y-4">
                    
                    <div class="bg-red-900/10 border border-red-500 p-4 rounded-lg animate-pulse">
                        <div class="flex items-center gap-2 mb-2 text-red-400 text-xs font-bold uppercase">
                            <i class="fa-solid fa-triangle-exclamation"></i> Business Impact
                        </div>
                        <p class="text-2xl text-white font-mono font-bold mb-1" x-text="'$' + Math.round(dataGovDash.activeIncident?.totalCost).toLocaleString()"></p>
                        <p class="text-[10px] text-red-300">Estimated Value Lost (Cumulative)</p>
                        <p class="text-xs text-white mt-3 font-mono bg-black/50 p-2 rounded border border-red-500/30 break-all">
                            > <span x-text="dataGovDash.activeIncident?.errorMsg"></span>
                        </p>
                    </div>

                    <button @click="dataGovDash.repair()" class="w-full bg-green-600 hover:bg-green-500 text-white font-bold py-4 rounded-lg shadow-glow transition-all flex items-center justify-center gap-2">
                        <i class="fa-solid fa-wrench"></i> DEPLOY HOTFIX
                    </button>

                    <!-- AI RCA Prompt Box -->
                    <div class="mt-6 bg-slate-800 p-4 rounded-lg border border-slate-600">
                        <div class="flex justify-between items-center mb-2">
                            <h4 class="text-[10px] font-bold text-slate-400 uppercase">Post-Mortem Generator</h4>
                            <span class="text-[9px] text-blue-400 bg-blue-900/20 px-1 rounded border border-blue-500/20">AI READY</span>
                        </div>
                        <div class="bg-black/50 p-2 rounded text-[10px] text-slate-400 font-mono mb-3 h-20 overflow-hidden relative">
                            <div class="absolute inset-0 bg-gradient-to-b from-transparent to-black/80 pointer-events-none"></div>
                            <span x-text="dataGovDash.generateRCAPrompt()"></span>
                        </div>
                        <button @click="
                                copyToClipboard(dataGovDash.generateRCAPrompt(), 'RCA Prompt');
                                $el.innerHTML = '<i class=\'fa-solid fa-check\'></i> COPIED';
                                setTimeout(() => { $el.innerHTML = '<i class=\'fa-solid fa-wand-magic-sparkles\'></i> COPY RCA PROMPT'; }, 2000)
                                " 
                                class="w-full border border-blue-500 text-blue-400 hover:bg-blue-500 hover:text-white py-3 rounded-lg text-xs font-bold transition-all uppercase tracking-widest">
                            <i class="fa-solid fa-wand-magic-sparkles"></i> COPY RCA PROMPT
                        </button>
                    </div>

                </div>

                <!-- Healthy State Message -->
                <div x-show="dataGovDash.selectedProduct?.status !== 'critical'" class="text-center py-10 opacity-50">
                    <i class="fa-solid fa-shield-heart text-5xl text-green-500 mb-4"></i>
                    <p class="text-xs text-slate-400">System Healthy.<br>Inject a failure to test response.</p>
                </div>

            </div>
        </div>

    </div>
</div>

        <!-- SHADOW IT AUDIT TAB -->
<div x-show="currentTab === 'shadow'" x-cloak class="max-w-6xl mx-auto pb-20">
    
    <div class="text-center mb-10">
        <h2 class="font-mono text-3xl font-bold text-white mb-2">Shadow IT Scanner</h2>
        <p class="text-textMuted text-sm">Don't just ban it. Audit the "Hidden Tax" of manual integration.</p>
    </div>

    <div class="grid lg:grid-cols-12 gap-8 items-start">
        
        <!-- LEFT: INPUT SCANNER -->
        <div class="lg:col-span-4 bg-card border border-slate-700 p-6 rounded-xl h-fit">
            <h3 class="font-mono text-xs text-purple-400 uppercase mb-4 font-bold border-b border-slate-700 pb-2">Add New Tool</h3>
            
            <div class="space-y-4">
                <div>
                    <label class="text-[10px] text-slate-500 uppercase">Tool Name</label>
                    <input type="text" x-model="shadowAudit.form.name" @keydown.enter="shadowAudit.addTool()" placeholder="e.g. Monday.com, Trello" class="w-full bg-dark border border-slate-600 rounded p-2 text-white text-sm focus:border-purple-500 focus:outline-none">
                </div>

                <div class="grid grid-cols-2 gap-2">
                    <div>
                        <label class="text-[10px] text-slate-500 uppercase">User Count</label>
                        <input type="number" x-model="shadowAudit.form.users" class="w-full bg-dark border border-slate-600 rounded p-2 text-white text-sm">
                    </div>
                    <div>
                        <label class="text-[10px] text-slate-500 uppercase">Cost/User ($)</label>
                        <input type="number" x-model="shadowAudit.form.costPerUser" class="w-full bg-dark border border-slate-600 rounded p-2 text-white text-sm">
                    </div>
                </div>

                <div>
                    <label class="text-[10px] text-slate-500 uppercase">Data Sensitivity</label>
                    <select x-model="shadowAudit.form.dataLevel" class="w-full bg-dark border border-slate-600 rounded p-2 text-white text-sm">
                        <option value="public">Public (Non-Sensitive)</option>
                        <option value="internal">Internal (Business Ops)</option>
                        <option value="confidential">Confidential (Strategy)</option>
                        <option value="restricted">Restricted (PII / Financials)</option>
                    </select>
                </div>

                <div>
                    <label class="text-[10px] text-slate-500 uppercase">Integration Status</label>
                    <div class="grid grid-cols-2 gap-2 mt-1">
                        <button @click="shadowAudit.form.integration = 'silo'" :class="shadowAudit.form.integration === 'silo' ? 'bg-red-500/20 border-red-500 text-red-400' : 'bg-slate-800 border-slate-600 text-slate-400'" class="p-2 rounded border text-xs font-bold transition-all">
                            <i class="fa-solid fa-file-csv mr-1"></i> Silo (CSV)
                        </button>
                        <button @click="shadowAudit.form.integration = 'api'" :class="shadowAudit.form.integration === 'api' ? 'bg-green-500/20 border-green-500 text-green-400' : 'bg-slate-800 border-slate-600 text-slate-400'" class="p-2 rounded border text-xs font-bold transition-all">
                            <i class="fa-solid fa-plug mr-1"></i> API (Auto)
                        </button>
                    </div>
                </div>

                <button @click="shadowAudit.addTool()" class="w-full bg-purple-600 hover:bg-purple-500 text-white font-bold py-2 rounded-lg shadow-glow transition-all mt-2">
                    SCAN & ADD
                </button>
            </div>
        </div>

        <!-- RIGHT: INVENTORY DASHBOARD -->
        <div class="lg:col-span-8 space-y-6">
            
            <!-- Summary Stats -->
            <div class="grid grid-cols-3 gap-4">
                <div class="bg-card border border-slate-700 p-4 rounded-xl relative overflow-hidden">
                    <p class="text-[10px] text-slate-500 uppercase tracking-widest mb-1">TOTAL LIABILITY</p>
                    <h3 class="text-2xl font-mono font-bold text-white">
                        $<span x-text="Math.round(shadowAudit.summary.totalCost).toLocaleString()"></span>
                    </h3>
                    <div class="absolute right-0 bottom-0 p-3 opacity-10"><i class="fa-solid fa-money-bill-wave text-4xl"></i></div>
                </div>
                <div class="bg-card border border-slate-700 p-4 rounded-xl relative overflow-hidden">
                    <p class="text-[10px] text-slate-500 uppercase tracking-widest mb-1">SHADOW TAX</p>
                    <h3 class="text-2xl font-mono font-bold text-red-400">
                        $<span x-text="Math.round(shadowAudit.summary.hiddenTax).toLocaleString()"></span>
                    </h3>
                    <p class="text-[9px] text-slate-400">Manual Work Cost</p>
                </div>
                <div class="bg-card border border-slate-700 p-4 rounded-xl relative overflow-hidden">
                    <p class="text-[10px] text-slate-500 uppercase tracking-widest mb-1">CRITICAL RISKS</p>
                    <h3 class="text-2xl font-mono font-bold" :class="shadowAudit.summary.highRiskCount > 0 ? 'text-red-500' : 'text-green-400'">
                        <span x-text="shadowAudit.summary.highRiskCount"></span>
                    </h3>
                    <p class="text-[9px] text-slate-400">Tools to Kill</p>
                </div>
            </div>

            <!-- Inventory List -->
            <div class="bg-dark border-2 border-dashed border-slate-700 rounded-xl min-h-[300px] flex flex-col relative">
                
                <div x-show="shadowAudit.inventory.length === 0" class="flex-1 flex flex-col items-center justify-center text-slate-600 opacity-50">
                    <i class="fa-solid fa-ghost text-4xl mb-2"></i>
                    <p class="text-xs">No shadow tools detected yet.</p>
                </div>

                <div class="flex-1 overflow-y-auto p-4 space-y-2">
                    <template x-for="tool in shadowAudit.inventory" :key="tool.id">
                        <div class="bg-slate-800 border border-slate-600 p-3 rounded-lg flex justify-between items-center group relative hover:border-purple-500 transition-colors">
                            <div>
                                <div class="flex items-center gap-2">
                                    <span class="font-bold text-white text-sm" x-text="tool.name"></span>
                                    <span class="text-[9px] px-2 py-0.5 rounded border uppercase"
                                          :class="tool.integration === 'silo' ? 'border-red-500 text-red-400 bg-red-500/10' : 'border-green-500 text-green-400 bg-green-500/10'"
                                          x-text="tool.integration"></span>
                                </div>
                                <div class="flex gap-3 text-[10px] text-slate-400 mt-1">
                                    <span>TCO: $<span x-text="Math.round(tool.trueCost).toLocaleString()"></span></span>
                                    <span>Risk: <span :class="tool.risk >= 7 ? 'text-red-400 font-bold' : 'text-slate-400'" x-text="tool.risk + '/10'"></span></span>
                                    <span class="font-mono text-purple-300" x-text="tool.verdict"></span>
                                </div>
                            </div>
                            <button @click="shadowAudit.removeTool(tool.id)" class="text-slate-600 hover:text-red-400 p-2 opacity-0 group-hover:opacity-100 transition-opacity">
                                <i class="fa-solid fa-trash"></i>
                            </button>
                        </div>
                    </template>
                </div>
            </div>

            <!-- AI Governance Prompt -->
            <div x-show="shadowAudit.inventory.length > 0" class="bg-slate-900 border border-purple-500/30 p-6 rounded-xl relative overflow-hidden group">
                <div class="flex justify-between items-center mb-4 relative z-10">
                    <h3 class="font-mono text-white font-bold flex items-center gap-2">
                        <i class="fa-solid fa-robot text-purple-400"></i> 
                        CISO GOVERNANCE AI
                    </h3>
                    <span class="text-[10px] uppercase bg-purple-900/50 text-purple-400 px-2 py-1 rounded border border-purple-500/30 font-bold tracking-wider">
                        Audit Complete
                    </span>
                </div>

                <div class="relative z-10 font-mono text-xs text-slate-300 bg-black/60 p-4 rounded border border-slate-700 mb-4 h-24 overflow-hidden">
                    <div class="absolute inset-0 bg-gradient-to-b from-transparent to-black/90 pointer-events-none"></div>
                    <pre class="whitespace-pre-wrap font-sans leading-relaxed" x-text="shadowAudit.generateGovernancePrompt()"></pre>
                </div>

                <button @click="
                        copyToClipboard(shadowAudit.generateGovernancePrompt(), 'Audit Report');
                        $el.innerHTML = '<i class=\'fa-solid fa-check\'></i> COPIED';
                        $el.classList.add('bg-green-500', 'text-white', 'border-green-500');
                        setTimeout(() => {
                            $el.innerHTML = '<i class=\'fa-solid fa-wand-magic-sparkles\'></i> GENERATE POLICY MEMO (AI)';
                            $el.classList.remove('bg-green-500', 'text-white', 'border-green-500');
                        }, 2000)
                        " 
                        class="relative z-10 w-full py-4 bg-transparent border border-purple-500 text-purple-400 hover:bg-purple-400 hover:text-black font-bold rounded-lg transition-all duration-300 flex items-center justify-center gap-2 font-mono text-xs uppercase tracking-widest shadow-[0_0_10px_rgba(168,85,247,0.1)] hover:shadow-[0_0_20px_rgba(168,85,247,0.4)]">
                    <i class="fa-solid fa-wand-magic-sparkles"></i> GENERATE POLICY MEMO (AI)
                </button>
            </div>

        </div>
    </div>
</div>

        <!-- HALLUCINATION DETECTOR TAB -->
<div x-show="currentTab === 'detector'" x-cloak class="max-w-6xl mx-auto pb-20">
    
    <div class="text-center mb-10">
        <h2 class="font-mono text-3xl font-bold text-white mb-2">
            <i class="fa-solid fa-shield-cat mr-2 text-risk"></i>AI Hallucination Detector
        </h2>
        <p class="text-textMuted text-sm">The "Algorithmic Trust Shield". Mathematically verify AI against Policy.</p>
    </div>

    <div class="grid lg:grid-cols-2 gap-8 items-start">
        
        <!-- INPUT COLUMN -->
        <div class="space-y-6">
            
            <!-- 1. The Policy (Golden Source) -->
            <div class="bg-card border border-slate-700 p-5 rounded-xl relative">
                <div class="flex justify-between items-center mb-2">
                    <label class="text-xs font-mono text-primary font-bold uppercase"><i class="fa-solid fa-book mr-2"></i>1. Ground Truth (Policy)</label>
                    <button @click="hallucinationDetector.loadDemo()" class="text-[10px] bg-slate-800 hover:bg-slate-700 text-white px-2 py-1 rounded border border-slate-600">
                        Load "Air Canada" Demo
                    </button>
                </div>
                <textarea x-model="hallucinationDetector.policy" placeholder="Paste your official Credit Policy, Terms & Conditions, or Regulatory Rule here..." class="w-full h-40 bg-dark border border-slate-600 rounded p-3 text-sm text-slate-300 font-mono focus:border-primary focus:outline-none"></textarea>
            </div>

            <!-- 2. The AI Output -->
            <div class="bg-card border border-slate-700 p-5 rounded-xl">
                <label class="block text-xs font-mono text-purple-400 font-bold uppercase mb-2"><i class="fa-solid fa-robot mr-2"></i>2. AI Chatbot Output</label>
                <textarea x-model="hallucinationDetector.aiOutput" placeholder="Paste the text generated by your LLM/Chatbot here..." class="w-full h-32 bg-dark border border-slate-600 rounded p-3 text-sm text-slate-300 font-mono focus:border-purple-400 focus:outline-none"></textarea>
            </div>

            <button @click="hallucinationDetector.scan()" 
                    :disabled="hallucinationDetector.loading"
                    class="w-full py-4 bg-white text-dark font-bold rounded-lg shadow-glow hover:bg-gray-200 transition-all flex items-center justify-center gap-2">
                <span x-show="!hallucinationDetector.loading"><i class="fa-solid fa-magnifying-glass-chart"></i> RUN MATH VERIFICATION</span>
                <span x-show="hallucinationDetector.loading"><i class="fa-solid fa-circle-notch fa-spin"></i> CALCULATING JACCARD INDEX...</span>
            </button>
        </div>

        <!-- OUTPUT COLUMN -->
        <div class="relative min-h-[400px]">
            
            <!-- Empty State -->
            <div x-show="!hallucinationDetector.result" class="absolute inset-0 flex flex-col items-center justify-center border-2 border-dashed border-slate-700 rounded-xl text-slate-500">
                <i class="fa-solid fa-fingerprint text-6xl mb-4 opacity-20"></i>
                <p class="font-mono text-xs uppercase">Ready to Scan</p>
            </div>

            <!-- Results Card -->
            <div x-show="hallucinationDetector.result" x-transition:enter="transition ease-out duration-500 transform" x-transition:enter-start="opacity-0 translate-y-4" x-transition:enter-end="opacity-100 translate-y-0"
                 class="bg-dark border-2 rounded-xl overflow-hidden shadow-2xl relative"
                 :class="hallucinationDetector.result?.score > 80 ? 'border-primary' : 'border-risk'">
                
                <!-- Header -->
                <div class="p-6 text-center border-b border-slate-800" :class="hallucinationDetector.result?.score > 80 ? 'bg-primary/5' : 'bg-risk/5'">
                    <span class="text-[10px] font-mono uppercase tracking-widest mb-1 block text-slate-400">TRUST SCORE</span>
                    <h3 class="text-6xl font-bold font-mono mb-2" 
                        :class="hallucinationDetector.result?.color"
                        x-text="hallucinationDetector.result?.score"></h3>
                    <span class="px-3 py-1 rounded text-xs font-bold border"
                          :class="hallucinationDetector.result?.score > 80 ? 'bg-primary text-dark border-primary' : 'bg-risk text-dark border-risk'"
                          x-text="hallucinationDetector.result?.verdict"></span>
                </div>

                <!-- Analysis Body -->
                <div class="p-6">
                    <h4 class="text-xs font-bold text-slate-400 uppercase mb-4">Deviation Log</h4>
                    
                    <div class="space-y-3">
                        <template x-for="flag in hallucinationDetector.result?.flags">
                            <div class="p-3 rounded border-l-4 text-xs bg-slate-800"
                                 :class="flag.type === 'CRITICAL' ? 'border-risk text-white' : 'border-yellow-500 text-slate-300'">
                                <div class="flex items-center gap-2 mb-1">
                                    <i class="fa-solid" :class="flag.type === 'CRITICAL' ? 'fa-triangle-exclamation text-risk' : 'fa-circle-info text-yellow-500'"></i>
                                    <span class="font-bold" x-text="flag.type"></span>
                                </div>
                                <span x-text="flag.msg"></span>
                            </div>
                        </template>
                        <div x-show="hallucinationDetector.result?.flags.length === 0" class="text-center text-slate-500 italic text-xs py-4">
                            No mathematical deviations detected. Output aligns with Policy.
                        </div>
                    </div>

                    <!-- AI Governance Prompt -->
                    <div class="mt-8 pt-6 border-t border-slate-800">
                        <div class="flex justify-between items-center mb-2">
                            <h4 class="text-[10px] font-bold text-slate-400 uppercase">Model Risk Officer (MRO) Tool</h4>
                        </div>
                        
                        <div class="bg-black/50 p-3 rounded text-[10px] text-slate-400 font-mono mb-3 h-20 overflow-hidden relative">
                            <div class="absolute inset-0 bg-gradient-to-b from-transparent to-black/80 pointer-events-none"></div>
                            <span x-text="hallucinationDetector.generateCompliancePrompt()"></span>
                        </div>
                        
                        <button @click="
                                copyToClipboard(hallucinationDetector.generateCompliancePrompt(), 'Compliance Memo');
                                $el.innerHTML = '<i class=\'fa-solid fa-check\'></i> COPIED';
                                $el.classList.add('bg-green-500', 'text-white', 'border-green-500');
                                setTimeout(() => {
                                    $el.innerHTML = '<i class=\'fa-solid fa-wand-magic-sparkles\'></i> GENERATE RISK MEMO (AI)';
                                    $el.classList.remove('bg-green-500', 'text-white', 'border-green-500');
                                }, 2000)
                                " 
                                class="w-full border border-purple-500 text-purple-400 hover:bg-purple-500 hover:text-white py-3 rounded text-xs font-bold transition-all flex items-center justify-center gap-2">
                            <i class="fa-solid fa-wand-magic-sparkles"></i> GENERATE RISK MEMO (AI)
                        </button>
                    </div>
                </div>

            </div>
        </div>

    </div>
</div>

        <!-- VENDOR COACH TAB -->
<div x-show="currentTab === 'vendor'" x-cloak class="max-w-6xl mx-auto pb-20">
    
    <div class="text-center mb-10">
        <h2 class="font-mono text-3xl font-bold text-white mb-2">Vendor Partnership Coach</h2>
        <p class="text-textMuted text-sm">Stop paying for "Effort". Start paying for "Impact".</p>
    </div>

    <!-- 1. INPUT PHASE -->
    <div x-show="vendorCoach.step === 'input'" class="grid lg:grid-cols-2 gap-8">
        <div class="bg-card border border-slate-700 p-6 rounded-xl">
            <h3 class="font-mono text-xs text-yellow-500 uppercase mb-4 border-b border-slate-700 pb-2">Contract Parameters</h3>
            
            <div class="space-y-4">
                <div>
                    <label class="text-xs text-slate-400 block mb-1">Vendor Name</label>
                    <input type="text" x-model="vendorCoach.inputs.vendorName" placeholder="e.g. Infosys, Accenture" class="w-full bg-dark border border-slate-600 rounded p-2 text-white text-sm focus:border-yellow-500 focus:outline-none">
                </div>
                
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="text-xs text-slate-400 block mb-1">Annual Spend ($)</label>
                        <input type="number" x-model="vendorCoach.inputs.spend" class="w-full bg-dark border border-slate-600 rounded p-2 text-white text-sm">
                    </div>
                    <div>
                        <label class="text-xs text-slate-400 block mb-1">Contract Type</label>
                        <select x-model="vendorCoach.inputs.model" class="w-full bg-dark border border-slate-600 rounded p-2 text-white text-sm">
                            <option value="tm">Time & Materials (Hourly)</option>
                            <option value="fixed">Fixed Price (Project)</option>
                            <option value="outcome">Managed Service</option>
                        </select>
                    </div>
                </div>

                <div>
                    <div class="flex justify-between mb-1">
                        <label class="text-xs text-slate-400">Dependency (Lock-in)</label>
                        <span class="text-xs font-bold text-white" x-text="vendorCoach.inputs.dependency + '/10'"></span>
                    </div>
                    <input type="range" min="1" max="10" x-model="vendorCoach.inputs.dependency" class="w-full h-2 bg-slate-800 rounded-lg appearance-none cursor-pointer accent-red-500">
                    <p class="text-[9px] text-slate-500">10 = Impossible to fire them.</p>
                </div>

                <div>
                    <div class="flex justify-between mb-1">
                        <label class="text-xs text-slate-400">Quality Satisfaction</label>
                        <span class="text-xs font-bold text-white" x-text="vendorCoach.inputs.quality + '/10'"></span>
                    </div>
                    <input type="range" min="1" max="10" x-model="vendorCoach.inputs.quality" class="w-full h-2 bg-slate-800 rounded-lg appearance-none cursor-pointer accent-green-500">
                </div>

                <button @click="vendorCoach.analyze()" class="w-full mt-4 bg-yellow-500 hover:bg-yellow-400 text-dark font-bold py-3 rounded-lg shadow-glow transition-all">
                    ANALYZE LEVERAGE
                </button>
            </div>
        </div>

        <!-- RIGHT: EDUCATIONAL PANEL -->
        <div class="bg-dark/50 border-2 border-dashed border-slate-700 rounded-xl p-8 flex flex-col justify-center items-center text-center">
            <i class="fa-solid fa-scale-balanced text-4xl text-slate-600 mb-4"></i>
            <h3 class="text-white font-bold text-lg mb-2">The Efficiency Paradox</h3>
            <p class="text-sm text-slate-400 max-w-sm">
                If you pay by the hour, you are incentivizing the vendor to be slow. 
                <br><br>
                Use this tool to calculate your "Leverage Score" and simulate the renegotiation before you walk into the room.
            </p>
        </div>
    </div>

    <!-- 2. ANALYSIS & SIMULATION PHASE -->
    <div x-show="vendorCoach.step === 'analysis' || vendorCoach.step === 'sim'" class="grid lg:grid-cols-12 gap-6">
        
        <!-- LEFT: DASHBOARD -->
        <div class="lg:col-span-4 space-y-4">
            
            <!-- Leverage Card -->
            <div class="bg-card border border-slate-700 p-6 rounded-xl text-center relative overflow-hidden">
                <p class="text-[10px] text-slate-500 uppercase tracking-widest mb-2">YOUR LEVERAGE SCORE</p>
                <h3 class="text-5xl font-bold font-mono" :class="vendorCoach.analysis.leverage > 60 ? 'text-green-400' : 'text-red-400'">
                    <span x-text="vendorCoach.analysis.leverage"></span>/100
                </h3>
                <div class="mt-4 text-xs font-bold px-3 py-1 rounded bg-slate-800 border border-slate-600 inline-block" x-text="vendorCoach.analysis.readiness"></div>
            </div>

            <!-- Waste Card -->
            <div class="bg-card border border-slate-700 p-6 rounded-xl text-center">
                <p class="text-[10px] text-slate-500 uppercase tracking-widest mb-2">ESTIMATED ANNUAL WASTE</p>
                <h3 class="text-3xl font-bold font-mono text-white mb-1">
                    $<span x-text="vendorCoach.analysis.waste.toLocaleString()"></span>
                </h3>
                <p class="text-[10px] text-red-400 italic">Paying for bad quality / rework</p>
            </div>

            <!-- Trap Card -->
            <div class="bg-yellow-900/10 border border-yellow-500/30 p-4 rounded-xl">
                <div class="flex items-center gap-2 mb-2 text-yellow-500 text-xs font-bold uppercase">
                    <i class="fa-solid fa-triangle-exclamation"></i> Diagnosed Trap
                </div>
                <p class="text-xs text-white leading-relaxed" x-text="vendorCoach.analysis.trap"></p>
            </div>

            <button @click="vendorCoach.step = 'input'" class="w-full border border-slate-600 text-slate-400 hover:text-white py-2 rounded text-xs">
                Edit Inputs
            </button>
        </div>

        <!-- RIGHT: SIMULATOR / PROMPT -->
        <div class="lg:col-span-8">
            
            <!-- SIMULATOR UI -->
            <div x-show="vendorCoach.step === 'analysis'" class="bg-gradient-to-br from-slate-800 to-indigo-900/20 border border-indigo-500/30 p-8 rounded-xl text-center flex flex-col justify-center min-h-[400px]">
                <i class="fa-solid fa-chess text-5xl text-indigo-400 mb-4"></i>
                <h3 class="text-2xl font-bold text-white mb-2">Negotiation Simulator</h3>
                <p class="text-slate-300 max-w-md mx-auto mb-8">Test your strategy against an AI Agent representing <span class="text-white font-bold" x-text="vendorCoach.inputs.vendorName"></span>.</p>
                
                <button @click="vendorCoach.startSim()" class="bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-3 px-8 rounded-full shadow-glow mx-auto transition-all">
                    ENTER THE ROOM
                </button>
            </div>

            <!-- ACTIVE GAME -->
            <div x-show="vendorCoach.step === 'sim'" class="bg-card border border-slate-700 rounded-xl overflow-hidden flex flex-col h-[500px]">
                
                <!-- Chat Log -->
                <div class="flex-1 overflow-y-auto p-6 space-y-4 bg-dark">
                    <template x-for="msg in vendorCoach.sim.history">
                        <div class="flex flex-col" :class="msg.role === 'user' ? 'items-end' : 'items-start'">
                            <div class="max-w-[85%] p-3 rounded-lg text-sm"
                                 :class="msg.role === 'user' ? 'bg-indigo-600 text-white rounded-tr-none' : 'bg-slate-800 text-slate-200 border border-slate-600 rounded-tl-none'">
                                <span x-text="msg.text"></span>
                            </div>
                        </div>
                    </template>
                </div>

                <!-- Controls -->
                <div class="p-4 bg-slate-800 border-t border-slate-700">
                    <p class="text-[10px] text-slate-400 uppercase mb-2 text-center">Choose your tactical move:</p>
                    <div class="grid grid-cols-3 gap-2">
                        <button @click="vendorCoach.makeMove('hardball')" class="bg-red-900/30 border border-red-500/50 hover:bg-red-900/50 text-white p-2 rounded text-xs font-bold transition-all">
                            Reject & Demand
                        </button>
                        <button @click="vendorCoach.makeMove('partnership')" class="bg-blue-900/30 border border-blue-500/50 hover:bg-blue-900/50 text-white p-2 rounded text-xs font-bold transition-all">
                            Propose New Model
                        </button>
                        <button @click="vendorCoach.makeMove('threaten')" class="bg-orange-900/30 border border-orange-500/50 hover:bg-orange-900/50 text-white p-2 rounded text-xs font-bold transition-all">
                            Threaten RFP
                        </button>
                    </div>
                </div>
            </div>

            <!-- PROMPT GENERATOR (Below Sim) -->
            <div class="mt-6 bg-slate-900 border border-yellow-500/30 p-6 rounded-xl relative overflow-hidden group">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="font-mono text-white font-bold flex items-center gap-2">
                        <i class="fa-solid fa-robot text-yellow-500"></i> AI NEGOTIATION SCRIPT
                    </h3>
                </div>
                <div class="bg-black/50 p-3 rounded text-[10px] text-slate-400 font-mono mb-3 h-20 overflow-hidden relative">
                    <div class="absolute inset-0 bg-gradient-to-b from-transparent to-black/80 pointer-events-none"></div>
                    <span x-text="vendorCoach.generateNegotiationPrompt()"></span>
                </div>
                <button @click="
                        copyToClipboard(vendorCoach.generateNegotiationPrompt(), 'Script');
                        $el.innerHTML = '<i class=\'fa-solid fa-check\'></i> COPIED';
                        setTimeout(() => { $el.innerHTML = '<i class=\'fa-solid fa-wand-magic-sparkles\'></i> GENERATE SCRIPT (AI)'; }, 2000)
                        " 
                        class="w-full border border-yellow-500 text-yellow-400 hover:bg-yellow-500 hover:text-dark py-2 rounded text-xs font-bold transition-all">
                    <i class="fa-solid fa-wand-magic-sparkles"></i> GENERATE SCRIPT (AI)
                </button>
            </div>

        </div>
    </div>
</div>

        <!-- FINOPS AUDITOR TAB -->
<div x-show="currentTab === 'capex'" x-cloak class="max-w-6xl mx-auto pb-20">
    
    <div class="text-center mb-10">
        <h2 class="font-mono text-3xl font-bold text-white mb-2">FinOps Auditor</h2>
        <p class="text-textMuted text-sm">Translate "Jira Tickets" into "Balance Sheet Assets" (IAS 38).</p>
    </div>

    <div class="grid lg:grid-cols-12 gap-8 items-start">
        
        <!-- LEFT: INPUT & CONTROLS -->
        <div class="lg:col-span-4 bg-card border border-slate-700 p-6 rounded-xl space-y-6">
            <div>
                <label class="block text-xs font-mono text-white mb-3 uppercase font-bold">
                    <i class="fa-solid fa-list-check mr-2"></i>Step 1: Paste Ticket List
                </label>
                <textarea x-model="capexClassifier.input" 
                          class="w-full h-48 bg-dark border border-slate-600 rounded-lg p-3 text-xs font-mono text-white focus:border-green-400 focus:outline-none leading-relaxed placeholder-slate-600"
                          placeholder="FEAT-101: New Login Flow&#10;BUG-102: Fix Crash..."></textarea>
            </div>

            <!-- The Aggression Slider -->
            <div class="bg-slate-800/50 p-4 rounded-lg border border-slate-600">
                <div class="flex justify-between mb-2">
                    <label class="text-[10px] font-mono text-slate-400 uppercase">Accounting Stance</label>
                    <span class="text-[10px] font-bold" 
                          :class="capexClassifier.sensitivity > 60 ? 'text-red-400' : (capexClassifier.sensitivity < 40 ? 'text-blue-400' : 'text-green-400')"
                          x-text="capexClassifier.sensitivity > 60 ? 'AGGRESSIVE' : (capexClassifier.sensitivity < 40 ? 'CONSERVATIVE' : 'BALANCED')"></span>
                </div>
                <input type="range" min="0" max="100" step="10" x-model="capexClassifier.sensitivity" class="w-full h-2 bg-dark rounded-lg appearance-none cursor-pointer">
                <p class="text-[9px] text-slate-500 mt-2 italic">
                    <span x-show="capexClassifier.sensitivity > 60">"If it's grey, capitalize it. Boost EBITDA."</span>
                    <span x-show="capexClassifier.sensitivity < 40">"If in doubt, expense it. Reduce tax."</span>
                    <span x-show="capexClassifier.sensitivity >= 40 && capexClassifier.sensitivity <= 60">"Strict adherence to IAS 38."</span>
                </p>
            </div>

            <button @click="capexClassifier.analyze()" 
                    class="w-full bg-green-600 hover:bg-green-500 text-white font-bold py-3 rounded-lg shadow-glow transition-all">
                RUN AUDIT
            </button>
        </div>

        <!-- RIGHT: RESULTS DASHBOARD -->
        <div class="lg:col-span-8 relative min-h-[400px]">
            
            <!-- Empty State -->
            <div x-show="!capexClassifier.analysis" class="absolute inset-0 flex flex-col items-center justify-center border-2 border-dashed border-slate-700 rounded-xl text-slate-500">
                <i class="fa-solid fa-scale-balanced text-4xl mb-4 opacity-20"></i>
                <p class="font-mono text-xs uppercase">Ready to Classify</p>
            </div>

            <!-- Results -->
            <div x-show="capexClassifier.analysis" x-transition class="space-y-6">
                
                <!-- Financial Summary Bar -->
                <div class="grid grid-cols-2 gap-4">
                    <div class="bg-card border border-slate-700 p-5 rounded-xl flex flex-col justify-between">
                        <p class="text-[10px] text-slate-500 uppercase tracking-widest">CAPITALIZATION RATE</p>
                        <div class="flex items-baseline gap-2 mt-1">
                            <h3 class="text-4xl font-bold font-mono text-white" x-text="capexClassifier.stats.ratio + '%'"></h3>
                            <span class="text-xs text-slate-400">Target: 40%</span>
                        </div>
                        <div class="w-full bg-slate-800 h-2 rounded-full mt-3 overflow-hidden">
                            <div class="h-full transition-all duration-500" 
                                 :class="capexClassifier.stats.ratio > 60 ? 'bg-red-500' : 'bg-green-500'"
                                 :style="`width: ${capexClassifier.stats.ratio}%`"></div>
                        </div>
                    </div>
                    <div class="bg-card border border-slate-700 p-5 rounded-xl">
                        <p class="text-[10px] text-slate-500 uppercase tracking-widest">VALUE CREATION</p>
                        <div class="mt-2 space-y-2">
                            <div class="flex justify-between text-xs">
                                <span class="text-green-400"><i class="fa-solid fa-building mr-2"></i>ASSETS (CapEx)</span>
                                <span class="text-white font-mono" x-text="'$' + capexClassifier.stats.capexValue.toLocaleString()"></span>
                            </div>
                            <div class="flex justify-between text-xs">
                                <span class="text-orange-400"><i class="fa-solid fa-fire mr-2"></i>EXPENSE (OpEx)</span>
                                <span class="text-white font-mono" x-text="'$' + (capexClassifier.stats.totalValue - capexClassifier.stats.capexValue).toLocaleString()"></span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Detailed Table -->
                <div class="bg-card border border-slate-700 rounded-xl overflow-hidden max-h-[300px] overflow-y-auto">
                    <table class="w-full text-left text-sm">
                        <thead class="bg-slate-800 text-[10px] text-slate-400 uppercase font-mono sticky top-0">
                            <tr>
                                <th class="p-3">Ticket</th>
                                <th class="p-3">Type</th>
                                <th class="p-3 hidden md:table-cell">Accounting Logic</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-slate-700">
                            <template x-for="item in capexClassifier.analysis">
                                <tr class="hover:bg-slate-800/50">
                                    <td class="p-3 font-mono text-xs text-white truncate max-w-[150px]" x-text="item.ticket"></td>
                                    <td class="p-3">
                                        <span class="px-2 py-1 rounded text-[10px] font-bold border"
                                              :class="item.type === 'CapEx' ? 'bg-green-900/20 text-green-400 border-green-500/50' : (item.type === 'OpEx' ? 'bg-orange-900/20 text-orange-400 border-orange-500/50' : 'bg-slate-700 text-slate-300 border-slate-500')">
                                            <span x-text="item.type"></span>
                                        </span>
                                    </td>
                                    <td class="p-3 text-slate-400 text-xs italic hidden md:table-cell" x-text="item.reason"></td>
                                </tr>
                            </template>
                        </tbody>
                    </table>
                </div>

                <!-- AI Prompt Box -->
                <div class="bg-slate-900 border border-green-500/30 p-6 rounded-xl relative overflow-hidden group">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="font-mono text-white font-bold flex items-center gap-2">
                            <i class="fa-solid fa-robot text-green-500"></i> EXTERNAL AUDITOR DEFENSE
                        </h3>
                    </div>
                    <div class="bg-black/50 p-3 rounded text-[10px] text-slate-400 font-mono mb-3 h-20 overflow-hidden relative">
                        <div class="absolute inset-0 bg-gradient-to-b from-transparent to-black/80 pointer-events-none"></div>
                        <span x-text="capexClassifier.generateAuditorPrompt()"></span>
                    </div>
                    <button @click="
                            copyToClipboard(capexClassifier.generateAuditorPrompt(), 'Audit Data');
                            $el.innerHTML = '<i class=\'fa-solid fa-check\'></i> COPIED';
                            setTimeout(() => { $el.innerHTML = '<i class=\'fa-solid fa-wand-magic-sparkles\'></i> GENERATE DEFENSE MEMO (AI)'; }, 2000)
                            " 
                            class="w-full border border-green-500 text-green-400 hover:bg-green-500 hover:text-dark py-2 rounded text-xs font-bold transition-all">
                        <i class="fa-solid fa-wand-magic-sparkles"></i> GENERATE DEFENSE MEMO (AI)
                    </button>
                </div>

            </div>
        </div>

    </div>
</div>

        <!-- LEGACY CODE EXPLAINER TAB -->
<div x-show="currentTab === 'legacy'" x-cloak class="max-w-6xl mx-auto pb-20">
    
    <div class="text-center mb-10">
        <h2 class="font-mono text-3xl font-bold text-white mb-2">Legacy Code Scanner</h2>
        <p class="text-textMuted text-sm">Don't let them say "It's too risky to touch." Audit the Black Box yourself.</p>
    </div>

    <div class="grid lg:grid-cols-2 gap-8 items-start">
        
        <!-- LEFT: THE TERMINAL (Input) -->
        <div class="flex flex-col h-[500px]">
            
            <!-- Controls -->
            <div class="bg-card border border-slate-700 rounded-t-xl p-4 flex justify-between items-center">
                <div class="flex gap-2">
                    <div class="w-3 h-3 rounded-full bg-red-500"></div>
                    <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
                    <div class="w-3 h-3 rounded-full bg-green-500"></div>
                </div>
                
                <div class="flex gap-2">
                    <select x-model="legacyExplainer.targetAudience" class="bg-dark border border-slate-600 rounded text-xs text-white px-2 py-1">
                        <option value="ceo">Explain to CEO (Biz)</option>
                        <option value="cto">Explain to CTO (Tech)</option>
                        <option value="compliance">Explain to Risk (Audit)</option>
                    </select>
                </div>
            </div>

            <!-- Editor -->
            <div class="flex-1 relative bg-black border-x border-b border-slate-700 rounded-b-xl overflow-hidden shadow-2xl">
                <textarea x-model="legacyExplainer.input" 
                          class="w-full h-full bg-black text-green-500 font-mono text-xs p-6 focus:outline-none resize-none leading-loose placeholder-green-900/50"
                          placeholder="// PASTE COBOL, SQL, OR JAVA HERE...
IF CUST-TYPE = 'VIP' 
   PERFORM DISCOUNT-ROUTINE 
ELSE 
   PERFORM STANDARD-FEE 
END-IF."></textarea>
                
                <!-- Run Button -->
                <div class="absolute bottom-6 right-6">
                    <button @click="legacyExplainer.analyze()" 
                            :disabled="legacyExplainer.loading"
                            class="bg-green-600 hover:bg-green-500 text-black font-bold py-2 px-6 rounded font-mono text-xs shadow-[0_0_15px_rgba(34,197,94,0.4)] transition-all flex items-center gap-2 disabled:opacity-50">
                        <span x-show="!legacyExplainer.loading">> RUN STATIC ANALYSIS</span>
                        <span x-show="legacyExplainer.loading"><i class="fa-solid fa-circle-notch fa-spin"></i> PARSING...</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- RIGHT: THE DIAGNOSTIC (Output) -->
        <div class="relative min-h-[500px]">
            
            <!-- Empty State -->
            <div x-show="!legacyExplainer.analysis" class="absolute inset-0 flex flex-col items-center justify-center border-2 border-dashed border-slate-700 rounded-xl text-slate-500">
                <i class="fa-solid fa-code-branch text-4xl mb-4 opacity-20"></i>
                <p class="font-mono text-xs uppercase">Awaiting Source Code</p>
            </div>

            <!-- Results Card -->
            <div x-show="legacyExplainer.analysis" x-transition class="bg-card border border-slate-700 rounded-xl shadow-2xl relative overflow-hidden h-full flex flex-col">
                
                <!-- Header -->
                <div class="p-6 border-b border-slate-700 bg-slate-800/50">
                    <div class="flex justify-between items-start">
                        <div>
                            <p class="text-[10px] font-mono text-slate-500 uppercase tracking-widest mb-1">DETECTED LANGUAGE</p>
                            <h3 class="text-xl font-bold text-white font-mono" x-text="legacyExplainer.analysis?.language"></h3>
                        </div>
                        <div class="text-right">
                            <span class="px-3 py-1 rounded text-[10px] font-bold border uppercase"
                                  :class="legacyExplainer.analysis?.riskScore > 50 ? 'bg-red-900/20 border-red-500 text-red-400' : 'bg-green-900/20 border-green-500 text-green-400'"
                                  x-text="legacyExplainer.analysis?.archetype"></span>
                        </div>
                    </div>
                </div>

                <!-- Body Metrics -->
                <div class="p-6 space-y-6 flex-1">
                    
                    <!-- 1. Risk Meter -->
                    <div>
                        <div class="flex justify-between text-xs font-bold mb-2">
                            <span class="text-slate-400">Technical Bankruptcy Score</span>
                            <span :class="legacyExplainer.analysis?.riskScore > 50 ? 'text-red-400' : 'text-green-400'" x-text="legacyExplainer.analysis?.riskScore + '/100'"></span>
                        </div>
                        <div class="w-full bg-slate-800 h-2 rounded-full overflow-hidden">
                            <div class="h-full transition-all duration-1000" 
                                 :class="legacyExplainer.analysis?.riskScore > 50 ? 'bg-red-500' : 'bg-green-500'"
                                 :style="`width: ${legacyExplainer.analysis?.riskScore}%`"></div>
                        </div>
                    </div>

                    <!-- 2. Value Meter -->
                    <div>
                        <div class="flex justify-between text-xs font-bold mb-2">
                            <span class="text-slate-400">Business Logic Density</span>
                            <span class="text-blue-400" x-text="legacyExplainer.analysis?.bizScore + '/100'"></span>
                        </div>
                        <div class="w-full bg-slate-800 h-2 rounded-full overflow-hidden">
                            <div class="h-full bg-blue-500 transition-all duration-1000" :style="`width: ${legacyExplainer.analysis?.bizScore}%`"></div>
                        </div>
                    </div>

                    <!-- 3. Flaws List -->
                    <div class="bg-dark p-4 rounded-lg border border-slate-700 h-32 overflow-y-auto">
                        <p class="text-[10px] text-slate-500 uppercase mb-2">CODE SMELLS DETECTED</p>
                        <template x-for="flaw in legacyExplainer.analysis?.flaws">
                            <div class="flex items-center gap-2 text-xs text-red-300 mb-1 font-mono">
                                <i class="fa-solid fa-bug"></i> <span x-text="flaw"></span>
                            </div>
                        </template>
                        <div x-show="legacyExplainer.analysis?.flaws.length === 0" class="text-xs text-green-400 italic">
                            No critical keywords found. Code structure appears clean.
                        </div>
                    </div>
                </div>

                <!-- Footer: Prompt Gen -->
                <div class="p-6 bg-slate-900 border-t border-slate-700">
                    <div class="flex justify-between items-center mb-3">
                        <h4 class="text-[10px] font-bold text-white uppercase"><i class="fa-solid fa-language mr-2 text-green-500"></i>AI Translator</h4>
                    </div>
                    
                    <button @click="
                            copyToClipboard(legacyExplainer.generateTranslatorPrompt(), 'Prompt');
                            $el.innerHTML = '<i class=\'fa-solid fa-check\'></i> COPIED';
                            setTimeout(() => { $el.innerHTML = '<i class=\'fa-solid fa-wand-magic-sparkles\'></i> GENERATE TRANSLATION (AI)'; }, 2000)
                            " 
                            class="w-full border border-green-500 text-green-400 hover:bg-green-500 hover:text-black py-3 rounded text-xs font-bold transition-all flex items-center justify-center gap-2">
                        <i class="fa-solid fa-wand-magic-sparkles"></i> GENERATE TRANSLATION (AI)
                    </button>
                    <p class="text-[9px] text-slate-500 text-center mt-2">
                        Takes calculated risk scores and asks AI to extract the Business Rule.
                    </p>
                </div>

            </div>
        </div>

    </div>
</div>

        <!-- WATERMELON DETECTOR TAB -->
<div x-show="currentTab === 'watermelon'" x-cloak class="max-w-6xl mx-auto pb-20">
    
    <div class="text-center mb-10">
        <h2 class="font-mono text-3xl font-bold text-white mb-2">"Green Light" Lie Detector</h2>
        <p class="text-textMuted text-sm">Analyze sequential status reports. Detect the "Watermelon Effect" (Green outside, Red inside).</p>
    </div>

    <div class="grid lg:grid-cols-2 gap-8 items-start">
        
        <!-- LEFT: THE EVIDENCE (Inputs) -->
        <div class="space-y-4">
            <template x-for="(week, idx) in ['Week 1 (2 weeks ago)', 'Week 2 (Last week)', 'Week 3 (This week)']">
                <div class="bg-card border border-slate-700 p-4 rounded-xl">
                    <label class="block text-xs font-mono text-slate-400 mb-2 uppercase" x-text="week"></label>
                    <textarea x-model="watermelonDetector.inputs[idx]" 
                              class="w-full h-24 bg-dark border border-slate-600 rounded p-3 text-sm text-white focus:border-red-500 focus:outline-none placeholder-slate-600"
                              placeholder="Paste status update text..."></textarea>
                </div>
            </template>

            <button @click="watermelonDetector.analyze()" 
                    :disabled="watermelonDetector.loading"
                    class="w-full py-4 bg-red-600 hover:bg-red-500 text-white font-bold rounded-lg shadow-glow transition-all flex items-center justify-center gap-2 disabled:opacity-50">
                <span x-show="!watermelonDetector.loading"><i class="fa-solid fa-magnifying-glass"></i> SCAN FOR B.S.</span>
                <span x-show="watermelonDetector.loading"><i class="fa-solid fa-circle-notch fa-spin"></i> RUNNING LINGUISTIC ANALYSIS...</span>
            </button>
        </div>

        <!-- RIGHT: THE VERDICT (Output) -->
        <div class="relative min-h-[400px]">
            
            <!-- Empty State -->
            <div x-show="!watermelonDetector.result" class="absolute inset-0 flex flex-col items-center justify-center border-2 border-dashed border-slate-700 rounded-xl text-slate-500">
                <div class="w-20 h-20 rounded-full border-4 border-slate-600 flex items-center justify-center mb-4">
                    <i class="fa-solid fa-question text-4xl"></i>
                </div>
                <p class="font-mono text-xs uppercase">Awaiting Reports</p>
            </div>

            <!-- Result Card -->
            <div x-show="watermelonDetector.result" x-transition class="bg-card border-2 rounded-xl overflow-hidden shadow-2xl relative"
                 :class="watermelonDetector.result?.bsScore > 50 ? 'border-red-500' : 'border-green-500'">
                
                <!-- The Gauge -->
                <div class="p-8 text-center bg-gradient-to-b from-slate-900 to-slate-800 border-b border-slate-700">
                    <p class="text-[10px] font-mono uppercase tracking-widest text-slate-400 mb-2">DECEPTION PROBABILITY</p>
                    
                    <div class="relative w-40 h-40 mx-auto flex items-center justify-center rounded-full border-8 transition-colors duration-1000"
                         :class="watermelonDetector.result?.bsScore > 50 ? 'border-red-500 text-red-500 bg-red-500/10' : 'border-green-500 text-green-500 bg-green-500/10'">
                        <span class="text-5xl font-bold font-mono" x-text="watermelonDetector.result?.bsScore + '%'"></span>
                    </div>
                    
                    <h3 class="text-2xl font-bold text-white mt-6 uppercase tracking-tight" x-text="watermelonDetector.result?.verdict"></h3>
                </div>

                <!-- The Red Flags -->
                <div class="p-6 bg-dark">
                    <h4 class="text-xs font-bold text-slate-400 uppercase mb-4">Detected Patterns</h4>
                    <div class="space-y-3">
                        <template x-for="flag in watermelonDetector.result?.red_flags">
                            <div class="flex gap-3 items-start bg-slate-800 p-3 rounded border border-slate-700">
                                <i class="fa-solid fa-triangle-exclamation text-red-500 mt-1"></i>
                                <p class="text-sm text-slate-300 leading-tight" x-text="flag"></p>
                            </div>
                        </template>
                    </div>

                    <!-- AI Prompt Generator -->
                    <div class="mt-8 pt-6 border-t border-slate-700">
                        <div class="flex justify-between items-center mb-2">
                            <h4 class="text-[10px] font-bold text-slate-400 uppercase">Forensic Audit Tool</h4>
                        </div>
                        
                        <div class="bg-black/50 p-3 rounded text-[10px] text-slate-400 font-mono mb-3 h-20 overflow-hidden relative">
                            <div class="absolute inset-0 bg-gradient-to-b from-transparent to-black/80 pointer-events-none"></div>
                            <span x-text="watermelonDetector.generateInterrogationPrompt()"></span>
                        </div>
                        
                        <button @click="
                                copyToClipboard(watermelonDetector.generateInterrogationPrompt(), 'Audit Script');
                                $el.innerHTML = '<i class=\'fa-solid fa-check\'></i> COPIED';
                                setTimeout(() => { $el.innerHTML = '<i class=\'fa-solid fa-wand-magic-sparkles\'></i> GENERATE INTERROGATION SCRIPT (AI)'; }, 2000)
                                " 
                                class="w-full border border-red-500 text-red-400 hover:bg-red-500 hover:text-white py-3 rounded text-xs font-bold transition-all flex items-center justify-center gap-2">
                            <i class="fa-solid fa-wand-magic-sparkles"></i> GENERATE INTERROGATION SCRIPT (AI)
                        </button>
                    </div>
                </div>

            </div>
        </div>

    </div>
</div>

        <!-- RISK SIMULATOR TAB -->
<div x-show="currentTab === 'risksim'" x-cloak class="max-w-5xl mx-auto pb-20">
    
    <div class="text-center mb-8">
        <h2 class="font-mono text-3xl font-bold text-white mb-2">The Risk Dojo</h2>
        <p class="text-textMuted text-sm">Negotiate the "Go/No-Go". Balance Trust vs. Velocity.</p>
    </div>

    <!-- 1. INTRO SCREEN -->
    <div x-show="!riskSim.active" class="flex flex-col items-center justify-center bg-card border border-slate-700 p-10 rounded-xl text-center max-w-2xl mx-auto">
        <div class="w-24 h-24 rounded-full bg-slate-800 border-2 border-risk flex items-center justify-center mb-6 shadow-[0_0_20px_rgba(248,113,113,0.3)]">
            <i class="fa-solid fa-user-shield text-4xl text-risk"></i>
        </div>
        <h3 class="text-2xl font-bold text-white mb-2">Opponent: Marcus (The CRO)</h3>
        <p class="text-slate-400 mb-8 leading-relaxed">
            "My job is to keep this bank out of the headlines. Your job is to launch features. 
            <br>Prove to me you aren't reckless, and I might let you pass."
        </p>
        <button @click="riskSim.start()" class="bg-risk hover:bg-red-500 text-dark font-bold py-3 px-10 rounded-lg shadow-glow transition-all">
            ENTER BOARDROOM
        </button>
    </div>

    <!-- 2. GAME BOARD -->
    <div x-show="riskSim.active && !riskSim.outcome" class="grid lg:grid-cols-12 gap-8">
        
        <!-- LEFT: MARCUS (The Opponent) -->
        <div class="lg:col-span-4 space-y-6">
            <div class="bg-card border-2 border-risk p-6 rounded-xl relative overflow-hidden">
                <div class="absolute top-0 right-0 p-4 opacity-10"><i class="fa-solid fa-gavel text-8xl text-risk"></i></div>
                
                <div class="flex items-center gap-4 mb-6">
                    <div class="w-16 h-16 rounded-full bg-slate-800 border border-slate-600 flex items-center justify-center">
                        <i class="fa-solid fa-user-tie text-2xl text-slate-300"></i>
                    </div>
                    <div>
                        <h3 class="font-bold text-white">Marcus</h3>
                        <p class="text-[10px] text-slate-400 uppercase tracking-widest">Chief Risk Officer</p>
                    </div>
                </div>

                <!-- Speech Bubble -->
                <div class="bg-slate-800 p-4 rounded-lg border-l-4 border-risk relative">
                    <div class="absolute -top-2 left-6 w-4 h-4 bg-slate-800 transform rotate-45 border-t border-l border-slate-600"></div>
                    <p class="text-sm text-white italic leading-relaxed">
                        "<span x-text="riskSim.currentObjection?.objection"></span>"
                    </p>
                </div>
            </div>

            <!-- Stats -->
            <div class="bg-slate-900 p-4 rounded-xl border border-slate-700">
                <div class="mb-4">
                    <div class="flex justify-between text-xs font-bold mb-1">
                        <span class="text-white">Marcus's Trust</span>
                        <span :class="riskSim.metrics.trust < 30 ? 'text-red-500' : 'text-green-400'" x-text="riskSim.metrics.trust + '%'"></span>
                    </div>
                    <div class="w-full bg-slate-800 h-2 rounded-full overflow-hidden">
                        <div class="h-full transition-all duration-500" 
                             :class="riskSim.metrics.trust < 30 ? 'bg-red-500' : 'bg-green-500'"
                             :style="`width: ${riskSim.metrics.trust}%`"></div>
                    </div>
                </div>
                <div>
                    <div class="flex justify-between text-xs font-bold mb-1">
                        <span class="text-white">Launch Velocity</span>
                        <span class="text-blue-400" x-text="riskSim.metrics.velocity + '%'"></span>
                    </div>
                    <div class="w-full bg-slate-800 h-2 rounded-full overflow-hidden">
                        <div class="bg-blue-500 h-full transition-all duration-500" :style="`width: ${riskSim.metrics.velocity}%`"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- RIGHT: YOUR HAND (The Cards) -->
        <div class="lg:col-span-8">
            <h3 class="font-mono text-xs text-slate-500 uppercase mb-4 text-center">CHOOSE YOUR TACTIC (ROUND <span x-text="riskSim.round + 1"></span>/3)</h3>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <template x-for="card in riskSim.cards" :key="card.id">
                    <button @click="riskSim.playCard(card.id)" 
                            class="group relative bg-slate-800 border border-slate-600 hover:border-white p-6 rounded-xl text-left transition-all hover:-translate-y-1 hover:shadow-xl">
                        
                        <div class="flex justify-between items-start mb-3">
                            <div class="w-10 h-10 rounded-full bg-slate-900 flex items-center justify-center text-lg" :class="card.id === 'speed' ? 'text-red-400' : 'text-blue-400'">
                                <i :class="'fa-solid ' + card.icon"></i>
                            </div>
                            <!-- Math Preview on Hover -->
                            <div class="text-[9px] font-mono opacity-0 group-hover:opacity-100 transition-opacity bg-black/50 px-2 py-1 rounded">
                                <span :class="card.math.trust >= 0 ? 'text-green-400' : 'text-red-400'">Trust <span x-text="card.math.trust > 0 ? '+' : ''"></span><span x-text="card.math.trust"></span></span> | 
                                <span :class="card.math.velocity >= 0 ? 'text-blue-400' : 'text-orange-400'">Vel <span x-text="card.math.velocity > 0 ? '+' : ''"></span><span x-text="card.math.velocity"></span></span>
                            </div>
                        </div>
                        
                        <h4 class="font-bold text-white text-sm mb-1" x-text="card.label"></h4>
                        <p class="text-xs text-slate-400" x-text="card.desc"></p>
                    </button>
                </template>
            </div>

            <!-- Last Action Log -->
            <div class="mt-6 text-center" x-show="riskSim.history.length > 0">
                <p class="text-[10px] text-slate-500 uppercase mb-2">LAST TURN RESULT</p>
                <p class="text-sm text-slate-300 italic">"<span x-text="riskSim.history[riskSim.history.length-1]?.outcome"></span>"</p>
            </div>
        </div>
    </div>

    <!-- 3. GAME OVER / RESULTS -->
    <div x-show="riskSim.outcome" x-transition class="max-w-2xl mx-auto">
        
        <div class="text-center mb-8">
            <div class="inline-block p-6 rounded-full border-4 mb-4 shadow-2xl"
                 :class="riskSim.outcome.status === 'FIRED' ? 'border-red-500 bg-red-500/20 text-red-500' : 'border-green-500 bg-green-500/20 text-green-500'">
                <i class="fa-solid text-5xl" :class="riskSim.outcome.status === 'FIRED' ? 'fa-thumbs-down' : 'fa-handshake'"></i>
            </div>
            <h2 class="text-4xl font-bold text-white mb-2" x-text="riskSim.outcome.status"></h2>
            <p class="text-xl text-slate-300 font-mono mb-2" x-text="riskSim.outcome.archetype"></p>
            <p class="text-sm text-slate-500" x-text="riskSim.outcome.msg"></p>
        </div>

        <!-- AI Prompt Box -->
        <div class="bg-slate-900 border border-risk/30 p-6 rounded-xl relative overflow-hidden group">
            <div class="flex justify-between items-center mb-4 relative z-10">
                <h3 class="font-mono text-white font-bold flex items-center gap-2">
                    <i class="fa-solid fa-robot text-risk"></i> 
                    NEGOTIATION COACH AI
                </h3>
            </div>

            <div class="relative z-10 font-mono text-xs text-slate-300 bg-black/60 p-4 rounded border border-slate-700 mb-4 h-28 overflow-hidden">
                <div class="absolute inset-0 bg-gradient-to-b from-transparent to-black/90 pointer-events-none"></div>
                <pre class="whitespace-pre-wrap font-sans leading-relaxed" x-text="riskSim.generateCoachingPrompt()"></pre>
            </div>

            <button @click="
                    copyToClipboard(riskSim.generateCoachingPrompt(), 'Simulation Logs');
                    $el.innerHTML = '<i class=\'fa-solid fa-check\'></i> COPIED';
                    $el.classList.add('bg-green-500', 'text-white', 'border-green-500');
                    setTimeout(() => {
                        $el.innerHTML = '<i class=\'fa-solid fa-wand-magic-sparkles\'></i> GET COACHING (AI)';
                        $el.classList.remove('bg-green-500', 'text-white', 'border-green-500');
                    }, 2000)
                    " 
                    class="relative z-10 w-full py-4 bg-transparent border border-risk text-risk hover:bg-risk hover:text-dark font-bold rounded-lg transition-all duration-300 flex items-center justify-center gap-2 font-mono text-xs uppercase tracking-widest">
                <i class="fa-solid fa-wand-magic-sparkles"></i> GET COACHING (AI)
            </button>
            
            <!-- NEW CAPTION -->
            <p class="text-center text-[10px] text-slate-500 mt-3 relative z-10">
                Ready to paste into your GenAI tool of choice (ChatGPT, Claude, Gemini).
            </p>
        </div>

        <div class="text-center mt-8">
            <button @click="riskSim.start()" class="text-slate-500 hover:text-white underline text-sm">Play Again</button>
        </div>

    </div>
</div>


        <!-- EXCEL ESCAPE ROOM TAB -->
<div x-show="currentTab === 'escaperoom'" x-cloak class="max-w-4xl mx-auto pb-20">
    
    <div class="text-center mb-8">
        <h2 class="font-mono text-3xl font-bold text-green-400 mb-2 tracking-widest">
            <i class="fa-solid fa-terminal mr-2"></i>EXCEL_FACTORY.EXE
        </h2>
        <p class="text-textMuted text-sm">Gamified Tech Debt Simulation. Survive 3 levels of legacy hell.</p>
    </div>

    <!-- 1. INTRO SCREEN -->
    <div x-show="!excelEscape.active && !excelEscape.outcome" class="flex flex-col items-center justify-center p-10 border-2 border-green-500/30 rounded-xl bg-black/80 text-center relative overflow-hidden min-h-[400px]">
        <div class="absolute inset-0 opacity-10" style="background-image: repeating-linear-gradient(0deg, transparent, transparent 19px, #22c55e 20px);"></div>
        
        <i class="fa-solid fa-ghost text-6xl text-green-500 mb-6 animate-bounce relative z-10"></i>
        <h3 class="text-2xl font-bold text-white mb-2 relative z-10 font-mono">Escape the Spreadsheet</h3>
        <p class="text-slate-400 max-w-md mb-8 relative z-10 text-sm font-mono">
            You have 100 HP (Political Capital). <br>
            Choose wisely: Manual work costs HP. Automation risks failure.
        </p>
        
        <div class="relative z-10 mb-6 w-64">
            <input type="text" x-model="excelEscape.playerName" placeholder="ENTER AGENT NAME..." 
                   class="w-full bg-black border border-green-500 text-green-400 font-mono p-3 rounded focus:outline-none focus:shadow-[0_0_15px_#22c55e] text-center uppercase placeholder-green-900">
        </div>

        <button @click="excelEscape.start()" class="relative z-10 bg-green-600 hover:bg-green-500 text-black font-bold py-3 px-12 rounded shadow-glow transition-all text-lg font-mono">
            > EXECUTE_SIMULATION
        </button>
        
        <!-- View Leaderboard Button -->
        <button @click="excelEscape.fetchLeaderboard(); excelEscape.outcome = { status: 'LEADERBOARD_VIEW' }" 
                class="relative z-10 mt-4 text-xs text-green-500 hover:text-white underline font-mono">
            [VIEW_LEADERBOARD]
        </button>
    </div>

    <!-- 2. GAMEPLAY SCREEN -->
    <div x-show="excelEscape.active && !excelEscape.outcome" class="relative">
        
        <!-- HUD -->
        <div class="flex justify-between items-center mb-6 bg-slate-900 p-4 rounded-lg border border-slate-700 font-mono">
            <div class="flex items-center gap-4">
                <div class="text-left">
                    <p class="text-[10px] text-slate-500 uppercase">Political Capital (HP)</p>
                    <div class="w-32 h-4 bg-slate-800 rounded-sm mt-1 overflow-hidden border border-slate-600">
                        <div class="h-full transition-all duration-500" 
                             :class="excelEscape.hp < 30 ? 'bg-red-500' : 'bg-green-500'"
                             :style="`width: ${excelEscape.hp}%`"></div>
                    </div>
                </div>
                <div class="text-left border-l border-slate-700 pl-4">
                    <p class="text-[10px] text-slate-500 uppercase">Efficiency Score</p>
                    <p class="text-xl text-yellow-400 font-bold" x-text="excelEscape.score"></p>
                </div>
            </div>
            <div class="text-right">
                <span class="bg-green-900/30 text-green-400 border border-green-500/30 px-3 py-1 rounded text-xs">
                    LEVEL <span x-text="excelEscape.level"></span>/3
                </span>
            </div>
        </div>

        <!-- ENCOUNTER CARD -->
        <div class="bg-black border-2 border-slate-600 rounded-xl p-8 mb-6 relative overflow-hidden min-h-[300px] flex flex-col justify-center shadow-2xl">
            <!-- Scanline Effect -->
            <div class="absolute inset-0 pointer-events-none opacity-5 bg-[url('https://media.giphy.com/media/oEI9uBYSzLpBK/giphy.gif')] bg-cover"></div>

            <div class="text-center mb-8 relative z-10">
                <p class="text-xs font-mono text-red-400 mb-2 animate-pulse"> INCIDENT DETECTED</p>
                <h3 class="text-2xl font-bold text-white mb-2 font-mono" x-text="excelEscape.gamePath[excelEscape.level-1]?.enemy"></h3>
                <p class="text-slate-300 text-sm font-mono leading-relaxed max-w-lg mx-auto" x-text="excelEscape.gamePath[excelEscape.level-1]?.desc"></p>
            </div>

            <!-- CHOICES -->
            <div class="grid md:grid-cols-3 gap-4 relative z-10">
                <template x-for="(opt, idx) in excelEscape.gamePath[excelEscape.level-1]?.options" :key="idx">
                    <button @click="excelEscape.makeMove(idx)" 
                            :disabled="excelEscape.loading"
                            class="p-4 border rounded-lg text-left transition-all hover:-translate-y-1 active:scale-95 disabled:opacity-50 group h-full flex flex-col justify-between"
                            :class="opt.type === 'modern' ? 'bg-green-900/10 border-green-500 hover:bg-green-900/30' : (opt.type === 'legacy' ? 'bg-yellow-900/10 border-yellow-500 hover:bg-yellow-900/30' : 'bg-slate-800 border-slate-600 hover:border-white')">
                        
                        <div>
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-[9px] font-mono opacity-70 uppercase tracking-widest" x-text="opt.type"></span>
                                <i class="fa-solid" :class="opt.type === 'modern' ? 'fa-bolt text-green-400' : (opt.type === 'legacy' ? 'fa-wrench text-yellow-400' : 'fa-hand-paper text-slate-400')"></i>
                            </div>
                            <span class="font-bold text-xs text-white leading-tight block mb-2" x-text="opt.label"></span>
                        </div>
                        
                        <div class="text-[9px] font-mono opacity-50 pt-2 border-t border-white/10 group-hover:opacity-100">
                            Risk: <span x-text="opt.risk + '%'"></span> | Cost: <span x-text="opt.cost + ' HP'"></span>
                        </div>
                    </button>
                </template>
            </div>

            <!-- LOADING OVERLAY -->
            <div x-show="excelEscape.loading" class="absolute inset-0 bg-black/90 flex flex-col items-center justify-center z-20">
                <p class="font-mono text-green-400 text-sm animate-pulse">>> EXECUTING COMMAND...</p>
            </div>
        </div>

        <!-- LOG CONSOLE -->
        <div class="bg-black rounded-lg p-3 font-mono text-[10px] h-32 overflow-y-auto border border-green-500/30 shadow-inner flex flex-col-reverse">
            <template x-for="log in excelEscape.logs">
                <div class="mb-1 border-b border-white/5 pb-1 last:border-0">
                    <span class="text-green-500">>></span> <span class="text-slate-300" x-text="log"></span>
                </div>
            </template>
        </div>
    </div>

    <!-- 3. GAME OVER / VICTORY SCREEN -->
    <div x-show="excelEscape.outcome" x-transition class="text-center py-6">
        
        <!-- Status Display (Skipped if just viewing leaderboard) -->
        <div x-show="excelEscape.outcome?.status !== 'LEADERBOARD_VIEW'">
            <div class="inline-block p-6 rounded-full border-4 mb-6 shadow-[0_0_50px_currentColor]"
                 :class="excelEscape.outcome?.status === 'FIRED' ? 'border-red-500 bg-red-900/20 text-red-500' : 'border-green-500 bg-green-900/20 text-green-500'">
                <i class="fa-solid text-6xl" :class="excelEscape.outcome?.status === 'FIRED' ? 'fa-skull' : 'fa-trophy'"></i>
            </div>
            
            <h2 class="text-4xl font-bold text-white mb-2 font-mono tracking-widest" x-text="excelEscape.outcome?.status"></h2>
            <p class="text-xl text-white font-bold mb-1" x-text="excelEscape.outcome?.archetype"></p>
            <p class="text-slate-400 mb-8 text-sm" x-text="excelEscape.outcome?.msg"></p>

            <!-- AI Analysis Box -->
            <div class="bg-slate-900 border border-green-500/30 p-6 rounded-xl relative overflow-hidden group mb-8 text-left">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="font-mono text-white font-bold flex items-center gap-2 text-xs uppercase">
                        <i class="fa-solid fa-user-doctor text-green-500"></i> Career Coach AI
                    </h3>
                </div>
                <div class="relative z-10 font-mono text-xs text-slate-300 bg-black/60 p-4 rounded border border-slate-700 mb-4 h-24 overflow-hidden">
                    <div class="absolute inset-0 bg-gradient-to-b from-transparent to-black/90 pointer-events-none"></div>
                    <pre class="whitespace-pre-wrap font-sans leading-relaxed" x-text="excelEscape.generatePerformancePrompt()"></pre>
                </div>
                <button @click="
                        copyToClipboard(excelEscape.generatePerformancePrompt(), 'Game Stats');
                        $el.innerHTML = '<i class=\'fa-solid fa-check\'></i> COPIED';
                        setTimeout(() => { $el.innerHTML = '<i class=\'fa-solid fa-wand-magic-sparkles\'></i> GET CAREER FEEDBACK (AI)'; }, 2000)
                        " 
                        class="w-full border border-green-500 text-green-400 hover:bg-green-500 hover:text-black py-3 rounded text-xs font-bold transition-all flex items-center justify-center gap-2">
                    <i class="fa-solid fa-wand-magic-sparkles"></i> GET CAREER FEEDBACK (AI)
                </button>
                <p class="text-center text-[10px] text-slate-500 mt-3">
                    Ready to paste into your GenAI tool of choice.
                </p>
            </div>
        </div>

        <!-- Leaderboard Table -->
        <div class="max-w-md mx-auto bg-slate-900 border border-slate-700 rounded-lg overflow-hidden mb-8 text-left">
            <div class="bg-slate-800 p-3 border-b border-slate-700 text-xs font-bold text-white uppercase tracking-widest flex justify-between items-center">
                <span> Top Agents</span>
                <span class="text-[9px] text-slate-400">GLOBAL RANKING</span>
            </div>
            <table class="w-full text-sm">
                <tbody class="divide-y divide-slate-800">
                    <template x-for="(entry, index) in excelEscape.leaderboard" :key="index">
                        <tr class="hover:bg-slate-800/50 transition-colors" 
                            :class="entry.player_name === excelEscape.playerName ? 'bg-green-900/20' : ''">
                            <td class="p-3 font-mono text-slate-500 w-10" x-text="'#' + (index + 1)"></td>
                            <td class="p-3 text-white font-bold truncate max-w-[150px]" x-text="entry.player_name"></td>
                            <td class="p-3 text-right font-mono text-green-400" x-text="entry.score"></td>
                        </tr>
                    </template>
                    <tr x-show="!excelEscape.leaderboard || excelEscape.leaderboard.length === 0">
                        <td colspan="3" class="p-4 text-center text-xs text-slate-500 italic">
                            Loading or No Data...
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <button @click="excelEscape.reset(); excelEscape.start()" class="text-slate-500 hover:text-white underline text-xs">
            Restart Game
        </button>
    </div>

</div>



        <!-- COGNITIVE LOAD CALCULATOR TAB -->
<div x-show="currentTab === 'cognitive'" x-cloak class="max-w-6xl mx-auto pb-20">
    
    <div class="text-center mb-10">
        <h2 class="font-mono text-3xl font-bold text-white mb-2">
            <i class="fa-solid fa-brain mr-2 text-purple-400"></i>Cognitive Load Calculator
        </h2>
        <p class="text-textMuted text-sm">Measure the "Extraneous Load" killing your team's ability to think.</p>
    </div>

    <div class="grid lg:grid-cols-12 gap-8 items-start">
        
        <!-- LEFT: THE STRESSORS (INPUTS) -->
        <div class="lg:col-span-5 bg-card border border-slate-700 p-6 rounded-xl space-y-8">
            <div class="flex justify-between items-center border-b border-slate-700 pb-2">
                <h3 class="font-mono text-xs text-purple-400 uppercase font-bold">Team Inputs</h3>
                <span class="text-[10px] text-slate-500">TEAM SIZE: <span x-text="cognitiveCalc.inputs.teamSize"></span></span>
            </div>

            <!-- 1. Interruptions -->
            <div>
                <div class="flex justify-between mb-2">
                    <label class="text-xs font-mono text-white font-bold"><i class="fa-solid fa-bell mr-2 text-red-400"></i>Interruptions / Day</label>
                    <span class="text-xs font-bold text-white" x-text="cognitiveCalc.inputs.interruptions"></span>
                </div>
                <input type="range" min="0" max="50" x-model="cognitiveCalc.inputs.interruptions" @input="cognitiveCalc.result = null" class="w-full h-2 bg-slate-800 rounded-lg appearance-none cursor-pointer accent-red-500">
                <p class="text-[10px] text-slate-500 mt-2">Slack pings, shoulder taps, urgent emails per person.</p>
            </div>

            <!-- 2. Ambiguity -->
            <div>
                <div class="flex justify-between mb-2">
                    <label class="text-xs font-mono text-white font-bold"><i class="fa-solid fa-cloud-fog mr-2 text-slate-400"></i>Task Ambiguity</label>
                    <span class="text-xs font-bold text-white" x-text="cognitiveCalc.inputs.ambiguity + '/10'"></span>
                </div>
                <input type="range" min="1" max="10" x-model="cognitiveCalc.inputs.ambiguity" @input="cognitiveCalc.result = null" class="w-full h-2 bg-slate-800 rounded-lg appearance-none cursor-pointer accent-slate-400">
                <p class="text-[10px] text-slate-500 mt-2">1 = "Clear Specs", 10 = "Vague one-liners".</p>
            </div>

            <!-- 3. Meetings -->
            <div>
                <div class="flex justify-between mb-2">
                    <label class="text-xs font-mono text-white font-bold"><i class="fa-solid fa-users mr-2 text-yellow-500"></i>Meeting Hours / Week</label>
                    <span class="text-xs font-bold text-white" x-text="cognitiveCalc.inputs.meetings + ' hrs'"></span>
                </div>
                <input type="range" min="0" max="40" x-model="cognitiveCalc.inputs.meetings" @input="cognitiveCalc.result = null" class="w-full h-2 bg-slate-800 rounded-lg appearance-none cursor-pointer accent-yellow-500">
            </div>

            <!-- 4. Tool Frag -->
            <div>
                <div class="flex justify-between mb-2">
                    <label class="text-xs font-mono text-white font-bold"><i class="fa-solid fa-toolbox mr-2 text-blue-400"></i>Tools per Task</label>
                    <span class="text-xs font-bold text-white" x-text="cognitiveCalc.inputs.tools"></span>
                </div>
                <input type="range" min="1" max="20" x-model="cognitiveCalc.inputs.tools" @input="cognitiveCalc.result = null" class="w-full h-2 bg-slate-800 rounded-lg appearance-none cursor-pointer accent-blue-500">
                <p class="text-[10px] text-slate-500 mt-2">How many apps to ship one feature?</p>
            </div>

            <button @click="cognitiveCalc.calculate()" 
                    :disabled="cognitiveCalc.loading"
                    class="w-full py-4 bg-purple-600 hover:bg-purple-500 text-white font-bold rounded-lg shadow-glow transition-all flex items-center justify-center gap-2">
                <span x-show="!cognitiveCalc.loading"><i class="fa-solid fa-calculator"></i> MEASURE LOAD</span>
                <span x-show="cognitiveCalc.loading"><i class="fa-solid fa-circle-notch fa-spin"></i> PROCESSING...</span>
            </button>
        </div>

        <!-- RIGHT: THE BRAIN MONITOR (OUTPUT) -->
        <div class="lg:col-span-7 relative min-h-[500px]">
            
            <!-- Empty State -->
            <div x-show="!cognitiveCalc.result" class="absolute inset-0 flex flex-col items-center justify-center border-2 border-dashed border-slate-700 rounded-xl text-slate-500">
                <i class="fa-solid fa-brain text-6xl mb-4 opacity-20"></i>
                <p class="font-mono text-xs uppercase">Awaiting Team Data</p>
            </div>

            <!-- Results Card -->
            <div x-show="cognitiveCalc.result" x-transition class="bg-card border-2 rounded-xl overflow-hidden shadow-2xl h-full flex flex-col relative"
                 :class="cognitiveCalc.result?.score > 80 ? 'border-red-500' : (cognitiveCalc.result?.score > 50 ? 'border-yellow-500' : 'border-green-500')">
                
                <!-- Monitor Header -->
                <div class="p-6 bg-slate-900 border-b border-slate-800 flex justify-between items-center">
                    <div>
                        <p class="text-[10px] font-mono text-slate-500 uppercase tracking-widest">MENTAL CAPACITY</p>
                        <h3 class="text-3xl font-bold font-mono mt-1" :class="cognitiveCalc.result?.color" x-text="cognitiveCalc.result?.zone"></h3>
                    </div>
                    <div class="w-16 h-16 rounded-full border-4 flex items-center justify-center"
                         :class="cognitiveCalc.result?.score > 80 ? 'border-red-500 bg-red-900/20' : 'border-green-500 bg-green-900/20'">
                        <i class="fa-solid fa-brain text-2xl text-white"></i>
                    </div>
                </div>

                <!-- Metrics Body -->
                <div class="p-6 space-y-6 flex-1">
                    
                    <!-- Load Bar -->
                    <div>
                        <div class="flex justify-between text-xs font-bold mb-2">
                            <span class="text-white">Load Saturation</span>
                            <span :class="cognitiveCalc.result?.color" x-text="cognitiveCalc.result?.score + '%'"></span>
                        </div>
                        <div class="w-full bg-slate-800 h-4 rounded-full overflow-hidden relative">
                            <!-- Markers -->
                            <div class="absolute top-0 bottom-0 left-[50%] w-px bg-slate-600 z-10"></div>
                            <div class="absolute top-0 bottom-0 left-[80%] w-px bg-red-900 z-10"></div>
                            <!-- Bar -->
                            <div class="h-full transition-all duration-1000 ease-out"
                                 :class="cognitiveCalc.result?.score > 80 ? 'bg-red-500' : (cognitiveCalc.result?.score > 50 ? 'bg-yellow-500' : 'bg-green-500')"
                                 :style="`width: ${cognitiveCalc.result?.score}%`"></div>
                        </div>
                        <p class="text-xs text-slate-400 mt-2 italic" x-text="cognitiveCalc.result?.diagnosis"></p>
                    </div>

                    <!-- Financial Impact -->
                    <div class="bg-slate-800/50 p-4 rounded-lg border border-slate-700 flex gap-4 items-center">
                        <div class="bg-slate-700 p-3 rounded-full">
                            <i class="fa-solid fa-money-bill-wave text-green-400 text-xl"></i>
                        </div>
                        <div>
                            <p class="text-[10px] text-slate-500 uppercase font-bold">ANNUAL COGNITIVE TAX</p>
                            <h4 class="text-2xl font-mono text-white font-bold" x-text="'$' + cognitiveCalc.result?.annualTax.toLocaleString()"></h4>
                            <p class="text-[9px] text-slate-500">Wasted salary due to context switching & overhead.</p>
                        </div>
                    </div>

                </div>

                <!-- AI Prompt Box -->
                <div class="p-6 bg-slate-900 border-t border-slate-800">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="font-mono text-white font-bold flex items-center gap-2 text-xs uppercase">
                            <i class="fa-solid fa-robot text-purple-400"></i> Psych Analysis
                        </h3>
                    </div>

                    <div class="relative font-mono text-xs text-slate-300 bg-black/60 p-4 rounded border border-slate-700 mb-4 h-24 overflow-hidden">
                        <div class="absolute inset-0 bg-gradient-to-b from-transparent to-black/90 pointer-events-none"></div>
                        <pre class="whitespace-pre-wrap font-sans leading-relaxed" x-text="cognitiveCalc.generatePsychPrompt()"></pre>
                    </div>

                    <button @click="
                            copyToClipboard(cognitiveCalc.generatePsychPrompt(), 'Team Audit');
                            $el.innerHTML = '<i class=\'fa-solid fa-check\'></i> COPIED';
                            setTimeout(() => { $el.innerHTML = '<i class=\'fa-solid fa-wand-magic-sparkles\'></i> GENERATE DEEP WORK PLAN (AI)'; }, 2000)
                            " 
                            class="w-full border border-purple-500 text-purple-400 hover:bg-purple-500 hover:text-white font-bold py-3 rounded text-xs transition-all flex items-center justify-center gap-2">
                        <i class="fa-solid fa-wand-magic-sparkles"></i> GENERATE DEEP WORK PLAN (AI)
                    </button>
                </div>

            </div>
        </div>

    </div>
</div>



        <!-- BILINGUAL BINGO TAB -->
<div x-show="currentTab === 'bingo'" x-cloak class="max-w-4xl mx-auto pb-20">
    
    <div class="text-center mb-8">
        <h2 class="font-mono text-3xl font-bold text-white mb-2">
            <i class="fa-solid fa-table-cells mr-2 text-pink-500"></i>Bilingual Bingo
        </h2>
        <p class="text-textMuted text-sm">Gamify your next meeting. Click tiles when you hear/see the behavior.</p>
    </div>

    <!-- START SCREEN -->
    <div x-show="!bingoGame.active" class="flex flex-col items-center justify-center p-12 bg-card border-2 border-slate-700 border-dashed rounded-xl text-center">
        <i class="fa-solid fa-users-viewfinder text-6xl text-slate-600 mb-6"></i>
        <h3 class="text-xl font-bold text-white mb-2">Ready to Observe?</h3>
        <p class="text-slate-400 max-w-md mb-8">This generates a random 5x5 grid of "Bilingual" (Good) and "Legacy" (Bad) behaviors. Play during the meeting.</p>
        <button @click="bingoGame.startNewGame()" class="bg-pink-600 hover:bg-pink-500 text-white font-bold py-3 px-10 rounded-full shadow-glow transition-all">
            GENERATE BOARD
        </button>
    </div>

    <!-- GAME BOARD -->
    <div x-show="bingoGame.active" class="flex flex-col h-full">
        
        <!-- Scoreboard -->
        <div class="flex justify-between items-center mb-6 bg-slate-900 p-4 rounded-xl border border-slate-700">
            <div class="flex gap-6">
                <div>
                    <p class="text-[10px] text-slate-500 uppercase tracking-widest">CULTURE SCORE</p>
                    <h3 class="text-2xl font-mono font-bold" :class="bingoGame.metrics.score > 0 ? 'text-green-400' : 'text-red-400'">
                        <span x-show="bingoGame.metrics.score > 0">+</span><span x-text="bingoGame.metrics.score"></span>
                    </h3>
                </div>
                <div>
                    <p class="text-[10px] text-slate-500 uppercase tracking-widest">TOXICITY</p>
                    <h3 class="text-2xl font-mono font-bold" :class="bingoGame.metrics.toxicity > 50 ? 'text-red-500' : 'text-slate-300'">
                        <span x-text="bingoGame.metrics.toxicity"></span>%
                    </h3>
                </div>
            </div>
            
            <div class="text-right">
                <span class="px-4 py-2 rounded-lg font-bold text-sm border transition-all duration-500"
                      :class="bingoGame.metrics.status === 'BINGO!' ? 'bg-pink-600 text-white border-pink-400 animate-pulse' : 'bg-slate-800 text-slate-400 border-slate-600'">
                    <span x-text="bingoGame.metrics.status"></span>
                </span>
            </div>
        </div>

        <!-- The Grid -->
        <div class="grid grid-cols-5 gap-2 md:gap-3 aspect-square max-w-2xl mx-auto w-full">
            <template x-for="(tile, index) in bingoGame.board" :key="tile.id">
                <button @click="bingoGame.toggleTile(index)" 
                        class="relative p-2 md:p-4 rounded-lg border-2 flex items-center justify-center text-center transition-all duration-200 hover:scale-105 active:scale-95"
                        :class="
                            tile.id === 12 ? 'bg-pink-900/50 border-pink-500 text-pink-300' : 
                            (tile.selected ? 
                                (tile.type === 'good' ? 'bg-green-600 border-green-400 text-white' : 'bg-red-600 border-red-400 text-white') 
                                : 'bg-slate-800 border-slate-700 text-slate-400 hover:border-slate-500 hover:text-slate-200')
                        ">
                    
                    <!-- Icon Indicator -->
                    <div x-show="tile.selected && tile.id !== 12" class="absolute top-1 right-1 text-[10px]">
                        <i class="fa-solid" :class="tile.type === 'good' ? 'fa-check' : 'fa-triangle-exclamation'"></i>
                    </div>

                    <span class="text-[9px] md:text-xs font-bold leading-tight select-none" x-text="tile.text"></span>
                </button>
            </template>
        </div>

<!-- Footer Actions -->
        <div class="mt-8 grid md:grid-cols-2 gap-4">
            
            <!-- Reset -->
            <button @click="bingoGame.startNewGame()" class="border border-slate-600 text-slate-400 hover:text-white py-3 rounded-lg text-xs font-bold transition-all">
                <i class="fa-solid fa-rotate-right mr-2"></i> NEW GAME
            </button>

            <!-- AI Analysis -->
            <div class="relative group">
                <div class="absolute -inset-0.5 bg-gradient-to-r from-pink-600 to-purple-600 rounded-lg blur opacity-50 group-hover:opacity-100 transition duration-1000 group-hover:duration-200"></div>
                <button @click="
                        copyToClipboard(bingoGame.generateCulturePrompt(), 'Bingo Stats');
                        $el.innerHTML = '<i class=\'fa-solid fa-check\'></i> COPIED';
                        setTimeout(() => { $el.innerHTML = '<i class=\'fa-solid fa-robot mr-2\'></i> ANALYZE CULTURE (AI)'; }, 2000)
                        " 
                        class="relative w-full bg-dark text-white border border-slate-600 hover:border-white py-3 rounded-lg text-xs font-bold transition-all flex items-center justify-center">
                    <i class="fa-solid fa-robot mr-2"></i> ANALYZE CULTURE (AI)
                </button>
            </div>
        </div>

        <!-- NEW CAPTION -->
        <p class="text-center text-[10px] text-slate-500 mt-4">
            Ready to paste into your GenAI tool of choice. Uses Anthropological Analysis to diagnose rituals.
        </p>
        
    </div>
</div>

        
        <!-- SPRINT HEALTH CHECK TAB -->
<div x-show="currentTab === 'sprintcheck'" x-cloak class="max-w-6xl mx-auto pb-20">
    
    <div class="text-center mb-10">
        <h2 class="font-mono text-3xl font-bold text-white mb-2">
            <i class="fa-solid fa-stopwatch mr-2 text-orange-400"></i>Sprint Health Check
        </h2>
        <p class="text-textMuted text-sm">60-second diagnostic. Is your sprint a "Success" or a "Death March"?</p>
    </div>

    <div class="grid lg:grid-cols-12 gap-8 items-start">
        
        <!-- LEFT: VITAL SIGNS (INPUTS) -->
        <div class="lg:col-span-5 bg-card border border-slate-700 p-6 rounded-xl space-y-6">
            <h3 class="font-mono text-xs text-orange-400 uppercase font-bold border-b border-slate-700 pb-2">Sprint Vitals</h3>

            <!-- Day & Points -->
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="text-[10px] text-slate-500 uppercase font-bold">Current Day (1-10)</label>
                    <input type="number" x-model="sprintHealth.inputs.day" class="w-full bg-dark border border-slate-600 rounded p-2 text-white font-mono">
                </div>
                <div>
                    <label class="text-[10px] text-slate-500 uppercase font-bold">Planned Points</label>
                    <input type="number" x-model="sprintHealth.inputs.plannedPts" class="w-full bg-dark border border-slate-600 rounded p-2 text-white font-mono">
                </div>
            </div>

            <!-- Progress & Creep -->
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="text-[10px] text-green-400 uppercase font-bold">Completed Points</label>
                    <input type="number" x-model="sprintHealth.inputs.completedPts" class="w-full bg-dark border border-green-500/50 rounded p-2 text-white font-mono">
                </div>
                <div>
                    <label class="text-[10px] text-red-400 uppercase font-bold">Added Points (Creep)</label>
                    <input type="number" x-model="sprintHealth.inputs.addedPts" class="w-full bg-dark border border-red-500/50 rounded p-2 text-white font-mono">
                </div>
            </div>

            <!-- Sliders -->
            <div>
                <div class="flex justify-between mb-2">
                    <label class="text-xs font-mono text-white font-bold"><i class="fa-solid fa-face-smile mr-2 text-yellow-400"></i>Team Morale</label>
                    <span class="text-xs font-bold text-white" x-text="sprintHealth.inputs.mood + '/10'"></span>
                </div>
                <input type="range" min="1" max="10" x-model="sprintHealth.inputs.mood" @input="sprintHealth.analysis = null" class="w-full h-2 bg-slate-800 rounded-lg appearance-none cursor-pointer accent-yellow-400">
            </div>

            <div>
                <label class="block text-xs font-mono text-white font-bold mb-2">Blocker Status</label>
                <div class="grid grid-cols-3 gap-2">
                    <button @click="sprintHealth.inputs.blockers = 0; sprintHealth.analysis = null" :class="sprintHealth.inputs.blockers === 0 ? 'bg-green-500 text-dark font-bold' : 'bg-slate-800 text-slate-400'" class="p-2 rounded border border-slate-600 text-[10px] transition-all">Clear</button>
                    <button @click="sprintHealth.inputs.blockers = 1; sprintHealth.analysis = null" :class="sprintHealth.inputs.blockers === 1 ? 'bg-orange-500 text-white font-bold' : 'bg-slate-800 text-slate-400'" class="p-2 rounded border border-slate-600 text-[10px] transition-all">Sticky</button>
                    <button @click="sprintHealth.inputs.blockers = 2; sprintHealth.analysis = null" :class="sprintHealth.inputs.blockers === 2 ? 'bg-red-600 text-white font-bold' : 'bg-slate-800 text-slate-400'" class="p-2 rounded border border-slate-600 text-[10px] transition-all">Critical</button>
                </div>
            </div>

            <button @click="sprintHealth.calculate()" 
                    :disabled="sprintHealth.loading"
                    class="w-full py-4 bg-orange-500 hover:bg-orange-400 text-white font-bold rounded-lg shadow-glow transition-all flex items-center justify-center gap-2">
                <span x-show="!sprintHealth.loading"><i class="fa-solid fa-stethoscope"></i> RUN DIAGNOSTIC</span>
                <span x-show="sprintHealth.loading"><i class="fa-solid fa-circle-notch fa-spin"></i> ANALYZING...</span>
            </button>
        </div>

        <!-- RIGHT: THE MONITOR (OUTPUT) -->
        <div class="lg:col-span-7 relative min-h-[500px]">
            
            <!-- Empty State -->
            <div x-show="!sprintHealth.analysis" class="absolute inset-0 flex flex-col items-center justify-center border-2 border-dashed border-slate-700 rounded-xl text-slate-500">
                <i class="fa-solid fa-heart-pulse text-6xl mb-4 opacity-20"></i>
                <p class="font-mono text-xs uppercase">Awaiting Vitals</p>
            </div>

            <!-- Results Card -->
            <div x-show="sprintHealth.analysis" x-transition class="bg-card border-2 rounded-xl overflow-hidden shadow-2xl h-full flex flex-col relative"
                 :class="sprintHealth.analysis?.score < 40 ? 'border-red-500' : (sprintHealth.analysis?.score < 70 ? 'border-orange-500' : 'border-green-500')">
                
                <!-- Monitor Header -->
                <div class="p-6 bg-slate-900 border-b border-slate-800 flex justify-between items-center">
                    <div>
                        <p class="text-[10px] font-mono text-slate-500 uppercase tracking-widest">SUCCESS PROBABILITY</p>
                        <h3 class="text-4xl font-bold font-mono mt-1" :class="sprintHealth.analysis?.color" x-text="sprintHealth.analysis?.score + '%'"></h3>
                    </div>
                    <div class="text-right">
                        <span class="text-xs font-bold px-3 py-1 rounded bg-slate-800 border" :class="sprintHealth.analysis?.color" x-text="sprintHealth.analysis?.weather.toUpperCase()"></span>
                    </div>
                </div>

                <!-- Metrics Grid -->
                <div class="p-6 space-y-6 flex-1">
                    
                    <!-- Trend Bar -->
                    <div>
                        <div class="flex justify-between text-xs font-bold mb-2">
                            <span class="text-slate-400">Completion vs Time</span>
                            <span :class="sprintHealth.analysis?.drift < 0 ? 'text-red-400' : 'text-green-400'" x-text="sprintHealth.analysis?.drift + '% Drift'"></span>
                        </div>
                        <div class="w-full bg-slate-800 h-4 rounded-full overflow-hidden relative">
                            <!-- Ideal Marker -->
                            <div class="absolute top-0 bottom-0 w-1 bg-white z-10 opacity-50" :style="`left: ${(sprintHealth.inputs.day * 10)}%`" title="Today"></div>
                            <!-- Actual Bar -->
                            <div class="h-full transition-all duration-1000 ease-out"
                                 :class="sprintHealth.analysis?.drift < -10 ? 'bg-red-500' : 'bg-green-500'"
                                 :style="`width: ${sprintHealth.analysis?.completionRate}%`"></div>
                        </div>
                    </div>

                    <!-- Warning Flags -->
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-slate-800/50 p-4 rounded-lg border border-slate-700" :class="sprintHealth.analysis?.creep > 10 ? 'border-red-500/50' : ''">
                            <p class="text-[10px] text-slate-500 uppercase font-bold">SCOPE CREEP</p>
                            <h4 class="text-xl font-mono font-bold" :class="sprintHealth.analysis?.creep > 10 ? 'text-red-400' : 'text-slate-300'" x-text="sprintHealth.analysis?.creep + '%'"></h4>
                        </div>
                        <div class="bg-slate-800/50 p-4 rounded-lg border border-slate-700">
                            <p class="text-[10px] text-slate-500 uppercase font-bold">PRESCRIPTION</p>
                            <p class="text-xs text-white leading-tight mt-1" x-text="sprintHealth.analysis?.prescription"></p>
                        </div>
                    </div>

                </div>

                <!-- AI Prompt Box -->
                <div class="p-6 bg-slate-900 border-t border-slate-800">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="font-mono text-white font-bold flex items-center gap-2 text-xs uppercase">
                            <i class="fa-solid fa-robot text-orange-400"></i> Scrum Master AI
                        </h3>
                    </div>

                    <div class="relative font-mono text-xs text-slate-300 bg-black/60 p-4 rounded border border-slate-700 mb-4 h-24 overflow-hidden">
                        <div class="absolute inset-0 bg-gradient-to-b from-transparent to-black/90 pointer-events-none"></div>
                        <pre class="whitespace-pre-wrap font-sans leading-relaxed" x-text="sprintHealth.generateStandupPrompt()"></pre>
                    </div>

                    <button @click="
                            copyToClipboard(sprintHealth.generateStandupPrompt(), 'Standup Script');
                            $el.innerHTML = '<i class=\'fa-solid fa-check\'></i> COPIED';
                            setTimeout(() => { $el.innerHTML = '<i class=\'fa-solid fa-wand-magic-sparkles\'></i> GENERATE RESCUE SCRIPT (AI)'; }, 2000)
                            " 
                            class="w-full border border-orange-500 text-orange-400 hover:bg-orange-500 hover:text-white font-bold py-3 rounded text-xs transition-all flex items-center justify-center gap-2">
                        <i class="fa-solid fa-wand-magic-sparkles"></i> GENERATE RESCUE SCRIPT (AI)
                    </button>
                    
                    <p class="text-center text-[10px] text-slate-500 mt-3">
                        Ready to paste into your GenAI tool of choice.
                    </p>
                </div>

            </div>
        </div>

    </div>
</div>
        



<!-- ADAPTABILITY MONITOR TAB -->
<div x-show="currentTab === 'adaptation'" x-cloak class="max-w-6xl mx-auto pb-20">
    
    <div class="text-center mb-10">
        <h2 class="font-mono text-3xl font-bold text-white mb-2">
            <i class="fa-solid fa-dna mr-2 text-cyan-400"></i>Adaptability Health Monitor
        </h2>
        <p class="text-textMuted text-sm">Survival of the fittest? No. Survival of the most adaptable.</p>
    </div>

    <div class="grid lg:grid-cols-12 gap-8 items-start">
        
        <!-- LEFT: SENSORS (INPUTS) -->
        <div class="lg:col-span-5 bg-card border border-slate-700 p-6 rounded-xl space-y-6">
            <h3 class="font-mono text-xs text-cyan-400 uppercase font-bold border-b border-slate-700 pb-2">Organizational Sensors</h3>

            <template x-for="dim in adaptMonitor.dimensions" :key="dim.id">
                <div>
                    <div class="flex justify-between mb-2">
                        <label class="text-xs font-mono text-white font-bold" x-text="dim.label"></label>
                        <span class="text-xs font-bold" :class="dim.val < 4 ? 'text-red-400' : 'text-cyan-400'" x-text="dim.val + '/10'"></span>
                    </div>
                    <input type="range" min="1" max="10" x-model.number="dim.val" @input="adaptMonitor.result = null" 
                           class="w-full h-2 bg-slate-800 rounded-lg appearance-none cursor-pointer accent-cyan-400">
                    <p class="text-[10px] text-slate-500 mt-1" x-text="dim.desc"></p>
                </div>
            </template>

            <button @click="adaptMonitor.calculate()" 
                    :disabled="adaptMonitor.loading"
                    class="w-full py-4 bg-cyan-600 hover:bg-cyan-500 text-dark font-bold rounded-lg shadow-glow transition-all flex items-center justify-center gap-2">
                <span x-show="!adaptMonitor.loading"><i class="fa-solid fa-microscope"></i> CALCULATE AQ</span>
                <span x-show="adaptMonitor.loading"><i class="fa-solid fa-circle-notch fa-spin"></i> SEQUENCING DNA...</span>
            </button>
        </div>

        <!-- RIGHT: THE RADAR (OUTPUT) -->
        <div class="lg:col-span-7 relative min-h-[500px]">
            
            <!-- Empty State -->
            <div x-show="!adaptMonitor.result" class="absolute inset-0 flex flex-col items-center justify-center border-2 border-dashed border-slate-700 rounded-xl text-slate-500">
                <i class="fa-solid fa-chart-radar text-6xl mb-4 opacity-20"></i>
                <p class="font-mono text-xs uppercase">Awaiting Sensor Data</p>
            </div>

            <!-- Results Card -->
            <div x-show="adaptMonitor.result" x-transition class="bg-card border-2 rounded-xl overflow-hidden shadow-2xl h-full flex flex-col relative"
                 :class="adaptMonitor.result?.aq > 70 ? 'border-cyan-500' : 'border-slate-600'">
                
                <!-- Monitor Header -->
                <div class="p-6 bg-slate-900 border-b border-slate-800 flex justify-between items-center">
                    <div>
                        <p class="text-[10px] font-mono text-slate-500 uppercase tracking-widest">ADAPTABILITY QUOTIENT (AQ)</p>
                        <h3 class="text-4xl font-bold font-mono mt-1" :class="adaptMonitor.result?.color" x-text="adaptMonitor.result?.aq"></h3>
                    </div>
                    <div class="text-right">
                        <span class="text-xs font-bold px-3 py-1 rounded bg-slate-800 border" :class="adaptMonitor.result?.color" x-text="adaptMonitor.result?.archetype.toUpperCase()"></span>
                        <p class="text-[9px] text-slate-500 mt-1">ORGANIC STATE</p>
                    </div>
                </div>

                <!-- Alert Console -->
                <div x-show="adaptMonitor.result?.penalty" class="bg-red-900/20 border-b border-red-500/30 p-2 text-center animate-pulse">
                    <p class="text-[10px] text-red-400 font-mono font-bold">
                        <i class="fa-solid fa-triangle-exclamation mr-2"></i><span x-text="adaptMonitor.result?.penalty"></span>
                    </p>
                </div>

                <!-- Chart Area -->
                <div class="p-4 flex-1 flex items-center justify-center bg-dark/50">
                    <div class="w-full max-w-sm h-64">
                        <canvas id="adaptChart"></canvas>
                    </div>
                </div>

                <!-- Analysis Footer -->
                <div class="p-6 bg-slate-900 border-t border-slate-800 space-y-4">
                    <div class="flex items-start gap-3">
                        <div class="bg-slate-800 p-2 rounded text-cyan-400"><i class="fa-solid fa-user-doctor"></i></div>
                        <div>
                            <p class="text-[10px] text-slate-500 uppercase font-bold">DIAGNOSIS</p>
                            <p class="text-xs text-white leading-relaxed" x-text="adaptMonitor.result?.advice"></p>
                        </div>
                    </div>

                    <!-- AI Prompt Button -->
                    <div class="border-t border-slate-800 pt-4">
                        <div class="bg-black/50 p-3 rounded text-[10px] text-slate-400 font-mono mb-3 h-16 overflow-hidden relative">
                            <div class="absolute inset-0 bg-gradient-to-b from-transparent to-black/80 pointer-events-none"></div>
                            <span x-text="adaptMonitor.generateChangePrompt()"></span>
                        </div>

                        <button @click="
                                copyToClipboard(adaptMonitor.generateChangePrompt(), 'Health Report');
                                $el.innerHTML = '<i class=\'fa-solid fa-check\'></i> COPIED';
                                setTimeout(() => { $el.innerHTML = '<i class=\'fa-solid fa-wand-magic-sparkles\'></i> GENERATE INTERVENTION PLAN (AI)'; }, 2000)
                                " 
                                class="w-full border border-cyan-500 text-cyan-400 hover:bg-cyan-500 hover:text-dark font-bold py-3 rounded text-xs transition-all flex items-center justify-center gap-2">
                            <i class="fa-solid fa-wand-magic-sparkles"></i> GENERATE INTERVENTION PLAN (AI)
                        </button>
                        <p class="text-center text-[10px] text-slate-500 mt-2">
                            Ready to paste into your GenAI tool of choice.
                        </p>
                    </div>
                </div>

            </div>
        </div>

    </div>
</div>


        
<!-- REGULATORY IMPACT SIMULATOR TAB -->
<div x-show="currentTab === 'regsim'" x-cloak class="max-w-6xl mx-auto pb-20">
    
    <div class="text-center mb-10">
        <h2 class="font-mono text-3xl font-bold text-white mb-2">
            <i class="fa-solid fa-gavel mr-2 text-yellow-500"></i>Regulatory Impact Simulator
        </h2>
        <p class="text-textMuted text-sm">Visualize the "Blast Radius" of incoming regulations on your legacy stack.</p>
    </div>

    <div class="grid lg:grid-cols-12 gap-8 items-start">
        
        <!-- LEFT: CONFIGURATION -->
        <div class="lg:col-span-4 bg-card border border-slate-700 p-6 rounded-xl space-y-6">
            <h3 class="font-mono text-xs text-yellow-500 uppercase font-bold border-b border-slate-700 pb-2">1. Select Threat</h3>
            
            <div class="grid grid-cols-2 gap-2">
                <template x-for="reg in regSimulator.regulations" :key="reg.id">
                    <button @click="regSimulator.selectedReg = reg; regSimulator.analysis = null" 
                            class="p-3 rounded border text-left transition-all"
                            :class="regSimulator.selectedReg?.id === reg.id ? 'bg-yellow-500 text-black border-yellow-500' : 'bg-slate-800 text-slate-400 border-slate-600 hover:border-yellow-500'">
                        <span class="block font-bold text-xs" x-text="reg.name"></span>
                        <span class="block text-[9px] opacity-70" x-text="reg.focus"></span>
                    </button>
                </template>
            </div>

            <div x-show="regSimulator.selectedReg" x-transition>
                <div class="bg-slate-800/50 p-3 rounded border border-slate-700 mb-6">
                    <p class="text-xs text-slate-300 italic" x-text="regSimulator.selectedReg.desc"></p>
                </div>

                <h3 class="font-mono text-xs text-yellow-500 uppercase font-bold border-b border-slate-700 pb-2 mb-4">2. Org Context</h3>
                
                <div class="space-y-4">
                    <div>
                        <div class="flex justify-between mb-1">
                            <label class="text-[10px] text-slate-400 uppercase">Legacy Debt</label>
                            <span class="text-[10px] font-bold text-white" x-text="regSimulator.inputs.legacyScore + '%'"></span>
                        </div>
                        <input type="range" x-model="regSimulator.inputs.legacyScore" class="w-full h-1 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-red-500">
                    </div>
                    <div>
                        <div class="flex justify-between mb-1">
                            <label class="text-[10px] text-slate-400 uppercase">Data Governance</label>
                            <span class="text-[10px] font-bold text-white" x-text="regSimulator.inputs.dataGovernance + '%'"></span>
                        </div>
                        <input type="range" x-model="regSimulator.inputs.dataGovernance" class="w-full h-1 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-blue-500">
                    </div>
                </div>

                <button @click="regSimulator.simulate()" 
                        :disabled="regSimulator.loading"
                        class="w-full mt-6 py-4 bg-yellow-600 hover:bg-yellow-500 text-black font-bold rounded-lg shadow-glow transition-all flex items-center justify-center gap-2">
                    <span x-show="!regSimulator.loading"><i class="fa-solid fa-burst"></i> SIMULATE IMPACT</span>
                    <span x-show="regSimulator.loading"><i class="fa-solid fa-circle-notch fa-spin"></i> CALCULATING...</span>
                </button>
            </div>
        </div>

        <!-- RIGHT: THE BLAST RADIUS (OUTPUT) -->
        <div class="lg:col-span-8 relative min-h-[500px]">
            
            <!-- Empty State -->
            <div x-show="!regSimulator.analysis" class="absolute inset-0 flex flex-col items-center justify-center border-2 border-dashed border-slate-700 rounded-xl text-slate-500">
                <i class="fa-solid fa-scale-unbalanced-flip text-6xl mb-4 opacity-20"></i>
                <p class="font-mono text-xs uppercase">Select Regulation to Begin</p>
            </div>

            <!-- Results Card -->
            <div x-show="regSimulator.analysis" x-transition class="h-full flex flex-col gap-6">
                
                <!-- 1. The Bill -->
                <div class="grid grid-cols-3 gap-4">
                    <div class="bg-card border border-slate-700 p-4 rounded-xl text-center">
                        <p class="text-[10px] text-slate-500 uppercase tracking-widest">EST. IMPLEMENTATION COST</p>
                        <h3 class="text-2xl font-mono font-bold text-white mt-1" x-text="'$' + (regSimulator.analysis?.cost / 1000000).toFixed(1) + 'M'"></h3>
                    </div>
                    <div class="bg-card border border-slate-700 p-4 rounded-xl text-center">
                        <p class="text-[10px] text-slate-500 uppercase tracking-widest">TIMELINE</p>
                        <h3 class="text-2xl font-mono font-bold text-yellow-400 mt-1" x-text="regSimulator.analysis?.timeline + ' Months'"></h3>
                    </div>
                    <div class="bg-card border border-slate-700 p-4 rounded-xl text-center relative overflow-hidden">
                        <div class="absolute inset-0 bg-red-900/20 animate-pulse"></div>
                        <p class="text-[10px] text-red-400 uppercase tracking-widest relative z-10">MAX FINE EXPOSURE</p>
                        <h3 class="text-2xl font-mono font-bold text-red-500 mt-1 relative z-10" x-text="'$' + (regSimulator.analysis?.exposure / 1000000).toFixed(1) + 'M'"></h3>
                    </div>
                </div>

                <!-- 2. The Blast Radius (Heatmap) -->
                <div class="bg-card border border-slate-700 p-6 rounded-xl flex-1">
                    <h3 class="font-mono text-xs text-white uppercase mb-4 font-bold flex justify-between">
                        <span>System Impact Heatmap</span>
                        <span class="text-red-400" x-text="regSimulator.analysis?.complexity"></span>
                    </h3>
                    
                    <div class="space-y-4">
                        <template x-for="sys in regSimulator.analysis?.systems">
                            <div>
                                <div class="flex justify-between text-xs mb-1">
                                    <span class="text-slate-300 font-bold" x-text="sys.name"></span>
                                    <span class="font-mono" :class="sys.heat > 70 ? 'text-red-500' : (sys.heat > 40 ? 'text-yellow-500' : 'text-green-500')" x-text="Math.round(sys.heat) + '% Impact'"></span>
                                </div>
                                <div class="w-full bg-slate-800 h-3 rounded-full overflow-hidden">
                                    <div class="h-full transition-all duration-1000"
                                         :class="sys.heat > 70 ? 'bg-red-600' : (sys.heat > 40 ? 'bg-yellow-500' : 'bg-green-500')"
                                         :style="`width: ${Math.min(100, sys.heat)}%`"></div>
                                </div>
                            </div>
                        </template>
                    </div>
                    
                    <div class="mt-6 p-4 bg-slate-800/50 rounded-lg border-l-4 border-yellow-500">
                        <p class="text-xs text-slate-300 italic">
                            "Because of your <strong>High Legacy Debt</strong>, the cost of implementing <span x-text="regSimulator.selectedReg?.name"></span> is <strong class="text-white">2.5x higher</strong> than a Neobank."
                        </p>
                    </div>
                </div>

                <!-- 3. AI Prompt Box -->
                <div class="bg-slate-900 border border-yellow-500/30 p-6 rounded-xl relative overflow-hidden">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="font-mono text-white font-bold flex items-center gap-2 text-xs uppercase">
                            <i class="fa-solid fa-robot text-yellow-500"></i> Compliance Architect AI
                        </h3>
                    </div>

                    <div class="relative font-mono text-xs text-slate-300 bg-black/60 p-4 rounded border border-slate-700 mb-4 h-24 overflow-hidden">
                        <div class="absolute inset-0 bg-gradient-to-b from-transparent to-black/90 pointer-events-none"></div>
                        <pre class="whitespace-pre-wrap font-sans leading-relaxed" x-text="regSimulator.generateCompliancePrompt()"></pre>
                    </div>

                    <button @click="
                            copyToClipboard(regSimulator.generateCompliancePrompt(), 'Roadmap Data');
                            $el.innerHTML = '<i class=\'fa-solid fa-check\'></i> COPIED';
                            setTimeout(() => { $el.innerHTML = '<i class=\'fa-solid fa-wand-magic-sparkles\'></i> GENERATE COMPLIANCE ROADMAP (AI)'; }, 2000)
                            " 
                            class="w-full border border-yellow-500 text-yellow-400 hover:bg-yellow-500 hover:text-black font-bold py-3 rounded text-xs transition-all flex items-center justify-center gap-2">
                        <i class="fa-solid fa-wand-magic-sparkles"></i> GENERATE COMPLIANCE ROADMAP (AI)
                    </button>
                    
                    <p class="text-center text-[10px] text-slate-500 mt-2">
                        Ready to paste into your GenAI tool of choice.
                    </p>
                </div>

            </div>
        </div>

    </div>
</div>


        <!-- VALUE STREAM CALCULATOR TAB -->
<div x-show="currentTab === 'flow'" x-cloak class="max-w-6xl mx-auto pb-20">
    
    <div class="text-center mb-10">
        <h2 class="font-mono text-3xl font-bold text-white mb-2">
            <i class="fa-solid fa-water mr-2 text-blue-400"></i>Flow Efficiency Calculator
        </h2>
        <p class="text-textMuted text-sm">Most processes are 90% waiting. Find the hidden waste.</p>
    </div>

    <div class="grid lg:grid-cols-12 gap-8 items-start">
        
        <!-- LEFT: MAPPER (INPUTS) -->
        <div class="lg:col-span-5 bg-card border border-slate-700 p-6 rounded-xl space-y-6">
            <div class="flex justify-between items-center border-b border-slate-700 pb-2">
                <h3 class="font-mono text-xs text-blue-400 uppercase font-bold">Process Map</h3>
                <select x-model="flowCalc.unit" class="bg-dark border border-slate-600 rounded text-[10px] text-white px-2 py-1">
                    <option value="minutes">Minutes</option>
                    <option value="hours">Hours</option>
                    <option value="days">Days</option>
                </select>
            </div>

            <div>
                <label class="text-[10px] text-slate-500 uppercase">Process Name</label>
                <input type="text" x-model="flowCalc.processName" class="w-full bg-dark border border-slate-600 rounded p-2 text-white text-sm focus:border-blue-500 outline-none">
            </div>

            <!-- Steps List -->
            <div class="space-y-3 max-h-[400px] overflow-y-auto pr-2">
                <template x-for="(step, index) in flowCalc.steps" :key="step.id">
                    <div class="bg-slate-800 p-3 rounded border border-slate-600 relative group">
                        <button @click="flowCalc.removeStep(step.id)" class="absolute top-2 right-2 text-slate-500 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity"><i class="fa-solid fa-xmark"></i></button>
                        
                        <div class="flex items-center gap-2 mb-2">
                            <span class="bg-slate-700 text-slate-300 w-5 h-5 flex items-center justify-center rounded-full text-[10px] font-bold" x-text="index + 1"></span>
                            <input type="text" x-model="step.name" class="bg-transparent text-white text-sm font-bold w-full focus:outline-none" placeholder="Step Name">
                        </div>

                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="text-[9px] text-green-400 uppercase font-bold block mb-1">Work Time (Value)</label>
                                <input type="number" x-model="step.work" class="w-full bg-dark border border-green-900 rounded p-1 text-white text-xs">
                            </div>
                            <div>
                                <label class="text-[9px] text-red-400 uppercase font-bold block mb-1">Wait Time (Waste)</label>
                                <input type="number" x-model="step.wait" class="w-full bg-dark border border-red-900 rounded p-1 text-white text-xs">
                            </div>
                        </div>
                    </div>
                </template>
            </div>

            <div class="flex gap-3">
                <button @click="flowCalc.addStep()" class="flex-1 border border-slate-600 text-slate-400 hover:text-white py-2 rounded-lg text-xs font-bold transition-all">
                    + ADD STEP
                </button>
                <button @click="flowCalc.calculate()" 
                        class="flex-1 bg-blue-600 hover:bg-blue-500 text-white font-bold py-2 rounded-lg shadow-glow transition-all flex items-center justify-center gap-2">
                    <span x-show="!flowCalc.loading"><i class="fa-solid fa-calculator"></i> CALCULATE FLOW</span>
                    <span x-show="flowCalc.loading"><i class="fa-solid fa-circle-notch fa-spin"></i> MAPPING...</span>
                </button>
            </div>
        </div>

        <!-- RIGHT: VISUALIZER (OUTPUT) -->
        <div class="lg:col-span-7 relative min-h-[500px]">
            
            <!-- Empty State -->
            <div x-show="!flowCalc.metrics" class="absolute inset-0 flex flex-col items-center justify-center border-2 border-dashed border-slate-700 rounded-xl text-slate-500">
                <i class="fa-solid fa-stopwatch text-6xl mb-4 opacity-20"></i>
                <p class="font-mono text-xs uppercase">Map your Value Stream</p>
            </div>

            <!-- Results Card -->
            <div x-show="flowCalc.metrics" x-transition class="bg-card border-2 rounded-xl overflow-hidden shadow-2xl h-full flex flex-col relative"
                 :class="flowCalc.metrics?.efficiency < 15 ? 'border-red-500' : (flowCalc.metrics?.efficiency < 40 ? 'border-yellow-500' : 'border-green-500')">
                
                <!-- Monitor Header -->
                <div class="p-6 bg-slate-900 border-b border-slate-800 flex justify-between items-center">
                    <div>
                        <p class="text-[10px] font-mono text-slate-500 uppercase tracking-widest">FLOW EFFICIENCY SCORE</p>
                        <h3 class="text-4xl font-bold font-mono mt-1" :class="flowCalc.metrics?.color" x-text="flowCalc.metrics?.efficiency + '%'"></h3>
                    </div>
                    <div class="text-right">
                        <span class="text-xs font-bold px-3 py-1 rounded bg-slate-800 border uppercase" :class="flowCalc.metrics?.color" x-text="flowCalc.metrics?.verdict"></span>
                        <p class="text-[9px] text-slate-500 mt-1">Target: >25%</p>
                    </div>
                </div>

                <!-- The "Stream" Visualization -->
                <div class="p-6 bg-dark border-b border-slate-800 overflow-x-auto">
                    <p class="text-[10px] text-slate-500 uppercase mb-3 font-bold">TIMELINE VISUALIZATION (GREEN=WORK, RED=WAIT)</p>
                    <div class="flex h-12 w-full rounded-lg overflow-hidden relative min-w-[300px]">
                        <template x-for="step in flowCalc.steps">
                            <div class="flex h-full flex-grow" :style="`flex-grow: ${parseFloat(step.work) + parseFloat(step.wait)}`">
                                <!-- Work Segment -->
                                <div class="h-full bg-green-500 border-r border-black/20 relative group" 
                                     :style="`width: ${(step.work / (parseFloat(step.work) + parseFloat(step.wait))) * 100}%`">
                                     <div class="absolute bottom-full mb-1 left-0 text-[9px] bg-black text-white px-1 rounded opacity-0 group-hover:opacity-100 whitespace-nowrap z-10" x-text="step.work"></div>
                                </div>
                                <!-- Wait Segment -->
                                <div class="h-full bg-red-500/80 border-r border-black/20 relative group"
                                     :style="`width: ${(step.wait / (parseFloat(step.work) + parseFloat(step.wait))) * 100}%`">
                                     <div class="absolute bottom-full mb-1 right-0 text-[9px] bg-black text-white px-1 rounded opacity-0 group-hover:opacity-100 whitespace-nowrap z-10" x-text="step.wait"></div>
                                </div>
                            </div>
                        </template>
                    </div>
                    <div class="flex justify-between text-[10px] text-slate-500 mt-2 font-mono">
                        <span>Start</span>
                        <span>Total Lead Time: <span x-text="flowCalc.metrics?.totalLeadTime + ' ' + flowCalc.unit"></span></span>
                    </div>
                </div>

                <!-- Metrics Body -->
                <div class="p-6 space-y-6 flex-1">
                    
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-green-900/10 border border-green-500/30 p-4 rounded-lg">
                            <p class="text-[10px] text-green-400 uppercase font-bold">VALUE ADD TIME</p>
                            <h4 class="text-2xl font-mono text-white font-bold" x-text="flowCalc.metrics?.totalWork"></h4>
                            <p class="text-[9px] text-slate-500" x-text="flowCalc.unit"></p>
                        </div>
                        <div class="bg-red-900/10 border border-red-500/30 p-4 rounded-lg">
                            <p class="text-[10px] text-red-400 uppercase font-bold">WASTE (WAIT TIME)</p>
                            <h4 class="text-2xl font-mono text-white font-bold" x-text="flowCalc.metrics?.totalWait"></h4>
                            <p class="text-[9px] text-slate-500" x-text="flowCalc.unit"></p>
                        </div>
                    </div>

                    <!-- Bottleneck Alert -->
                    <div class="bg-slate-800 border-l-4 border-orange-500 p-4 rounded-r-lg">
                        <div class="flex items-center gap-2 mb-1">
                            <i class="fa-solid fa-triangle-exclamation text-orange-500 text-xs"></i>
                            <p class="text-[10px] text-orange-400 uppercase font-bold">PRIMARY BOTTLENECK DETECTED</p>
                        </div>
                        <p class="text-white font-bold text-sm">"<span x-text="flowCalc.metrics?.bottleneck.name"></span>"</p>
                        <p class="text-xs text-slate-400 mt-1">
                            Accounting for <span x-text="Math.round((flowCalc.metrics?.bottleneck.wait / flowCalc.metrics?.totalWait) * 100)"></span>% of all delays.
                        </p>
                    </div>

                </div>

                <!-- AI Prompt Box -->
                <div class="p-6 bg-slate-900 border-t border-slate-800">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="font-mono text-white font-bold flex items-center gap-2 text-xs uppercase">
                            <i class="fa-solid fa-robot text-blue-400"></i> Lean Master AI
                        </h3>
                    </div>

                    <div class="relative font-mono text-xs text-slate-300 bg-black/60 p-4 rounded border border-slate-700 mb-4 h-24 overflow-hidden">
                        <div class="absolute inset-0 bg-gradient-to-b from-transparent to-black/90 pointer-events-none"></div>
                        <pre class="whitespace-pre-wrap font-sans leading-relaxed" x-text="flowCalc.generateLeanPrompt()"></pre>
                    </div>

                    <button @click="
                            copyToClipboard(flowCalc.generateLeanPrompt(), 'Analysis Data');
                            $el.innerHTML = '<i class=\'fa-solid fa-check\'></i> COPIED';
                            setTimeout(() => { $el.innerHTML = '<i class=\'fa-solid fa-wand-magic-sparkles\'></i> GENERATE LEAN STRATEGY (AI)'; }, 2000)
                            " 
                            class="w-full border border-blue-500 text-blue-400 hover:bg-blue-500 hover:text-white font-bold py-3 rounded text-xs transition-all flex items-center justify-center gap-2">
                        <i class="fa-solid fa-wand-magic-sparkles"></i> GENERATE LEAN STRATEGY (AI)
                    </button>
                    <p class="text-center text-[10px] text-slate-500 mt-3">
                        Ready to paste into your GenAI tool of choice.
                    </p>
                </div>

            </div>
        </div>

    </div>
</div>


        <!-- ADR BUILDER TAB -->
<div x-show="currentTab === 'adr'" x-cloak class="max-w-6xl mx-auto pb-20">
    
    <div class="text-center mb-10">
        <h2 class="font-mono text-3xl font-bold text-white mb-2">
            <i class="fa-solid fa-book-journal-whills mr-2 text-indigo-300"></i>Architecture Decision Journal
        </h2>
        <p class="text-textMuted text-sm">Don't rely on memory. Rely on weighted math.</p>
    </div>

    <!-- HEADER / DEMO -->
    <div class="flex justify-between items-end mb-6">
        <div class="w-full max-w-lg">
            <label class="text-xs font-mono text-slate-400 uppercase">Decision Title</label>
            <input type="text" x-model="adrBuilder.title" placeholder="e.g. Monolith vs Microservices" class="w-full bg-dark border border-slate-600 rounded p-3 text-white focus:border-indigo-400 focus:outline-none mt-1">
        </div>
        <button @click="adrBuilder.loadDemo()" class="text-xs border border-slate-600 hover:bg-slate-700 text-slate-300 px-3 py-2 rounded transition-all">
            Load Demo Data
        </button>
    </div>

    <div class="grid lg:grid-cols-12 gap-8 items-start">
        
        <!-- LEFT: THE MATRIX (INPUTS) -->
        <div class="lg:col-span-8 bg-card border border-slate-700 rounded-xl overflow-hidden">
            <div class="p-4 bg-slate-800 border-b border-slate-700 flex justify-between items-center">
                <h3 class="font-mono text-xs text-indigo-300 uppercase font-bold">Evaluation Matrix</h3>
                <div class="flex gap-2">
                    <button @click="adrBuilder.addCriteria()" class="text-[10px] bg-slate-700 hover:bg-slate-600 text-white px-2 py-1 rounded">+ Criteria</button>
                    <button @click="adrBuilder.addOption()" class="text-[10px] bg-slate-700 hover:bg-slate-600 text-white px-2 py-1 rounded">+ Option</button>
                </div>
            </div>

            <div class="overflow-x-auto">
                <table class="w-full text-left text-sm">
                    <thead>
                        <tr class="bg-slate-900 text-slate-400 text-[10px] uppercase font-mono">
                            <th class="p-4 w-1/3">Criteria (Weight 1-5)</th>
                            <template x-for="opt in adrBuilder.options" :key="opt.id">
                                <th class="p-4 text-center border-l border-slate-700">
                                    <input type="text" x-model="opt.name" class="bg-transparent text-center w-full focus:outline-none text-white font-bold">
                                </th>
                            </template>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-slate-700">
                        <template x-for="crit in adrBuilder.criteria" :key="crit.id">
                            <tr class="hover:bg-slate-800/30">
                                <td class="p-4">
                                    <div class="flex flex-col gap-1">
                                        <input type="text" x-model="crit.label" class="bg-transparent text-white focus:outline-none">
                                        <div class="flex items-center gap-2">
                                            <span class="text-[9px] text-slate-500">IMPORTANCE:</span>
                                            <input type="range" min="1" max="5" x-model="crit.weight" @input="adrBuilder.calculate()" class="w-16 h-1 bg-slate-600 rounded-lg appearance-none cursor-pointer">
                                            <span class="text-[9px] font-mono text-indigo-400" x-text="crit.weight"></span>
                                        </div>
                                    </div>
                                </td>
                                <template x-for="opt in adrBuilder.options" :key="opt.id">
                                    <td class="p-4 text-center border-l border-slate-700">
                                        <input type="number" min="1" max="5" 
                                               x-model="opt.scores[crit.id]" 
                                               @input="adrBuilder.calculate()"
                                               class="w-10 bg-dark border border-slate-600 rounded text-center text-white focus:border-indigo-400">
                                    </td>
                                </template>
                            </tr>
                        </template>
                    </tbody>
                    <!-- Totals Row -->
                    <tfoot class="bg-slate-900 border-t-2 border-slate-700">
                        <tr>
                            <td class="p-4 font-mono text-xs text-slate-400 text-right uppercase tracking-widest">Weighted Score</td>
                            <template x-for="opt in adrBuilder.options" :key="opt.id">
                                <td class="p-4 text-center border-l border-slate-700">
                                    <span class="text-xl font-bold font-mono" 
                                          :class="opt.id === adrBuilder.winner?.id ? 'text-green-400' : 'text-slate-500'"
                                          x-text="opt.total"></span>
                                </td>
                            </template>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>

        <!-- RIGHT: THE VERDICT (OUTPUT) -->
        <div class="lg:col-span-4 space-y-6">
            
            <!-- Winner Card -->
            <div class="bg-gradient-to-br from-slate-800 to-indigo-900/30 border border-indigo-500/30 p-6 rounded-xl relative overflow-hidden" x-show="adrBuilder.winner">
                <div class="absolute top-0 right-0 p-4 opacity-10"><i class="fa-solid fa-trophy text-6xl text-yellow-400"></i></div>
                
                <p class="text-[10px] text-indigo-300 uppercase tracking-widest mb-2">RECOMMENDED DECISION</p>
                <h3 class="text-2xl font-bold text-white mb-4" x-text="adrBuilder.winner?.name"></h3>
                
                <div class="space-y-2">
                    <div class="flex justify-between text-xs border-b border-white/10 pb-1">
                        <span class="text-slate-400">Total Score</span>
                        <span class="text-white font-mono" x-text="adrBuilder.winner?.total"></span>
                    </div>
                    <div class="flex justify-between text-xs border-b border-white/10 pb-1">
                        <span class="text-slate-400">Winning Margin</span>
                        <span class="text-green-400 font-mono">+<span x-text="adrBuilder.options.length > 1 ? (adrBuilder.winner?.total - adrBuilder.options.sort((a,b)=>b.total-a.total)[1].total) : 0"></span></span>
                    </div>
                </div>
                
                <div class="mt-6">
                    <span class="text-[9px] bg-indigo-500 text-white px-2 py-1 rounded font-bold uppercase">Status: Proposed</span>
                </div>
            </div>

            <!-- AI Prompt Box -->
            <div class="bg-slate-900 border border-slate-700 p-6 rounded-xl group">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="font-mono text-white font-bold flex items-center gap-2 text-xs uppercase">
                        <i class="fa-solid fa-robot text-indigo-400"></i> ADR Generator
                    </h3>
                </div>

                <div class="relative font-mono text-xs text-slate-300 bg-black/60 p-4 rounded border border-slate-700 mb-4 h-24 overflow-hidden">
                    <div class="absolute inset-0 bg-gradient-to-b from-transparent to-black/90 pointer-events-none"></div>
                    <pre class="whitespace-pre-wrap font-sans leading-relaxed" x-text="adrBuilder.generateADRPrompt()"></pre>
                </div>

                <button @click="
                        copyToClipboard(adrBuilder.generateADRPrompt(), 'Decision Data');
                        $el.innerHTML = '<i class=\'fa-solid fa-check\'></i> COPIED';
                        setTimeout(() => { $el.innerHTML = '<i class=\'fa-solid fa-wand-magic-sparkles\'></i> GENERATE ADR DOC (AI)'; }, 2000)
                        " 
                        class="w-full border border-indigo-500 text-indigo-400 hover:bg-indigo-500 hover:text-white font-bold py-3 rounded text-xs transition-all flex items-center justify-center gap-2">
                    <i class="fa-solid fa-wand-magic-sparkles"></i> GENERATE ADR DOC (AI)
                </button>
                <p class="text-center text-[10px] text-slate-500 mt-3">
                    Ready to paste into your GenAI tool of choice.
                </p>
            </div>

        </div>
    </div>
</div>


        <!-- DAILY FEED TAB -->
<div x-show="currentTab === 'feed'" x-cloak class="max-w-2xl mx-auto pb-20" x-init="dailyFeed.init()">
    
    <div class="text-center mb-8">
        <h2 class="font-mono text-3xl font-bold text-white mb-2">
            <i class="fa-solid fa-mug-hot mr-2 text-yellow-400"></i>Daily Insight
        </h2>
        <p class="text-textMuted text-sm">Build your executive vocabulary. 60 seconds a day.</p>
    </div>

    <!-- 1. HUD: STREAK & NOTIFICATIONS -->
    <div class="flex justify-between items-center mb-6 bg-card border border-slate-700 p-4 rounded-xl">
        
        <!-- Left: Streak -->
        <div class="flex items-center gap-4">
            <div class="w-12 h-12 bg-orange-500/20 text-orange-500 rounded-full flex items-center justify-center text-xl border border-orange-500/50 shadow-[0_0_15px_rgba(249,115,22,0.3)]">
                <i class="fa-solid fa-fire animate-pulse"></i>
            </div>
            <div>
                <p class="text-[10px] text-slate-500 uppercase tracking-widest font-mono">STREAK</p>
                <h3 class="text-2xl font-bold text-white"><span x-text="dailyFeed.streak"></span> Days</h3>
            </div>
        </div>
        
        <!-- Right: Notification Toggle -->
        <div class="text-right">
            <button x-show="dailyFeed.notificationPermission === 'default'" 
                    @click="dailyFeed.requestNotify()" 
                    class="text-xs bg-slate-700 hover:bg-slate-600 text-white px-4 py-2 rounded-full transition-colors border border-slate-600 mb-1 flex items-center gap-2">
                <i class="fa-regular fa-bell"></i> Enable 9AM Alert
            </button>
            <div x-show="dailyFeed.notificationPermission === 'granted'" class="flex flex-col items-end">
                <p class="text-[10px] text-green-400 font-mono flex items-center gap-1">
                    <i class="fa-solid fa-check-circle"></i> ALERTS ACTIVE
                </p>
                <p class="text-[9px] text-slate-500">Scheduled for 09:00</p>
            </div>
        </div>
    </div>

    <!-- 2. MASTERY SCOREBOARD -->
    <div class="grid grid-cols-2 gap-4 mb-6">
        <!-- Fluency Score -->
        <div class="bg-slate-900 p-4 rounded-xl border border-slate-700 relative overflow-hidden">
            <div class="absolute top-0 right-0 p-3 opacity-10"><i class="fa-solid fa-brain text-4xl text-yellow-400"></i></div>
            <p class="text-[10px] text-slate-500 uppercase tracking-widest font-bold">FLUENCY XP</p>
            <h3 class="text-3xl font-mono font-bold text-yellow-400 mt-1" x-text="dailyFeed.fluencyScore"></h3>
        </div>
        
        <!-- Rank -->
        <div class="bg-slate-900 p-4 rounded-xl border border-slate-700">
            <p class="text-[10px] text-slate-500 uppercase tracking-widest font-bold">CURRENT RANK</p>
            <div class="flex justify-between items-center mt-1">
                <h3 class="text-xl font-bold text-white" x-text="dailyFeed.fluencyLevel"></h3>
                <i class="fa-solid" 
                   :class="dailyFeed.fluencyLevel === 'Novice' ? 'fa-seedling text-green-400' : (dailyFeed.fluencyLevel === 'Apprentice' ? 'fa-book text-blue-400' : 'fa-crown text-yellow-400')"></i>
            </div>
            <!-- XP Progress Bar -->
            <div class="w-full bg-slate-800 h-1.5 rounded-full mt-3 overflow-hidden">
                <div class="bg-gradient-to-r from-yellow-600 to-yellow-400 h-full transition-all duration-1000" 
                     :style="`width: ${(dailyFeed.fluencyScore % 300) / 3}%`"></div>
            </div>
        </div>
    </div>

    <!-- 3. THE FLASHCARD (Main Interaction) -->
    <div class="relative min-h-[500px]">
        
        <!-- Loading State Overlay -->
        <div x-show="dailyFeed.loading" class="absolute inset-0 flex flex-col items-center justify-center bg-card border border-slate-700 rounded-2xl z-20">
            <i class="fa-solid fa-satellite-dish fa-spin text-5xl text-yellow-400 mb-6"></i>
            <p class="font-mono text-xs text-yellow-200 animate-pulse uppercase tracking-widest">DOWNLOADING INTELLIGENCE...</p>
        </div>

        <!-- The Card -->
        <div x-show="!dailyFeed.loading && dailyFeed.currentLesson" class="bg-gradient-to-b from-slate-800 to-slate-900 border border-slate-600 rounded-2xl shadow-2xl overflow-hidden flex flex-col h-full relative group transition-all duration-500">
            
            <!-- Date Badge -->
            <div class="absolute top-0 right-0 bg-slate-700/50 backdrop-blur text-slate-300 text-[10px] px-3 py-1 rounded-bl-xl font-mono border-b border-l border-slate-600">
                <span x-text="new Date().toLocaleDateString(undefined, {weekday:'long', month:'short', day:'numeric'})"></span>
            </div>

            <!-- Card Body -->
            <div class="p-8 flex-1">
                <p class="text-[10px] text-yellow-500 font-bold uppercase tracking-widest mb-2">TERM OF THE DAY</p>
                
                <h2 class="text-4xl font-bold text-white mb-2 tracking-tight leading-tight" x-text="dailyFeed.currentLesson?.term"></h2>
                
                <div class="flex items-center gap-2 mb-8">
                    <span class="text-xs text-slate-500 font-mono bg-slate-800 px-2 py-1 rounded">/ <span x-text="dailyFeed.currentLesson?.pronounce"></span> /</span>
                </div>
                
                <div class="space-y-8">
                    <!-- Definition -->
                    <div>
                        <h4 class="text-xs font-bold text-white mb-2 flex items-center"><i class="fa-solid fa-book-open mr-2 text-slate-400"></i>Definition</h4>
                        <p class="text-base text-slate-300 leading-relaxed font-light" x-text="dailyFeed.currentLesson?.definition"></p>
                    </div>
                    
                    <!-- Analogy Box -->
                    <div class="bg-blue-900/10 border-l-4 border-blue-500 p-4 rounded-r-lg">
                        <h4 class="text-xs font-bold text-blue-400 mb-2 uppercase"><i class="fa-solid fa-lightbulb mr-2"></i>The Analogy</h4>
                        <p class="text-sm text-blue-100 italic leading-relaxed" x-text="dailyFeed.currentLesson?.analogy"></p>
                    </div>

                    <!-- Impact -->
                    <div>
                        <h4 class="text-xs font-bold text-green-400 mb-2 uppercase"><i class="fa-solid fa-chart-line mr-2"></i>Executive Impact</h4>
                        <p class="text-sm text-slate-300" x-text="dailyFeed.currentLesson?.impact"></p>
                    </div>
                </div>
            </div>

            <!-- Quiz Section (Bottom) -->
            <div class="bg-black/30 border-t border-slate-700 p-6 backdrop-blur-sm">
                
                <!-- State: Question -->
                <div x-show="dailyFeed.quizState === 'pending'">
                    <p class="text-xs font-bold text-slate-400 uppercase mb-3 flex justify-between">
                        <span>QUICK CHECK</span>
                        <span class="text-white normal-case italic" x-text="dailyFeed.currentLesson?.quiz.q"></span>
                    </p>
                    <div class="grid gap-2">
                        <template x-for="(opt, idx) in dailyFeed.currentLesson?.quiz.options">
                            <button @click="dailyFeed.submitAnswer(idx)" 
                                    class="w-full text-left p-3 rounded-lg border border-slate-600 bg-slate-800 hover:bg-slate-700 hover:border-yellow-400 transition-all text-sm text-slate-200 group flex justify-between items-center">
                                <span x-text="opt"></span>
                                <i class="fa-solid fa-chevron-right opacity-0 group-hover:opacity-100 transition-opacity text-yellow-400 text-xs"></i>
                            </button>
                        </template>
                    </div>
                </div>

                <!-- State: Success -->
                <div x-show="dailyFeed.quizState === 'correct'" class="text-center py-4 animate-bounce">
                    <div class="inline-block p-3 rounded-full bg-green-500/20 text-green-400 mb-2">
                        <i class="fa-solid fa-circle-check text-3xl"></i>
                    </div>
                    <p class="text-lg font-bold text-white">Correct!</p>
                    <p class="text-xs text-green-400 font-mono">+XP GAINED</p>
                </div>

                <!-- State: Fail -->
                <div x-show="dailyFeed.quizState === 'wrong'" class="text-center py-4">
                    <div class="inline-block p-3 rounded-full bg-red-500/20 text-red-500 mb-2">
                        <i class="fa-solid fa-circle-xmark text-3xl"></i>
                    </div>
                    <p class="text-lg font-bold text-white">Incorrect.</p>
                    <button @click="dailyFeed.quizState = 'pending'" class="text-xs text-slate-400 hover:text-white underline mt-2">Try Again</button>
                </div>

            </div>
        </div>
    </div>

    <!-- 4. AI PROMPT GENERATOR -->
    <div class="mt-8 bg-slate-900 border border-yellow-500/30 p-6 rounded-xl relative overflow-hidden group">
        
        <!-- Header -->
        <div class="flex justify-between items-center mb-4 relative z-10">
            <h3 class="font-mono text-white font-bold flex items-center gap-2 text-xs uppercase">
                <i class="fa-solid fa-robot text-yellow-500"></i> Executive Tutor AI
            </h3>
            <span class="text-[9px] uppercase bg-yellow-900/50 text-yellow-400 px-2 py-1 rounded border border-yellow-500/30 font-bold tracking-wider">
                Deep Dive
            </span>
        </div>

        <!-- Preview -->
        <div class="relative z-10 font-mono text-xs text-slate-300 bg-black/60 p-4 rounded border border-slate-700 mb-4 h-24 overflow-hidden">
            <div class="absolute inset-0 bg-gradient-to-b from-transparent to-black/90 pointer-events-none"></div>
            <pre class="whitespace-pre-wrap font-sans leading-relaxed" x-text="dailyFeed.generateDeepDivePrompt()"></pre>
        </div>

        <!-- Copy Button -->
        <button @click="
                copyToClipboard(dailyFeed.generateDeepDivePrompt(), 'Lesson Data');
                $el.innerHTML = '<i class=\'fa-solid fa-check\'></i> COPIED';
                $el.classList.add('bg-green-500', 'text-white', 'border-green-500');
                setTimeout(() => { 
                    $el.innerHTML = '<i class=\'fa-solid fa-wand-magic-sparkles\'></i> GENERATE DEEP DIVE (AI)'; 
                    $el.classList.remove('bg-green-500', 'text-white', 'border-green-500');
                }, 2000)
                " 
                class="relative z-10 w-full border border-yellow-500 text-yellow-400 hover:bg-yellow-500 hover:text-black font-bold py-3 rounded-lg transition-all text-xs flex items-center justify-center gap-2 shadow-[0_0_10px_rgba(234,179,8,0.1)] hover:shadow-[0_0_15px_rgba(234,179,8,0.4)]">
            <i class="fa-solid fa-wand-magic-sparkles"></i> GENERATE DEEP DIVE (AI)
        </button>
        
        <p class="text-center text-[10px] text-slate-500 mt-3 relative z-10">
            Paste into your GenAI tool to get a "Bullshit Detector" script for this term.
        </p>
    </div>

    <!-- Dev Tools (Hidden in production usually, but kept for testing) -->
    <div class="text-center mt-12 opacity-30 hover:opacity-100 transition-opacity">
        <button @click="dailyFeed.fetchWeeklyBatch()" class="text-[9px] text-slate-500 hover:text-white underline">
            [Force Refresh Content]
        </button>
    </div>

</div>


        <!-- EXECUTIVE LIBRARY TAB -->
<div x-show="currentTab === 'library'" x-cloak class="max-w-6xl mx-auto pb-20" x-init="library.init()">
    
    <div class="text-center mb-10">
        <h2 class="font-mono text-3xl font-bold text-white mb-2">
            <i class="fa-solid fa-book-open-reader mr-2 text-cyan-300"></i>Executive Library
        </h2>
        <p class="text-textMuted text-sm">The Bilingual Canon. Track your reading and technical fluency.</p>
    </div>

    <!-- PROGRESS HEADER -->
    <div class="bg-card border border-slate-700 p-6 rounded-xl mb-8 flex justify-between items-center relative overflow-hidden">
        <!-- Progress Bar Background -->
        <div class="absolute bottom-0 left-0 h-1 bg-cyan-900 w-full">
            <div class="h-full bg-cyan-400 transition-all duration-1000" :style="`width: ${library.literacyScore}%`"></div>
        </div>

        <div class="flex items-center gap-4">
            <div class="w-16 h-16 rounded-full border-4 flex items-center justify-center bg-slate-800"
                 :class="library.literacyScore >= 80 ? 'border-green-400 text-green-400' : (library.literacyScore >= 50 ? 'border-yellow-400 text-yellow-400' : 'border-slate-500 text-slate-500')">
                <span class="text-xl font-bold font-mono" x-text="library.literacyScore + '%'"></span>
            </div>
            <div>
                <h3 class="text-lg font-bold text-white">Bilingual Literacy Score</h3>
                <p class="text-xs text-slate-400">
                    <span x-show="library.literacyScore < 50">Novice. Start reading.</span>
                    <span x-show="library.literacyScore >= 50 && library.literacyScore < 80">Apprentice. Gaining fluency.</span>
                    <span x-show="library.literacyScore >= 80">Expert. You speak both languages.</span>
                </p>
            </div>
        </div>

        <!-- Toggle View -->
        <div class="flex bg-slate-800 p-1 rounded-lg border border-slate-600">
            <button @click="library.view = 'books'" 
                    :class="library.view === 'books' ? 'bg-cyan-600 text-white' : 'text-slate-400 hover:text-white'"
                    class="px-4 py-2 rounded text-xs font-bold transition-all">
                <i class="fa-solid fa-book mr-2"></i>Strategy Books
            </button>
            <button @click="library.view = 'stack'" 
                    :class="library.view === 'stack' ? 'bg-cyan-600 text-white' : 'text-slate-400 hover:text-white'"
                    class="px-4 py-2 rounded text-xs font-bold transition-all">
                <i class="fa-solid fa-layer-group mr-2"></i>Tech Stack
            </button>
        </div>
    </div>

    <!-- VIEW 1: BOOKS -->
    <div x-show="library.view === 'books'" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6" x-transition:enter="transition ease-out duration-300 transform" x-transition:enter-start="opacity-0 translate-y-4" x-transition:enter-end="opacity-100 translate-y-0">
        <template x-for="book in library.books" :key="book.id">
            <div class="bg-card border p-6 rounded-xl relative group transition-all hover:-translate-y-1"
                 :class="library.readBooks.includes(book.id) ? 'border-green-500/50 bg-green-900/10' : 'border-slate-700 hover:border-cyan-400'">
                
                <div class="flex justify-between items-start mb-4">
                    <span class="text-[10px] font-mono uppercase tracking-widest px-2 py-1 rounded bg-slate-800 text-slate-300 border border-slate-600" x-text="book.domain"></span>
                    <button @click="library.toggleBook(book.id)" 
                            class="w-8 h-8 rounded-full flex items-center justify-center border transition-all"
                            :class="library.readBooks.includes(book.id) ? 'bg-green-500 border-green-500 text-white' : 'border-slate-500 text-slate-500 hover:border-white hover:text-white'">
                        <i class="fa-solid fa-check"></i>
                    </button>
                </div>

                <h3 class="text-xl font-bold text-white mb-1" x-text="book.title"></h3>
                <p class="text-xs text-cyan-400 font-mono mb-4" x-text="'// ' + book.author"></p>
                
                <p class="text-sm text-slate-300 leading-relaxed mb-4" x-text="book.summary"></p>
                
                <div class="text-[10px] text-slate-500 font-bold uppercase">Impact: <span x-text="book.impact" :class="book.impact === 'Critical' ? 'text-red-400' : 'text-slate-300'"></span></div>
            </div>
        </template>
    </div>

    <!-- VIEW 2: TECH STACK -->
    <div x-show="library.view === 'stack'" class="space-y-4" x-transition:enter="transition ease-out duration-300 transform" x-transition:enter-start="opacity-0 translate-y-4" x-transition:enter-end="opacity-100 translate-y-0">
        <template x-for="tool in library.techStack" :key="tool.id">
            <div class="bg-card border p-4 rounded-xl flex flex-col md:flex-row items-center gap-6 transition-all hover:bg-slate-800"
                 :class="library.knownTools.includes(tool.id) ? 'border-green-500/50' : 'border-slate-700'">
                
                <!-- Checkbox -->
                <button @click="library.toggleTool(tool.id)" 
                        class="shrink-0 w-10 h-10 rounded-full flex items-center justify-center border-2 transition-all"
                        :class="library.knownTools.includes(tool.id) ? 'bg-green-500 border-green-500 text-white' : 'border-slate-600 text-slate-600 hover:border-cyan-400 hover:text-cyan-400'">
                    <i class="fa-solid fa-check"></i>
                </button>

                <!-- Content -->
                <div class="flex-1 text-center md:text-left">
                    <div class="flex flex-col md:flex-row md:items-center gap-2 mb-1">
                        <h3 class="text-lg font-bold text-white" x-text="tool.name"></h3>
                        <span class="text-[10px] bg-slate-900 text-slate-400 px-2 py-0.5 rounded border border-slate-700 w-fit mx-auto md:mx-0" x-text="tool.category"></span>
                    </div>
                    <p class="text-sm text-cyan-300 font-mono mb-1">"The <span x-text="tool.analogy"></span>"</p>
                    <p class="text-xs text-slate-400" x-text="tool.desc"></p>
                </div>
            </div>
        </template>
    </div>

    <!-- 3. AI TUTOR PROMPT -->
    <div class="mt-12 bg-slate-900 border border-cyan-500/30 p-6 rounded-xl relative overflow-hidden group">
        <div class="flex justify-between items-center mb-4 relative z-10">
            <h3 class="font-mono text-white font-bold flex items-center gap-2">
                <i class="fa-solid fa-robot text-cyan-400"></i> 
                PERSONALIZED CURRICULUM AI
            </h3>
            <span class="text-[10px] uppercase bg-cyan-900/50 text-cyan-400 px-2 py-1 rounded border border-cyan-500/30 font-bold tracking-wider">
                Gap Analysis Ready
            </span>
        </div>

        <div class="relative z-10 font-mono text-xs text-slate-300 bg-black/60 p-4 rounded border border-slate-700 mb-4 h-24 overflow-hidden">
            <div class="absolute inset-0 bg-gradient-to-b from-transparent to-black/90 pointer-events-none"></div>
            <pre class="whitespace-pre-wrap font-sans leading-relaxed" x-text="library.generateCurriculumPrompt()"></pre>
        </div>

        <button @click="
                copyToClipboard(library.generateCurriculumPrompt(), 'Curriculum');
                $el.innerHTML = '<i class=\'fa-solid fa-check\'></i> COPIED';
                $el.classList.add('bg-green-500', 'text-white', 'border-green-500');
                setTimeout(() => {
                    $el.innerHTML = '<i class=\'fa-solid fa-wand-magic-sparkles\'></i> GENERATE STUDY PLAN (AI)';
                    $el.classList.remove('bg-green-500', 'text-white', 'border-green-500');
                }, 2000)
                " 
                class="relative z-10 w-full py-4 bg-transparent border border-cyan-500 text-cyan-400 hover:bg-cyan-500 hover:text-black font-bold rounded-lg transition-all duration-300 flex items-center justify-center gap-2 font-mono text-xs uppercase tracking-widest shadow-[0_0_10px_rgba(34,211,238,0.1)] hover:shadow-[0_0_20px_rgba(34,211,238,0.4)]">
            <i class="fa-solid fa-wand-magic-sparkles"></i> GENERATE STUDY PLAN (AI)
        </button>
        
        <p class="text-center text-[10px] text-slate-500 mt-3 relative z-10">
            Paste into AI to get a "Cheat Sheet" for the books and tools you haven't marked as known yet.
        </p>
    </div>

</div>

        <!-- DT ROI TRACKER TAB -->
<div x-show="currentTab === 'dt_tracker'" x-cloak class="max-w-6xl mx-auto pb-20">
    
    <div class="text-center mb-10">
        <h2 class="font-mono text-3xl font-bold text-white mb-2">
            <i class="fa-solid fa-magnifying-glass-dollar mr-2 text-green-400"></i>ROI Tracker
        </h2>
        <p class="text-textMuted text-sm">Visualize the "J-Curve". Prove the value of Soft Benefits.</p>
    </div>

    <div class="grid lg:grid-cols-12 gap-8 items-start">
        
        <!-- LEFT: FINANCIAL INPUTS -->
        <div class="lg:col-span-4 bg-card border border-slate-700 p-6 rounded-xl space-y-6">
            <h3 class="font-mono text-xs text-green-400 uppercase font-bold border-b border-slate-700 pb-2">Cost Structure</h3>
            
            <div>
                <label class="text-[10px] text-slate-500 uppercase font-bold">Project Name</label>
                <input type="text" x-model="dtTracker.inputs.projectName" class="w-full bg-dark border border-slate-600 rounded p-2 text-white text-sm focus:border-green-500 outline-none">
            </div>

            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="text-[10px] text-slate-500 uppercase font-bold">Upfront Cost ($)</label>
                    <input type="number" x-model="dtTracker.inputs.initialCost" class="w-full bg-dark border border-slate-600 rounded p-2 text-white font-mono">
                </div>
                <div>
                    <label class="text-[10px] text-slate-500 uppercase font-bold">Monthly Run Cost ($)</label>
                    <input type="number" x-model="dtTracker.inputs.monthlyCost" class="w-full bg-dark border border-slate-600 rounded p-2 text-white font-mono">
                </div>
            </div>

            <h3 class="font-mono text-xs text-blue-400 uppercase font-bold border-b border-slate-700 pb-2 pt-2">Benefit Drivers</h3>

            <div>
                <label class="text-[10px] text-slate-500 uppercase font-bold">Hard Savings / Month ($)</label>
                <input type="number" x-model="dtTracker.inputs.monthlyHardSavings" class="w-full bg-dark border border-slate-600 rounded p-2 text-white font-mono placeholder-slate-600" placeholder="Server cuts, etc.">
            </div>

            <div class="bg-blue-900/10 p-3 rounded border border-blue-500/30">
                <p class="text-[10px] text-blue-300 font-bold mb-2">SOFT VALUE ENGINE</p>
                <div class="grid grid-cols-2 gap-4 mb-2">
                    <div>
                        <label class="text-[9px] text-slate-400">Team Size</label>
                        <input type="number" x-model="dtTracker.inputs.teamSize" class="w-full bg-dark border border-slate-600 rounded p-1 text-white text-xs">
                    </div>
                    <div>
                        <label class="text-[9px] text-slate-400">Efficiency Gain %</label>
                        <input type="number" x-model="dtTracker.inputs.efficiencyGain" class="w-full bg-dark border border-slate-600 rounded p-1 text-white text-xs">
                    </div>
                </div>
                
                <!-- Confidence Slider -->
                <div>
                    <div class="flex justify-between mb-1">
                        <label class="text-[9px] text-slate-400">CFO Confidence Level</label>
                        <span class="text-[9px] font-bold text-white" x-text="dtTracker.inputs.confidence + '%'"></span>
                    </div>
                    <input type="range" min="0" max="100" step="10" x-model="dtTracker.inputs.confidence" class="w-full h-1 bg-dark rounded-lg appearance-none cursor-pointer accent-blue-400">
                </div>
            </div>

            <!-- Fixed Button -->
            <button @click="dtTracker.calculate()" 
                    :disabled="dtTracker.loading"
                    class="w-full py-4 bg-green-600 hover:bg-green-500 text-white font-bold rounded-lg shadow-glow transition-all flex items-center justify-center gap-2">
                
                <!-- Template tag used to prevent flickering logic issues -->
                <template x-if="!dtTracker.loading">
                    <span class="flex items-center gap-2"><i class="fa-solid fa-chart-line"></i> MODEL THE J-CURVE</span>
                </template>
                
                <template x-if="dtTracker.loading">
                    <span class="flex items-center gap-2"><i class="fa-solid fa-circle-notch fa-spin"></i> CALCULATING...</span>
                </template>
            </button>
        </div>

        <!-- RIGHT: THE J-CURVE (OUTPUT) -->
        <div class="lg:col-span-8">
            
            <!-- Empty State (Fixed height for clean look initially) -->
            <div x-show="!dtTracker.results" class="h-96 border-2 border-dashed border-slate-700 rounded-xl flex flex-col items-center justify-center text-slate-500">
                <i class="fa-solid fa-sack-dollar text-6xl mb-4 opacity-20"></i>
                <p class="font-mono text-xs uppercase">Input Financials to Begin</p>
            </div>

            <!-- Results Card (Auto height to avoid empty space) -->
            <div x-show="dtTracker.results" x-transition class="bg-card border-2 rounded-xl overflow-hidden shadow-2xl relative"
                 :class="dtTracker.results?.roi24 > 0 ? 'border-green-500' : 'border-red-500'">
                
                <!-- Header -->
                <div class="p-6 bg-slate-900 border-b border-slate-800 flex justify-between items-center">
                    <div>
                        <p class="text-[10px] font-mono text-slate-500 uppercase tracking-widest">24-MONTH OUTLOOK</p>
                        <h3 class="text-3xl font-bold font-mono mt-1" 
                            :class="dtTracker.results?.endingBalance > 0 ? 'text-green-400' : 'text-red-400'" 
                            x-text="dtTracker.results?.endingBalance > 0 ? '$' + dtTracker.results?.endingBalance.toLocaleString() : '-$' + Math.abs(dtTracker.results?.endingBalance).toLocaleString()"></h3>
                    </div>
                    <div class="text-right">
                        <span class="text-xs font-bold px-3 py-1 rounded bg-slate-800 border uppercase" :class="dtTracker.results?.color" x-text="dtTracker.results?.verdict"></span>
                        <p class="text-[9px] text-slate-500 mt-1">Payback: <span x-text="dtTracker.results?.payback"></span></p>
                    </div>
                </div>

                <!-- The Visual Graph (CSS Bar Chart) -->
                <div class="p-6 bg-dark/50 relative h-64">
                    <div class="absolute top-2 left-4 text-[10px] text-slate-500 font-mono">CUMULATIVE CASH FLOW (2 Years)</div>
                    
                    <!-- Zero Line -->
                    <div class="w-full h-px bg-slate-500 absolute" style="top: 50%;"></div>

                    <div class="flex items-end justify-between h-full w-full gap-1 pt-6 pb-2">
                        <template x-for="(val, index) in dtTracker.results?.chartData">
                            <div class="flex-1 flex flex-col justify-center relative group h-full">
                                <!-- The Bar Container -->
                                <div class="relative h-full w-full">
                                    <div class="absolute w-full rounded-t-sm transition-all duration-500"
                                         :class="val >= 0 ? 'bg-green-500 bottom-1/2 origin-bottom' : 'bg-red-500 top-1/2 origin-top'"
                                         :style="`height: ${Math.min(50, Math.abs(val) / (Math.max(...dtTracker.results.chartData.map(Math.abs)) * 1.2) * 50)}%`">
                                    </div>
                                </div>
                                <!-- Tooltip -->
                                <div class="absolute bottom-full left-1/2 -translate-x-1/2 mb-1 bg-black text-white text-[9px] px-2 py-1 rounded opacity-0 group-hover:opacity-100 whitespace-nowrap z-20 font-mono border border-slate-600">
                                    M<span x-text="index+1"></span>: $<span x-text="val.toLocaleString()"></span>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>

                <!-- Composition Analysis -->
                <div class="p-4 grid grid-cols-2 gap-4 bg-slate-900 border-t border-slate-800">
                    <div>
                        <p class="text-[10px] text-slate-500 uppercase font-bold">HARD VALUE (P&L)</p>
                        <p class="text-sm font-mono text-white" x-text="'$' + dtTracker.results?.hardContribution.toLocaleString()"></p>
                    </div>
                    <div>
                        <p class="text-[10px] text-slate-500 uppercase font-bold">SOFT VALUE (Strategic)</p>
                        <p class="text-sm font-mono text-blue-300" x-text="'$' + dtTracker.results?.softContribution.toLocaleString()"></p>
                    </div>
                </div>

                <!-- AI Prompt Box -->
                <div class="p-6 bg-slate-800 border-t border-slate-700">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="font-mono text-white font-bold flex items-center gap-2 text-xs uppercase">
                            <i class="fa-solid fa-robot text-green-400"></i> CFO Narrative Generator
                        </h3>
                    </div>

                    <div class="relative font-mono text-xs text-slate-300 bg-black/60 p-4 rounded border border-slate-600 mb-4 h-24 overflow-hidden">
                        <div class="absolute inset-0 bg-gradient-to-b from-transparent to-black/90 pointer-events-none"></div>
                        <pre class="whitespace-pre-wrap font-sans leading-relaxed" x-text="dtTracker.generateCFOReport()"></pre>
                    </div>

                    <button @click="
                            copyToClipboard(dtTracker.generateCFOReport(), 'Financial Model');
                            $el.innerHTML = '<i class=\'fa-solid fa-check\'></i> COPIED';
                            setTimeout(() => { $el.innerHTML = '<i class=\'fa-solid fa-wand-magic-sparkles\'></i> GENERATE BOARD MEMO (AI)'; }, 2000)
                            " 
                            class="w-full border border-green-500 text-green-400 hover:bg-green-500 hover:text-white font-bold py-3 rounded text-xs transition-all flex items-center justify-center gap-2">
                        <i class="fa-solid fa-wand-magic-sparkles"></i> GENERATE BOARD MEMO (AI)
                    </button>
                    <p class="text-center text-[10px] text-slate-500 mt-3">
                        Ready to paste into your GenAI tool of choice.
                    </p>
                </div>

            </div>
        </div>

    </div>
</div>



        <!-- MEETING TICKER TOOL -->
<div x-show="currentTab === 'ticker'" class="max-w-2xl mx-auto space-y-6">
    
    <!-- Header -->
    <div class="text-center space-y-2">
        <div class="inline-flex items-center justify-center w-12 h-12 rounded-full bg-green-500/20 text-green-400 mb-2">
            <i class="fa-solid fa-stopwatch text-2xl"></i>
        </div>
        <h2 class="text-2xl font-bold text-white">The Meeting Tax Ticker</h2>
        <p class="text-slate-400">Real-time FinOps. Visualize the burn rate of bureaucracy.</p>
    </div>

    <!-- The Ticker Display -->
    <div class="bg-slate-800 rounded-xl p-8 text-center border border-slate-700 shadow-2xl relative overflow-hidden">
        
        <!-- Background Pulse Effect for High Cost -->
        <div x-show="meetingTicker.currentCost > 500" 
             class="absolute inset-0 bg-red-500/5 pointer-events-none transition-opacity duration-1000"
             :class="meetingTicker.currentCost > 1000 ? 'animate-pulse' : ''"></div>

        <!-- Timer -->
        <div class="text-slate-400 font-mono text-sm mb-2" x-text="meetingTicker.formatTime()">0:00</div>

        <!-- BIG MONEY -->
        <div class="text-6xl font-black mb-2 tracking-tighter"
             :class="meetingTicker.statusColor">
            $<span x-text="meetingTicker.currentCost.toFixed(2)">0.00</span>
        </div>

        <!-- Burn Rate Subtitle -->
        <div class="text-slate-500 text-sm">
            Burning <span class="text-slate-300 font-bold">$<span x-text="meetingTicker.burnRatePerMinute.toFixed(0)">0</span>/min</span>
        </div>

        <!-- Dynamic Feedback -->
        <div class="mt-6 p-3 rounded-lg bg-slate-900/50 border border-slate-700/50">
            <p class="text-sm font-medium" :class="meetingTicker.statusColor" x-text="meetingTicker.statusMessage"></p>
        </div>
    </div>

    <!-- Controls & Inputs -->
    <div class="grid md:grid-cols-2 gap-6">
        
        <!-- Sliders (Disable while running to prevent math jumping) -->
        <div class="bg-slate-800 p-6 rounded-xl border border-slate-700 space-y-6">
            
            <!-- Attendees Slider -->
            <div>
                <div class="flex justify-between text-sm mb-2">
                    <label class="text-slate-300">Attendees</label>
                    <span class="text-green-400 font-bold" x-text="meetingTicker.attendees"></span>
                </div>
                <input type="range" min="1" max="50" step="1" 
                       x-model="meetingTicker.attendees"
                       class="w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-green-400">
            </div>

            <!-- Hourly Rate Slider -->
            <div>
                <div class="flex justify-between text-sm mb-2">
                    <label class="text-slate-300">Avg. Hourly Cost ($)</label>
                    <span class="text-green-400 font-bold" x-text="'$' + meetingTicker.avgRate"></span>
                </div>
                <input type="range" min="50" max="500" step="25" 
                       x-model="meetingTicker.avgRate"
                       class="w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-green-400">
                <p class="text-xs text-slate-500 mt-1">Include salary + overhead + benefits.</p>
            </div>

            <!-- Context Tax Toggle -->
            <div class="flex items-center justify-between pt-2 border-t border-slate-700/50">
                <div class="text-xs text-slate-400">
                    <span class="text-slate-200 font-bold block">Context Switch Tax (+20%)</span>
                    Applies cost for interruption recovery.
                </div>
                <button 
                    @click="meetingTicker.includeContextTax = !meetingTicker.includeContextTax"
                    class="relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none"
                    :class="meetingTicker.includeContextTax ? 'bg-green-500' : 'bg-slate-600'">
                    <span class="inline-block h-4 w-4 transform rounded-full bg-white transition-transform"
                        :class="meetingTicker.includeContextTax ? 'translate-x-6' : 'translate-x-1'"></span>
                </button>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="flex flex-col justify-center space-y-4">
            
            <!-- Start/Pause -->
            <button @click="meetingTicker.toggle()"
                    class="w-full py-4 rounded-xl font-bold text-lg shadow-lg transition-all transform active:scale-95 flex items-center justify-center gap-2"
                    :class="meetingTicker.active 
                        ? 'bg-yellow-500 hover:bg-yellow-400 text-slate-900' 
                        : 'bg-green-500 hover:bg-green-400 text-slate-900'">
                <i class="fa-solid" :class="meetingTicker.active ? 'fa-pause' : 'fa-play'"></i>
                <span x-text="meetingTicker.active ? 'Pause Meeting' : (meetingTicker.paused ? 'Resume Meeting' : 'Start Ticker')"></span>
            </button>

            <!-- Reset -->
            <button @click="meetingTicker.reset()"
                    class="w-full py-3 rounded-xl border border-slate-600 text-slate-400 hover:text-white hover:bg-slate-700 transition-colors flex items-center justify-center gap-2">
                <i class="fa-solid fa-rotate-left"></i>
                Reset
            </button>
            
            <!-- "The Bilingual Insight" Box -->
            <div class="bg-blue-500/10 border border-blue-500/20 p-4 rounded-lg">
                <h4 class="text-blue-400 text-xs font-bold uppercase mb-1">
                    <i class="fa-solid fa-lightbulb mr-1"></i> Bilingual Insight
                </h4>
                <p class="text-xs text-slate-300 leading-relaxed">
                    "If you wouldn't sign a PO for $<span x-text="Math.max(100, meetingTicker.currentCost).toFixed(0)">100</span> to buy software, why are you spending it on a status update?"
                </p>
            </div>
        </div>
    </div>
</div>

</div>
        
        
            <!-- COMMUNITY -->
            <div x-show="currentTab === 'community'" x-cloak class="max-w-3xl mx-auto mt-12 text-center">
                <div class="bg-gradient-to-b from-slate-800 to-dark p-10 rounded-2xl border border-primary/30 shadow-2xl relative overflow-hidden">
                    
                    <!-- WhatsApp Brand Icon -->
                    <div class="mb-6">
                        <i class="fa-brands fa-whatsapp text-6xl text-[#25D366]"></i>
                    </div>

                    <h2 class="font-mono text-3xl font-bold text-white mb-4">The Fintech Bilinguals</h2>
                    <p class="text-textMuted max-w-lg mx-auto mb-8">Join the collective of execution-focused leaders. Access exclusive playbooks and peer support.</p>

                    <!-- DESKTOP VIEW: Show QR Code -->
                    <div class="hidden md:flex flex-col items-center">
                        <div class="bg-white p-4 rounded-xl shadow-lg mb-4">
                            <!-- QR Code Generated from your URL -->
                            <img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=https://chat.whatsapp.com/DgFrhnzrKpAJnmLM1Oqmgg" 
                                 alt="WhatsApp QR Code" 
                                 class="w-40 h-40">
                        </div>
                        <p class="text-xs text-textMuted font-mono uppercase tracking-widest">Scan with your phone to join</p>
                    </div>

                    <!-- MOBILE VIEW: Show Clickable Button -->
                    <div class="md:hidden">
                        <a href="https://chat.whatsapp.com/DgFrhnzrKpAJnmLM1Oqmgg" target="_blank" 
                           class="flex items-center justify-center gap-3 w-full bg-[#25D366] hover:bg-[#128c7e] text-white font-bold py-4 px-6 rounded-full shadow-glow transition-all active:scale-95">
                            <i class="fa-brands fa-whatsapp text-2xl"></i>
                            <span class="font-mono text-sm">JOIN COMMUNITY</span>
                        </a>
                        <p class="text-[10px] text-textMuted mt-4">Opens directly in WhatsApp</p>
                    </div>


                    <!-- ARCHITECT CONSOLE (VIP ONLY) -->
            <div x-show="currentTab === 'architect'" x-cloak class="max-w-5xl mx-auto">
                <div class="border border-hotpink/50 bg-hotpink/5 p-6 rounded-lg mb-8 relative overflow-hidden">
                    <div class="absolute top-0 right-0 p-4 opacity-20"><i class="fa-solid fa-microchip text-9xl text-hotpink"></i></div>
                    <h2 class="font-mono text-3xl font-bold text-hotpink mb-2 flex items-center"><i class="fa-solid fa-user-secret mr-3"></i>VIP ARCHITECT CONSOLE</h2>
                    <p class="text-sm text-slate-300 font-mono max-w-2xl relative z-10">ACCESS GRANTED. Welcome to the Command Center.</p>
                </div>
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="bg-card p-6 rounded-lg border-t-4 border-t-hotpink">
                        <h3 class="text-white font-bold mb-3 font-mono flex justify-between">JSON: Data Product Contract</h3>
                        <div class="bg-black p-4 rounded text-xs text-green-400 font-mono overflow-x-auto mb-4 border border-slate-800 shadow-inner">
                            <pre x-text="vipJson"></pre>
                        </div>
                        <button @click="copyToClipboard(vipJson, 'Schema')" class="w-full border border-slate-600 hover:bg-slate-700 text-slate-300 text-xs font-mono py-3 rounded transition-colors flex items-center justify-center gap-2"><i class="fa-regular fa-copy"></i> COPY SCHEMA</button>
                    </div>
                    <div class="bg-card p-6 rounded-lg border-t-4 border-t-hotpink">
                        <h3 class="text-white font-bold mb-3 font-mono flex justify-between">PROMPT: The Boardroom Script</h3>
                        <div class="bg-black p-4 rounded text-xs text-blue-300 font-mono overflow-x-auto mb-4 border border-slate-800 shadow-inner h-32">
                            <pre x-text="vipPrompt"></pre>
                        </div>
                        <button @click="copyToClipboard(vipPrompt, 'Prompt')" class="w-full bg-hotpink hover:bg-pink-600 text-white font-bold py-3 rounded text-xs font-mono transition-all flex items-center justify-center gap-2 shadow-glow-vip"><i class="fa-solid fa-robot"></i> COPY PROMPT</button>
                    </div>
                </div>
            
        </div>  
    </div>  

</div> 


               <!-- Desktop/Tablet Dock -->
<div class="fixed bottom-6 left-1/2 -translate-x-1/2 z-40 w-auto md:block hidden transition-all duration-500"
     :class="navVisible ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-10 pointer-events-none'">
            <div class="flex items-center gap-1 bg-slate-900/90 backdrop-blur-xl border border-white/10 rounded-full p-2 shadow-2xl shadow-black/50">
                <template x-for="group in navGroups" :key="group.id">
                    <button @click="currentGroup = group.id; currentTab = 'dashboard'" 
                            class="relative px-6 py-3 rounded-full transition-all duration-300 group flex flex-col items-center justify-center gap-1"
                            :class="currentGroup === group.id ? 'bg-white/10 text-white' : 'text-slate-500 hover:text-slate-300'">
                        <i :class="group.icon" class="text-lg mb-0.5 transition-transform group-active:scale-90"></i>
                        <span class="text-[9px] font-bold uppercase tracking-widest" x-text="group.label"></span>
                        <div x-show="currentGroup === group.id" class="absolute -bottom-1 w-1 h-1 bg-primary rounded-full shadow-glow"></div>
                    </button>
                </template>
            </div>
        </div>

        <!-- Mobile Dock -->
<div class="md:hidden fixed bottom-6 left-4 right-4 z-40 transition-all duration-500"
     :class="navVisible ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-10 pointer-events-none'">
            <div class="flex items-center justify-between gap-1 bg-slate-900/95 backdrop-blur-xl border border-white/10 rounded-2xl p-2 shadow-2xl shadow-black/50">
                <template x-for="group in navGroups" :key="group.id">
                    <button @click="currentGroup = group.id; currentTab = 'dashboard'" 
                            class="relative h-14 rounded-xl transition-all duration-300 group flex flex-col items-center justify-center flex-1"
                            :class="currentGroup === group.id ? 'bg-white/10 text-white' : 'text-slate-500 hover:text-slate-300'">
                        <i :class="group.icon" class="text-lg mb-1 transition-transform group-active:scale-90"></i>
                        <span class="text-[9px] font-bold uppercase tracking-widest truncate w-full text-center" x-text="group.label"></span>
                        <div x-show="currentGroup === group.id" class="absolute bottom-1 w-1 h-1 bg-primary rounded-full shadow-glow"></div>
                    </button>
                </template>
            </div>
        </div>

    </div> <!-- End viewMode='tools' Wrapper -->

</main>


    <!-- Service Worker -->

    <script>
        if ('serviceWorker' in navigator && window.location.protocol === 'https:') {
            window.addEventListener('load', () => {
                fetch('sw.js')
                    .then(response => {
                        if (response.status === 200) {
                            navigator.serviceWorker.register('sw.js')
                                .then(r => console.log('SW Registered'))
                                .catch(e => console.log('SW Fail:', e));
                        }
                    })
                    .catch(() => {});
            });
        }
    </script>
</body>
</html>
